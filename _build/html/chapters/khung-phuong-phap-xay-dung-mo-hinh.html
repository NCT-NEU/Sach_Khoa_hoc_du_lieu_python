
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Tổng quan về xây dựng mô hình trên dữ liệu &#8212; Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/khung-phuong-phap-xay-dung-mo-hinh';</script>
    <link rel="canonical" href="https://www.tomasbeuzen.com/python-programming-for-data-science/chapters/khung-phuong-phap-xay-dung-mo-hinh.html" />
    <link rel="icon" href="../_static/favicon2.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Python cơ bản" href="chapter4-basics.html" />
    <link rel="prev" title="2. Nguyên lý phân tích dữ liệu" href="nguyen-ly-phan-tich-du-lieu.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python) - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Khoa học dữ liệu trong Kinh tế và Kinh doanh
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Danh sách chương</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gioi-thieu-ve-khoa-hoc-du-lieu.html">1. Các khái niệm cơ bản trong khoa học dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="nguyen-ly-phan-tich-du-lieu.html">2. Nguyên lý phân tích dữ liệu</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Tổng quan về xây dựng mô hình trên dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4-basics.html">4. Python cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5-Numpy.html">5. Kiến thức cơ bản về NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6-pandas.html">6. Giới thiệu về pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7-Import-data.html">7. Nhập và lưu trữ dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8-prepare.html">8. Làm sạch và chuẩn bị dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter9-transform.html">9. Sắp xếp và biến đổi dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter10-visualization.html">10. Trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter12-Supervised.html">11. Các mô hình học máy có giám sát</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bài tập thực hành</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/100_bai_tap_python_day_du.html">Python cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_numpy.html">Bài tập NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/30_bai_tap_pandas.html">Bài tập trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/Pandas_Exercise.html">Thực hành nhập liệu từ các nguồn khác nhau</a></li>





<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_tien_xu_ly_du_lieu.html">Tiền xử lý dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_matplotlib_seaborn.html">Thực hành trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_linear_softmax_models.html">Mô hình tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_cay_rung_boosting.html">Cây quyết định và tập hợp cây quyết định</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/NCT-NEU/Python-Data-Science-Book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/khung-phuong-phap-xay-dung-mo-hinh.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tổng quan về xây dựng mô hình trên dữ liệu</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu-chung-ve-xay-dung-mo-hinh">3.1. Giới thiệu chung về xây dựng mô hình</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lich-su-hinh-thanh-cua-cac-mo-hinh-hoc-may">3.1.1. Lịch sử hình thành của các mô hình học máy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoc-may-trong-kinh-te-va-kinh-doanh">3.1.2. Học máy trong kinh tế và kinh doanh?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-van-de-hoc-may-co-the-giai-quyet">3.1.3. Các vấn đề học máy có thể giải quyết</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hoc-may-va-ngon-ngu-python">3.2. Học máy và ngôn ngữ Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-xay-dung-mo-hinh-hoc-may">3.2.1. Thư viện xây dựng mô hình học máy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-thu-vien-va-cong-cu-ho-tro">3.2.2. Các thư viện và công cụ hỗ trợ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-numpy">3.2.2.1. Thư viện NumPy</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-scipy">3.2.2.2. Thư viện SciPy</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">3.2.2.3. matplotlib</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-pandas">3.2.2.4. Thư viện pandas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ung-dung-thuc-te-cua-mo-hinh-hoc-may">3.3. Ứng dụng thực tế của mô hình học máy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-loai-cac-loai-hoa-iris">3.3.1. Phân loại các loài hoa Iris</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lam-quen-voi-du-lieu-phan-loai-hoa-iris">3.3.1.1. Làm quen với dữ liệu phân loại hoa iris</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-huan-luyen-mo-hinh-va-du-lieu-kiem-tra-mo-hinh">3.3.1.2. Dữ liệu huấn luyện mô hình và dữ liệu kiểm tra mô hình</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-du-lieu-kham-pha-eda">3.3.1.3. Phân tích dữ liệu khám phá (EDA)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-hinh-dau-tien-k-lang-gieng-gan-nhat">3.3.1.4. Mô hình đầu tiên: k-láng giềng gần nhất</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-hinh-thu-hai-mo-hinh-cay-quyet-dinh">3.3.1.5. Mô hình thứ hai: mô hình cây quyết định</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#du-doan-gia-bat-dong-san-tai-ha-noi">3.3.2. Dự đoán giá bất động sản tại Hà Nội</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-va-bai-toan-du-doan-gia-bat-dong-san">3.3.2.1. Dữ liệu và baì toán dự đoán giá bất động sản</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-khai-pha-du-lieu">3.3.2.2. Phân tích khai phá dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xay-dung-mo-hinh-du-doan-gia-nha">3.3.2.3. Xây dựng mô hình dự đoán giá nhà</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tim-khach-hang-tiem-nang-cho-chien-dich-quang-cao">3.3.3. Tìm khách hàng tiềm năng cho chiến dịch quảng cáo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu-ve-du-lieu">3.3.3.1. Giới thiệu về dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.3.2. Phân tích khai phá dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xay-dung-mo-hinh-hoc-may">3.3.3.3. Xây dựng mô hình học máy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="" src="../_images/banner.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="tong-quan-ve-xay-dung-mo-hinh-tren-du-lieu">
<h1><span class="section-number">3. </span>Tổng quan về xây dựng mô hình trên dữ liệu<a class="headerlink" href="#tong-quan-ve-xay-dung-mo-hinh-tren-du-lieu" title="Link to this heading">#</a></h1>
<hr><section id="gioi-thieu-chung-ve-xay-dung-mo-hinh">
<h2><span class="section-number">3.1. </span>Giới thiệu chung về xây dựng mô hình<a class="headerlink" href="#gioi-thieu-chung-ve-xay-dung-mo-hinh" title="Link to this heading">#</a></h2>
<hr><p>Học máy, còn gọi là <strong>machine learning</strong> là một lĩnh vực nghiên cứu liên ngành, nằm tại giao điểm của thống kê, trí tuệ nhân tạo và khoa học máy tính. Mục tiêu cốt lõi của học máy là <strong>trích xuất tri thức từ dữ liệu</strong> thông qua các thuật toán và mô hình toán học. Trong một số tài liệu, học máy còn được gọi là <strong>học thống kê</strong> (statistical learning) hoặc <strong>phân tích dự báo</strong> (predictive analytics).</p>
<p>Trong những năm gần đây, học máy đã trở thành một trong những công nghệ nền tảng được tích hợp rộng rãi trong các hệ thống và ứng dụng hiện đại. Các thuật toán học máy đang vận hành phía sau nhiều chức năng quen thuộc trong đời sống hàng ngày, từ việc đề xuất phim trên nền tảng giải trí, gợi ý sản phẩm trong thương mại điện tử, đến cá nhân hóa nội dung truyền thông và nhận diện khuôn mặt trong ảnh. Hầu hết các dịch vụ lớn như Facebook, Amazon hoặc Netflix đều tích hợp nhiều mô hình học máy trong hầu hết các thành phần giao diện và chức năng cốt lõi.</p>
<p>Không chỉ giới hạn trong các ứng dụng thương mại, học máy còn có vai trò quan trọng trong nghiên cứu khoa học hiện đại. Các công cụ và thuật toán học máy đã được áp dụng để giải quyết nhiều vấn đề phức tạp như phân tích dữ liệu thiên văn, phát hiện hành tinh ngoài hệ Mặt Trời, khám phá hạt cơ bản trong vật lý năng lượng cao, giải mã trình tự DNA, và phát triển các liệu pháp điều trị ung thư cá thể hóa.</p>
<p>Tuy nhiên, để ứng dụng học máy hiệu quả, không nhất thiết phải xử lý các vấn đề ở quy mô toàn cầu hay có tác động lớn. Ngay cả những tác vụ nhỏ, ở phạm vi tổ chức hoặc cá nhân, cũng có thể hưởng lợi từ việc áp dụng các kỹ thuật học máy một cách hợp lý.</p>
<p>Trong chương này, chúng ta sẽ cùng khám phá lý do tại sao học máy ngày càng phổ biến, và phân tích các loại bài toán mà học máy có thể giải quyết hiệu quả. Đồng thời, chương trình học sẽ hướng dẫn người đọc xây dựng mô hình học máy đầu tiên, qua đó giới thiệu các khái niệm cốt lõi và phương pháp tiếp cận trong thực tiễn.</p>
<p>Trước khi học máy trở nên phổ biến, nhiều hệ thống được thiết kế theo phương pháp <strong>mã hóa thủ công</strong> (rule-based systems), trong đó các quyết định được đưa ra dựa trên các cấu trúc điều kiện như “if-else”. Ví dụ, một bộ lọc thư rác có thể được xây dựng bằng cách liệt kê các từ khóa nghi ngờ để đánh dấu email là thư rác. Đây là cách tiếp cận sử dụng tri thức chuyên gia để xây dựng một hệ thống ra quyết định.</p>
<p>Tuy nhiên, cách tiếp cận này tồn tại hai hạn chế cơ bản:</p>
<ul class="simple">
<li><p>Logic ra quyết định thường chỉ áp dụng cho một lĩnh vực hoặc nhiệm vụ cụ thể. Việc thay đổi yêu cầu hoặc áp dụng sang bối cảnh khác thường đòi hỏi phải thiết kế lại toàn bộ hệ thống.</p></li>
<li><p>Việc thiết kế các quy tắc phụ thuộc nặng nề vào tri thức chuyên gia, và không phải lúc nào con người cũng có khả năng mô hình hóa rõ ràng quá trình nhận thức hoặc ra quyết định.</p></li>
</ul>
<p>Một ví dụ điển hình cho hạn chế của phương pháp dựa trên quy tắc là trong bài toán phát hiện khuôn mặt trong ảnh số. Mặc dù ngày nay hầu hết các thiết bị thông minh đều có khả năng nhận diện khuôn mặt, nhưng đây từng là một bài toán khó chưa được giải quyết hiệu quả cho đến năm 2001. Nguyên nhân là do cách máy tính biểu diễn hình ảnh (dưới dạng ma trận các điểm ảnh) rất khác với cách con người nhận thức khuôn mặt. Điều này khiến việc mô tả khuôn mặt bằng các quy tắc cố định trở nên cực kỳ khó khăn và thiếu khả năng tổng quát.</p>
<p>Ngược lại, học máy cho phép hệ thống tự động học các mẫu và đặc điểm từ dữ liệu đầu vào. Trong bài toán nhận diện khuôn mặt, thay vì liệt kê các đặc điểm thủ công, ta chỉ cần cung cấp một tập hợp lớn các hình ảnh có chứa khuôn mặt. Thuật toán học máy sẽ tự động phát hiện các đặc trưng phân biệt khuôn mặt với các đối tượng khác, từ đó xây dựng mô hình nhận dạng hiệu quả.</p>
<p>Khả năng học từ dữ liệu giúp học máy linh hoạt, thích ứng với nhiều loại bài toán khác nhau mà không đòi hỏi hiểu biết tường minh về tất cả các quy luật hoặc mối quan hệ bên trong dữ liệu. Chính vì thế, học máy ngày càng trở thành công cụ quan trọng trong nhiều ngành nghề, từ công nghiệp, y tế, tài chính đến khoa học xã hội và giáo dục.</p>
<section id="lich-su-hinh-thanh-cua-cac-mo-hinh-hoc-may">
<h3><span class="section-number">3.1.1. </span>Lịch sử hình thành của các mô hình học máy<a class="headerlink" href="#lich-su-hinh-thanh-cua-cac-mo-hinh-hoc-may" title="Link to this heading">#</a></h3>
<hr><p>Mặc dù thuật ngữ <strong>mô hình học máy</strong> còn khá mới mẻ, nhưng những kỹ thuật nền tảng cho lĩnh vực này đã được phát triển từ lâu.</p>
<p>Vào đầu thế kỷ 19, phương pháp bình phương nhỏ nhất đã được phát triển và áp dụng để ước lượng các mô hình <strong>hồi quy tuyến tính</strong>.
Mô hình này lần đầu tiên được áp dụng và cho kết quả thành công trong các vấn đề liên quan đến thiên văn học.</p>
<p>Vào đầu thế kỷ 20, mô hình hồi quy tuyến tính được sử dụng để dự đoán các giá trị định lượng, chẳng hạn như mức lương của một cá nhân hoặc để dự đoán các giá trị định tính, chẳng hạn như bệnh nhân sống hay chết, hay thị trường chứng khoán tăng hay giảm.</p>
<p>Vào những năm 1940, nhiều tác giả đã đưa ra một cách tiếp cận khác, đó là <strong>hồi quy logistic</strong>.
Vào đầu những năm 1970, thuật ngữ mô hình <strong>tuyến tính tổng quát</strong> đã được phát triển để mô tả toàn bộ lớp phương pháp học thống kê bao gồm cả hồi quy tuyến tính và hồi quy logistic như các trường hợp đặc biệt.</p>
<p>Vào cuối những năm 1970, nhiều kỹ thuật xây dựng mô hình trên dữ liệu đã xuất hiện.
Tuy nhiên, các mô hình này chỉ xoay quanh các phương pháp tuyến tính vì việc tạo ra các mối quan hệ phi tuyến tính rất khó khăn về mặt tính toán.</p>
<p>Đến những năm 1980, sự phát triển của máy tính điện tử đã hỗ trợ tích cực về mặt tính toán cho các phương pháp phi tuyến tính.
Các mô hình phi tuyến được giới thiệu vào đầu những năm 1980 bao gồm mô hình <strong>cây quyết định</strong> và mô hình <strong>cộng tính tổng quát</strong>.
Những năm cuối thập niên 1980 và đầu thập niên 1990, mô hình <strong>mạng nơ-ron</strong> được giới thiệu đến cộng đồng nghiên cứu nhưng chưa nhận được nhiều sự quan tâm vì dữ liệu chưa đủ phong phú và sự phổ biến của các mô hình học máy khác.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/intro3.png"><img alt="../_images/intro3.png" src="../_images/intro3.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Quá trình phát triển của các mô hình học máy</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Giai đoạn cuối thế kỷ XX và đầu thế kỷ XXI là giai đoạn chiếm ưu thế hoàn toàn của các mô hình học máy <strong>rừng ngẫu nhiên</strong> và thuật toán <strong>học tăng cường</strong>.
Thuật toán học tăng cường với các biến thể như <strong>XGBoost</strong> hay <strong>LightGBM</strong> chiến thắng trong hầu hết các cuộc thi về khoa học dữ liệu.</p>
<p>Từ năm 2010, với sự bùng nổ của các thiết bị thông minh và kết nối internet, dữ liệu trở nên phong phú và đa dạng hơn cũng là thời điểm quay trở lại của mô hình mạng nơ-ron, hay còn được gọi với tên gọi khác là mô hình <strong>mạng học sâu</strong> (deep learning).
Mô hình mạng học sâu vượt trội hoàn toàn các mô hình học máy thông thường khi làm việc với dữ liệu kiểu hình ảnh, video, ngôn ngữ tự nhiên bao gồm cả văn bản và giọng nói.</p>
<p>Sự kiện đánh dấu sự phát triển vượt bậc của các mô hình mạng học sâu là sự ra đời của ChatGPT vào cuối năm 2022, một mô hình <strong>ngôn ngữ lớn</strong> cho phép người dùng tương tác, hỏi đáp và trò chuyện một cách hoàn toàn tự nhiên theo định hướng của người sử dụng như phong cách, mức độ chi tiết, hình thức ngôn ngữ.</p>
<p>ChatGPT nhanh chóng đạt đến 100 triệu người dùng sau hơn hai tháng phát hành và giúp cho công ty phát hành OpenAI được định giá khoảng 30 tỷ USD.
Cho đến thời điểm cuối năm 2024 khi nhóm tác giả bắt đầu viết cuốn sách này, ChatGPT đã được cập nhật đến phiên bản 4.0.</p>
</section>
<section id="hoc-may-trong-kinh-te-va-kinh-doanh">
<h3><span class="section-number">3.1.2. </span>Học máy trong kinh tế và kinh doanh?<a class="headerlink" href="#hoc-may-trong-kinh-te-va-kinh-doanh" title="Link to this heading">#</a></h3>
<hr><p>Việc sử dụng dữ liệu và các mô hình học máy để hỗ trợ ra quyết định trong kinh tế và kinh doanh, thay vì chỉ dựa trên kinh nghiệm thuần túy, không chỉ giúp các nhà quản lý có cái nhìn toàn diện hơn về tình hình kinh doanh mà còn giúp họ đưa ra những quyết định khách quan, thông minh và hiệu quả hơn.</p>
<p>Để minh họa ứng dụng của xây dựng mô hình trên dữ liệu trong lĩnh vực kinh tế và kinh doanh, chúng tôi thảo luận ngắn gọn về dữ liệu từ một chiến dịch quảng cáo của một công ty thu thập được từ 55 cửa hàng trên toàn quốc. Dữ liệu bao gồm thông tin về doanh thu bán sản phẩm và chi phí công ty đã chi cho ba phương thức quảng cáo là quảng cáo qua truyền hình, quảng cáo qua các nền tảng mạng xã hội, và quảng cáo bằng hình thức phát tờ rơi.
Mối liên hệ của chi phí cho mỗi phương thức quảng cáo đến doanh thu từ bán sản phẩm được mô tả trong hình</p>
<div class="cell tag_hide-input tag_remove-warning docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/nguyenquanghuy85/Khdl-ktkd-python/refs/heads/main/Sales</span><span class="si">%20d</span><span class="s1">ataset.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;TV&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Social_Media&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Flyer&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tác động của các loại chi phí quảng cáo đến doanh thu bán hàng&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/9cfae370a229e33848fb3dfd34ebd5773e0e93af1580382331002c236a5763fa.png" src="../_images/9cfae370a229e33848fb3dfd34ebd5773e0e93af1580382331002c236a5763fa.png" />
</div>
</div>
<div class="cell tag_hide-input tag_remove-warning docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;TV&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Flyer&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Flyer&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Social_Media&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Social_Media&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;TV&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tác động của qua lại của các loại chi phí quảng cáo&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># ✅ tránh chồng chữ trục</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/8e3437dc84199a4eef78b3097f095f9d8d1d219560abb8c6b7192d6f597f99ce.png" src="../_images/8e3437dc84199a4eef78b3097f095f9d8d1d219560abb8c6b7192d6f597f99ce.png" />
</div>
</div>
<p>Từ mối liên hệ của các biến có thể đưa ra nhận định khá chắc chắn là chi tiền cho quảng cáo có ý nghĩa trong việc tăng doanh thu bán sản phẩm.
Có thể thấy trong các đồ thị ở hàng phía trên rằng có mối liên hệ cùng chiều giữa chi phí chi cho các hình thức quảng cáo đến doanh thu bán sản phẩm.
Mối liên hệ này là phù hợp với logic nói chung về quảng cáo sản phẩm: khi công ty chi tiền cho quảng cáo, nhiều khách hàng sẽ có cơ hội tiếp cận về sản phẩm hơn, làm tăng số lượng người mua sản phẩm và tăng doanh thu cho các cửa hàng.</p>
<p>Tuy nhiên, vẫn còn rất nhiều câu hỏi cần giải đáp từ đối với các nhà quản lý:</p>
<ol class="arabic simple">
<li><p>Mối liên hệ giữa ngân sách chi cho quảng cáo và doanh thu nếu tồn tại thì mạnh đến mức nào?</p></li>
<li><p>Phương tiện truyền thông nào góp phần tăng doanh thu bán hàng?
Cả ba phương tiện truyền thông qua Tivi, mạng xã hội và phát tờ rơi có đóng góp vào doanh thu bán hàng hay chỉ một hoặc hai phương tiện quảng cáo có đóng góp?</p></li>
<li><p>Chúng ta có thể ước tính chính xác tác động của chi phí từng phương tiện quảng cáo đến doanh thu bán hàng như thế nào?
Với cùng một mức chi cho quảng cáo trên một phương tiện cụ thể, doanh thu bán hàng sẽ tăng bao nhiêu?
Chúng ta có thể dự đoán mức tăng này chính xác đến mức nào?</p></li>
<li><p>Mối liên hệ hay sự tác động của chi phí cho từng hình thức quảng cáo đến doanh thu bán hàng có tuyến tính không?
Nếu không, liệu có phương pháp biến đổi như thế nào để mối liên hệ vẫn là tuyến tính?</p></li>
<li><p>Có sự tác động qua lại giữa các chi phí cho các phương tiện quảng cáo không?
Chẳng hạn như nên chi đồng thời 10 triệu đồng cho quảng cáo trên mạng xã hội và 10 triệu đồng cho quảng cáo tờ rơi liệu có mang lại doanh thu cao hơn việc phân bổ 20 triệu cho riêng từng hình thức?</p></li>
</ol>
<p>Để trả lời các câu hỏi kể trên, nhà quản lý cần xây dựng một mô hình phản ánh tác động của các chi phí cho quảng cáo lên doanh thu bán hàng. Về bản chất, mô hình cần xây dựng là một hàm số mô tả mối liên hệ giữa chi phí quảng cáo và doanh thu bán sản phẩm, tạm gọi là hàm <span class="math notranslate nohighlight">\(f\)</span> như sau:</p>
<div class="math notranslate nohighlight" id="equation-eq01">
<span class="eqno">(3.1)<a class="headerlink" href="#equation-eq01" title="Link to this equation">#</a></span>\[\text{Sales} = f\left(\text{TV}, \text{SocialMedia}, \text{Flyer}\right) + \epsilon\]</div>
<p>với <span class="math notranslate nohighlight">\(\epsilon\)</span> là sai số trong mô hình mà không thể giải thích được bằng dữ liệu. Nói cách khác, <span class="math notranslate nohighlight">\(\epsilon\)</span> đại diện cho ảnh hưởng của các yếu tố có thể có tác động đến doanh thu nhưng không liên quan đến 3 loại hình quảng cáo trên.</p>
<p>Trong xuyên suốt cuốn sách, nếu không có giả thiết bổ sung, chúng tôi luôn mặc định là sai số có trung bình bằng 0 và phương sai là một hằng số.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbb{E}(\epsilon) = 0 \\ 
&amp; \mathbb{V}(\epsilon) = \sigma^2
\end{align}\end{split}\]</div>
<p>Trong <a class="reference internal" href="#equation-eq01">(3.1)</a>, biến <code class="docutils literal notranslate"><span class="pre">Sales</span></code> được gọi là biến phụ thuộc, biến phụ thuộc, hoặc biến đầu ra, trong khi các biến <code class="docutils literal notranslate"><span class="pre">TV</span></code>, <code class="docutils literal notranslate"><span class="pre">SocialMedia</span></code>, và <code class="docutils literal notranslate"><span class="pre">Flyer</span></code> được gọi là các biến giải thích, biến độc lập, hoặc biến đầu vào.
Trong cuốn sách này chúng tôi sẽ sử dụng cặp khái niệm biến phụ thuộc - biến giải thích và biến phụ thuộc - biến độc lập thay thế cho nhau tùy vào từng ngữ cảnh của mô hình.</p>
<p>Khi thảo luận về các mô hình và không đề cập đến một dữ liệu cụ thể, chúng tôi sẽ sử dụng ký hiệu <span class="math notranslate nohighlight">\(Y\)</span> để mô tả biến phụ thuộc và <span class="math notranslate nohighlight">\(\textbf{X} = (X_1, X_2, \cdots, X_p)\)</span> để mô tả véc-tơ các biến độc lập.
Một cách tổng quát, chúng ta cần xác định mô hình trên dữ liệu, được gọi tắt là <span class="math notranslate nohighlight">\(f\)</span>, sao cho</p>
<div class="math notranslate nohighlight">
\[\begin{align}
Y = f(\textbf{X}) + \epsilon
\end{align}\]</div>
<p>với <span class="math notranslate nohighlight">\(\epsilon\)</span> là sai số độc lập với biến giải thích <span class="math notranslate nohighlight">\(\textbf{X}\)</span>.</p>
<p>Hàm <span class="math notranslate nohighlight">\(f\)</span> trong công thức trên là một hàm số xác định nhưng chưa biết.
Mục tiêu quan trọng nhất của những người xây dựng mô hình là ước lượng hàm <span class="math notranslate nohighlight">\(f\)</span>.
Tuy nhiên, tất cả thông tin mà người xây dựng mô hình có được chỉ là các giá trị quan sát được của các biến độc lập và biến phụ thuộc tương ứng, mà không có bất kỳ gợi ý nào về dạng của hàm <span class="math notranslate nohighlight">\(f\)</span>.
Một ước lượng hàm <span class="math notranslate nohighlight">\(f\)</span>, thường được ký hiệu là <span class="math notranslate nohighlight">\(\hat{f}\)</span>, có phải là một xấp xỉ tốt cho hàm <span class="math notranslate nohighlight">\(f\)</span> hay không hoàn toàn phụ thuộc vào kinh nghiệm và kỹ năng của người xây dựng mô hình.</p>
<p>Trong phần tiếp theo của cuốn sách chúng tôi sẽ thảo luận về những cân nhắc mà người xây dựng mô hình cần phải đặt ra trước khi tiến hành ước lượng hàm <span class="math notranslate nohighlight">\(f\)</span>.</p>
</section>
<section id="cac-van-de-hoc-may-co-the-giai-quyet">
<h3><span class="section-number">3.1.3. </span>Các vấn đề học máy có thể giải quyết<a class="headerlink" href="#cac-van-de-hoc-may-co-the-giai-quyet" title="Link to this heading">#</a></h3>
<hr><p>Một trong những nhóm thuật toán học máy thành công nhất là các thuật toán có khả năng <strong>tự động hóa quá trình ra quyết định</strong> bằng cách <strong>tổng quát hóa từ các ví dụ đã biết</strong>. Trong bối cảnh này, phương pháp được sử dụng thường được gọi là <strong>học có giám sát</strong>, hay <em>supervised learning</em>, trong đó người dùng cung cấp cho thuật toán một tập hợp các cặp đầu vào và đầu ra mong muốn. Mục tiêu của thuật toán là học cách ánh xạ từ đầu vào tới đầu ra, và từ đó có khả năng dự đoán đầu ra đối với những đầu vào chưa từng thấy trước đó.</p>
<p>Chẳng hạn, trong bài toán phân loại thư rác, một thuật toán học có giám sát sẽ được huấn luyện trên một tập hợp các email đầu vào, cùng với nhãn tương ứng cho biết đó có phải là thư rác hay không. Sau quá trình học từ dữ liệu, thuật toán có thể dự đoán tính chất của một email mới mà không cần sự can thiệp trực tiếp của con người.</p>
<p>Thuật ngữ “có giám sát” bắt nguồn từ việc mỗi ví dụ trong dữ liệu huấn luyện được gắn với một nhãn rõ ràng, đóng vai trò như một người giám sát cung cấp thông tin phản hồi trong quá trình mô hình học từ dữ liệu. Mặc dù việc xây dựng một tập dữ liệu có nhãn thường là một công việc thủ công và tốn kém, nhưng các thuật toán học có giám sát hiện nay đã được nghiên cứu kỹ lưỡng và hiệu suất của chúng có thể được đánh giá một cách rõ ràng bằng các tiêu chí định lượng.</p>
<p>Nếu bài toán của bạn có thể được biểu diễn dưới dạng một ánh xạ từ đầu vào đến đầu ra và bạn có thể thu thập đủ dữ liệu có nhãn, thì học có giám sát là một công cụ tiềm năng để giải quyết vấn đề đó. Một số ví dụ về học có giám sát là:</p>
<ul class="simple">
<li><p><em>Dự đoán giá bất động sản</em>: đầu vào là các thông tin chi tiết về một bất động sản cụ thể, chẳng hạn như diện tích, số phòng ngủ, chiều rộng mặt tiền, vị trí, loại hình nhà ở, năm xây dựng, v.v.; với đầu ra là một giá trị liên tục thể hiện giá nhà dự kiến (ví dụ: triệu đồng/m²). Tập dữ liệu được xây dựng dựa trên các bất động sản đã được giao dịch thành công trong quá khứ, với thông tin đầy đủ về đặc trưng và mức giá thực tế tại thời điểm bán.</p></li>
<li><p><em>Dự đoán khả năng chấp nhận dịch vụ của khách hàng</em>: đầu vào là các thông tin liên quan đến hồ sơ và hành vi của khách hàng, chẳng hạn như độ tuổi, giới tính, thu nhập, lịch sử tương tác với doanh nghiệp, số lần nhận email quảng cáo, thời điểm tương tác gần nhất, v.v.; với đầu ra là nhãn “chấp nhận” hoặc “không chấp nhận”. Tập dữ liệu được xây dựng từ các chiến dịch marketing trong quá khứ, nơi khách hàng đã được tiếp cận với dịch vụ và ghi nhận phản hồi thực tế (ví dụ: đăng ký sử dụng hoặc từ chối). Đây là một bài toán phân loại nhị phân thường được áp dụng trong lĩnh vực ngân hàng, bảo hiểm, viễn thông và thương mại điện tử.</p></li>
<li><p><em>Phát hiện giao dịch gian lận trong thẻ tín dụng</em>: đầu vào là thông tin về một giao dịch cụ thể, chẳng hạn như giờ giao dịch, địa điểm, số tiền, v.v.; với đầu ra là “gian lận” hoặc “không gian lận”. Tập dữ liệu được xây dựng dựa trên các giao dịch lịch sử mà khách hàng đã xác nhận là hợp lệ hoặc không hợp lệ.</p></li>
<li><p><em>Xác định mã zip từ chữ viết tay trên phong bì</em>: đầu vào là ảnh quét của phần mã zip viết tay; đầu ra là dãy số trong mã zip. Để xây dựng tập dữ liệu huấn luyện, cần thu thập nhiều phong bì, trích xuất hình ảnh và gán nhãn bằng cách đọc mã zip tương ứng.</p></li>
<li><p><em>Phân loại khối u lành tính dựa trên ảnh y tế</em>: đầu vào là hình ảnh chẩn đoán y tế (ví dụ ảnh MRI); đầu ra là nhãn “lành tính” hoặc “ác tính”. Tập dữ liệu yêu cầu hình ảnh y tế đi kèm với chẩn đoán chính xác từ bác sĩ chuyên khoa, đôi khi cần thêm các kiểm tra lâm sàng hỗ trợ.</p></li>
</ul>
<p>Một điều đáng lưu ý là tuy các bài toán có cấu trúc đầu vào và đầu ra tương đối đơn giản, nhưng quá trình thu thập dữ liệu cho mỗi bài toán lại khác biệt rất lớn về chi phí, yêu cầu kỹ thuật, tính riêng tư và đạo đức.</p>
<p>Trái ngược với học có giám sát, <strong>học không giám sát</strong>, hay <em>unsupervised learning</em> là phương pháp mà trong đó chỉ có dữ liệu đầu vào, và <strong>không có đầu ra mong muốn</strong> được cung cấp. Mục tiêu của học không giám sát là khám phá các cấu trúc ẩn trong dữ liệu mà không cần đến nhãn. Tuy học không giám sát thường khó đánh giá hơn do thiếu đầu ra để so sánh, phương pháp này vẫn đóng vai trò quan trọng trong nhiều ứng dụng phân tích dữ liệu khám phá. Một số ví dụ về học không giám sát có thể kể đến:</p>
<ul class="simple">
<li><p><em>Phân tích chủ đề từ tập hợp các bài viết và tin tức</em>: cho một tập lớn văn bản, mục tiêu là xác định các chủ đề phổ biến mà không cần biết trước các chủ đề là gì.</p></li>
<li><p><em>Phân khúc khách hàng theo hành vi tiêu dùng</em>: với dữ liệu hành vi khách hàng (lịch sử mua sắm, loại sản phẩm, thời điểm truy cập…), thuật toán sẽ phân nhóm khách hàng thành các cụm có đặc điểm tương đồng, ví dụ như “người mua theo mùa”, “người thích công nghệ”, “phụ huynh”, v.v.</p></li>
<li><p><em>Phát hiện truy cập bất thường vào hệ thống</em>: các truy cập không thường xuyên, quá nhanh hoặc từ các địa chỉ IP đáng ngờ có thể được phát hiện bằng cách tìm ra các điểm dữ liệu nằm xa khỏi “cụm” bình thường trong không gian đặc trưng.</p></li>
</ul>
</section>
</section>
<section id="hoc-may-va-ngon-ngu-python">
<h2><span class="section-number">3.2. </span>Học máy và ngôn ngữ Python<a class="headerlink" href="#hoc-may-va-ngon-ngu-python" title="Link to this heading">#</a></h2>
<hr><p>Python đã nổi lên như một ngôn ngữ lập trình phổ quát, đóng vai trò trung tâm trong nhiều ứng dụng thuộc lĩnh vực khoa học dữ liệu. Ngôn ngữ này kết hợp hiệu quả giữa sức mạnh của một ngôn ngữ lập trình đa năng với tính đơn giản và dễ tiếp cận của các ngôn ngữ chuyên biệt như MATLAB hoặc R. Python cung cấp một hệ sinh thái thư viện phong phú phục vụ cho hầu hết các tác vụ phân tích dữ liệu, bao gồm tải và xử lý dữ liệu, trực quan hóa, thống kê, học máy, xử lý ngôn ngữ tự nhiên, xử lý ảnh và nhiều lĩnh vực chuyên sâu khác.</p>
<p>Kho công cụ đa dạng và phát triển mạnh mẽ này đem đến cho các nhà khoa học dữ liệu một nền tảng lập trình linh hoạt, có thể đáp ứng cả các yêu cầu phân tích tổng quát lẫn các bài toán chuyên biệt. Một trong những điểm nổi bật của Python là khả năng hỗ trợ lập trình tương tác – cho phép người dùng viết, thực thi và kiểm tra mã theo từng bước trong môi trường như terminal hoặc Jupyter Notebook.</p>
<p>Trong bối cảnh học máy và phân tích dữ liệu hiện đại, việc lặp lại quá trình khám phá dữ liệu, tinh chỉnh mô hình và đánh giá kết quả là một yêu cầu thiết yếu. Python hỗ trợ tốt cho các quy trình lặp đi lặp lại này nhờ khả năng tương tác cao và thời gian phản hồi nhanh, từ đó thúc đẩy hiệu quả làm việc và sáng tạo của người phân tích.</p>
<p>Không dừng lại ở các ứng dụng phân tích, với tư cách là một ngôn ngữ lập trình tổng quát, Python còn cho phép phát triển các giao diện người dùng đồ họa (GUI), dịch vụ web, và tích hợp linh hoạt với các hệ thống phần mềm hiện có. Điều này giúp Python trở thành một công cụ không chỉ mạnh mẽ trong nghiên cứu mà còn có tính ứng dụng cao trong triển khai thực tế.</p>
<section id="thu-vien-xay-dung-mo-hinh-hoc-may">
<h3><span class="section-number">3.2.1. </span>Thư viện xây dựng mô hình học máy<a class="headerlink" href="#thu-vien-xay-dung-mo-hinh-hoc-may" title="Link to this heading">#</a></h3>
<hr><p><strong>Scikit-learn</strong> là một thư viện học máy mã nguồn mở được phát triển cho ngôn ngữ lập trình Python. Việc phát hành dưới giấy phép mã nguồn mở không chỉ giúp người dùng sử dụng và phân phối tự do, mà còn cho phép bất kỳ ai có thể truy cập, đọc và đóng góp vào mã nguồn của dự án. Scikit-learn là một trong những thư viện học máy phổ biến và có ảnh hưởng nhất hiện nay trong cả môi trường học thuật và doanh nghiệp.</p>
<p>Thư viện này liên tục được duy trì và cải tiến bởi một cộng đồng phát triển năng động, với nhiều bản cập nhật được phát hành thường xuyên nhằm mở rộng tính năng, cải thiện hiệu suất và tăng cường độ ổn định. Scikit-learn cung cấp triển khai hiệu quả của nhiều thuật toán học máy cổ điển và hiện đại, bao gồm hồi quy tuyến tính và logistic, cây quyết định, k-láng giềng gần nhất, các phương pháp phân cụm, và nhiều kỹ thuật khác.</p>
<p>Một trong những điểm mạnh nổi bật của scikit-learn là hệ thống tài liệu trực tuyến đầy đủ và chi tiết. Mỗi thuật toán đều được trình bày rõ ràng với phần mô tả lý thuyết, giao diện lập trình, ví dụ sử dụng và các thông số tùy chỉnh, giúp người học và nhà phát triển dễ dàng tiếp cận và áp dụng vào thực tế. Ngoài ra, thư viện còn tương thích tốt với các thành phần khác trong hệ sinh thái Python khoa học như NumPy, SciPy và matplotlib, cho phép tích hợp mượt mà trong các quy trình phân tích dữ liệu và phát triển mô hình.</p>
<p>Trong quá trình học tập, chúng tôi khuyến khích bạn đọc đồng thời tham khảo tài liệu chính thức và hướng dẫn sử dụng tại trang chủ của scikit-learn (<a class="reference external" href="https://scikit-learn.org">https://scikit-learn.org</a>). Việc kết hợp giữa lý thuyết được trình bày trong sách này và tài nguyên trực tuyến sẽ giúp bạn xây dựng nền tảng vững chắc để hiểu và vận dụng hiệu quả các kỹ thuật học máy.</p>
<p>Trong các chương cuối của cuốn sách, chúng ta sẽ được tiếp tục khám phá cách sử dụng scikit-learn để xây dựng, huấn luyện và đánh giá các mô hình học máy thông qua các ví dụ minh họa cụ thể.</p>
</section>
<section id="cac-thu-vien-va-cong-cu-ho-tro">
<h3><span class="section-number">3.2.2. </span>Các thư viện và công cụ hỗ trợ<a class="headerlink" href="#cac-thu-vien-va-cong-cu-ho-tro" title="Link to this heading">#</a></h3>
<hr><p>Việc hiểu rõ vai trò và cách sử dụng <strong>Scikit-learn</strong> là một yếu tố cốt lõi trong quá trình học tập và thực hành học máy với Python. Tuy nhiên, để khai thác hiệu quả toàn bộ tiềm năng của Scikit-learn, người học cần nắm vững một số thư viện nền tảng và công cụ hỗ trợ khác trong hệ sinh thái Python.</p>
<p>Trước hết, cần lưu ý rằng Scikit-learn được xây dựng dựa trên hai thư viện khoa học cốt lõi là thư viện <strong>NumPy</strong> và <strong>SciPy</strong>:</p>
<ul class="simple">
<li><p>NumPy cung cấp các cấu trúc dữ liệu hiệu quả và toán tử đại số tuyến tính cần thiết cho việc thao tác trên mảng số liệu nhiều chiều.</p></li>
<li><p>SciPy mở rộng chức năng của NumPy bằng cách cung cấp các thuật toán khoa học chuyên sâu như tối ưu hóa, tích phân số, nội suy và xử lý tín hiệu.</p></li>
</ul>
<p>Bên cạnh đó, hai thư viện phổ biến khác sẽ thường xuyên được sử dụng trong quá trình học tập là <strong>pandas</strong> và <strong>matplotlib</strong>:</p>
<ul class="simple">
<li><p>pandas hỗ trợ cấu trúc dữ liệu dạng bảng (DataFrame) linh hoạt, giúp việc tổ chức, làm sạch và thao tác dữ liệu trở nên dễ dàng và trực quan hơn.</p></li>
<li><p>matplotlib là một thư viện trực quan hóa dữ liệu mạnh mẽ, cho phép người học vẽ đồ thị, biểu đồ và hình ảnh trực quan hỗ trợ cho quá trình phân tích dữ liệu và đánh giá mô hình.</p></li>
</ul>
<p>Cuối cùng, chúng ta sẽ sử dụng <strong>Jupyter Notebook</strong> – một môi trường lập trình tương tác dựa trên trình duyệt – cho phép kết hợp mã nguồn, kết quả thực thi, hình ảnh trực quan và ghi chú văn bản trong cùng một giao diện. Đây là công cụ lý tưởng để thực hành học máy, chia sẻ quy trình phân tích và trình bày kết quả.</p>
<p>Tóm lại, để tận dụng tối đa sức mạnh của Scikit-learn, người học nên nắm vững các công cụ nền tảng sau:</p>
<ul class="simple">
<li><p>NumPy</p></li>
<li><p>SciPy</p></li>
<li><p>pandas</p></li>
<li><p>matplotlib</p></li>
<li><p>Jupyter Notebook</p></li>
</ul>
<p>Chúng sẽ là những thành phần quan trọng xuyên suốt toàn bộ nội dung của cuốn sách này, hỗ trợ bạn trong việc xây dựng, đánh giá và trực quan hóa các mô hình học máy một cách hiệu quả.</p>
<section id="thu-vien-numpy">
<h4><span class="section-number">3.2.2.1. </span>Thư viện NumPy<a class="headerlink" href="#thu-vien-numpy" title="Link to this heading">#</a></h4>
<hr><p><strong>NumPy</strong>, viết tắt của <em>Numerical Python</em>, là một trong những thư viện cơ bản và thiết yếu nhất cho tính toán khoa học trong Python. Thư viện này cung cấp các cấu trúc dữ liệu và hàm toán học hiệu quả phục vụ cho xử lý mảng và ma trận nhiều chiều, đồng thời hỗ trợ các phép toán đại số tuyến tính, biến đổi Fourier, và sinh số ngẫu nhiên giả.</p>
<p>Trong ngữ cảnh của học máy với Scikit-learn, <strong>mảng NumPy là cấu trúc dữ liệu cơ bản và bắt buộc</strong>. Hầu hết các thuật toán trong Scikit-learn đều được thiết kế để làm việc với dữ liệu dưới dạng mảng NumPy. Do đó, trước khi huấn luyện hoặc đánh giá bất kỳ mô hình học máy nào, dữ liệu đầu vào phải được chuyển đổi về dạng mảng nhiều chiều của NumPy.</p>
<p>Cấu trúc trung tâm trong NumPy là lớp <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, viết tắt của n-dimensional array – một mảng có thể có từ một chiều trở lên, với tất cả các phần tử trong mảng phải thuộc cùng một kiểu dữ liệu. Lớp <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> không chỉ hỗ trợ thao tác dữ liệu nhanh chóng và hiệu quả mà còn cung cấp khả năng tương tác tốt với các thư viện khác trong hệ sinh thái khoa học dữ liệu của Python.</p>
<p>Một mảng NumPy có thể có hình thức như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x:
[[1 2 3]
 [4 5 6]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="thu-vien-scipy">
<h4><span class="section-number">3.2.2.2. </span>Thư viện SciPy<a class="headerlink" href="#thu-vien-scipy" title="Link to this heading">#</a></h4>
<hr><p><strong>SciPy</strong> là một thư viện mở rộng được xây dựng trên nền tảng NumPy, cung cấp tập hợp các thuật toán và hàm toán học cao cấp nhằm phục vụ cho các nhu cầu tính toán khoa học chuyên sâu trong Python. SciPy bao gồm nhiều mô-đun chức năng, hỗ trợ các tác vụ như đại số tuyến tính nâng cao, tối ưu hóa hàm, xử lý tín hiệu, biến đổi Fourier, các hàm toán học đặc biệt và phân phối xác suất thống kê.</p>
<p>Trong bối cảnh học máy, Scikit-learn khai thác một số hàm và cấu trúc dữ liệu từ SciPy để triển khai các thuật toán học của mình. Do đó, SciPy có vai trò quan trọng trong việc hỗ trợ tính toán nền tảng và tối ưu hóa hiệu suất cho các mô hình học máy.</p>
<p>Một mô-đun đặc biệt đáng chú ý trong SciPy là <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code>, cung cấp các <strong>cấu trúc ma trận thưa</strong>, hay <em>sparse matrices</em>. Ma trận thưa là một dạng biểu diễn dữ liệu hai chiều trong đó phần lớn các phần tử có giá trị bằng 0. Thay vì lưu trữ toàn bộ các giá trị bao gồm cả các số không không cần thiết, <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code> chỉ lưu trữ thông tin cần thiết về vị trí và giá trị của các phần tử khác không. Cách tiếp cận này giúp tiết kiệm đáng kể bộ nhớ và cải thiện hiệu năng khi làm việc với dữ liệu có mật độ thấp.</p>
<p>Trong Scikit-learn, ma trận thưa thường được sử dụng cho các bài toán như xử lý văn bản, nơi dữ liệu đầu vào là các vectơ đặc trưng có số chiều rất lớn nhưng phần lớn là các giá trị 0. Việc hiểu và sử dụng <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code> là cần thiết để làm việc hiệu quả với những loại dữ liệu như vậy.</p>
<p>Ví dụ về tạo một ma trận thưa từ NumPy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Tạo một mảng NumPy 2D với đường chéo là các số một, và các số không ở mọi nơi khác</span>
<span class="n">eye</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mảng NumPy: </span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eye</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mảng NumPy: 
[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Chuyển đổi mảng NumPy thành ma trận thưa CSR của SciPy</span>
<span class="c1"># Chỉ các mục khác không được lưu trữ</span>
<span class="n">sparse_matrix</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">eye</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ma trận thưa CSR của SciPy:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sparse_matrix</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ma trận thưa CSR của SciPy:
&lt;Compressed Sparse Row sparse matrix of dtype &#39;float64&#39;
	with 4 stored elements and shape (4, 4)&gt;
  Coords	Values
  (0, 0)	1.0
  (1, 1)	1.0
  (2, 2)	1.0
  (3, 3)	1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="matplotlib">
<h4><span class="section-number">3.2.2.3. </span>matplotlib<a class="headerlink" href="#matplotlib" title="Link to this heading">#</a></h4>
<hr><p><strong>matplotlib</strong> là thư viện trực quan hóa dữ liệu khoa học tiêu chuẩn trong hệ sinh thái Python. Thư viện này cung cấp các công cụ linh hoạt và mạnh mẽ để tạo ra các hình ảnh chất lượng cao, phù hợp cho cả mục đích phân tích dữ liệu lẫn xuất bản học thuật. Với matplotlib, người dùng có thể dễ dàng xây dựng các biểu đồ đường, biểu đồ cột, biểu đồ phân tán, biểu đồ hộp, biểu đồ mật độ, và nhiều loại hình ảnh trực quan khác.</p>
<p>Trong quy trình phân tích dữ liệu, việc trực quan hóa đóng vai trò không thể thiếu vì nó giúp khám phá cấu trúc dữ liệu, phát hiện xu hướng, mô hình và bất thường tiềm ẩn mà các thống kê mô tả đơn thuần có thể không thể hiện được. Trong cuốn sách này, chúng ta sẽ sử dụng matplotlib như là công cụ chính để hiển thị và minh họa dữ liệu trong suốt quá trình học tập và thực hành.</p>
<p>Khi làm việc trong môi trường Jupyter Notebook, bạn có thể tích hợp trực tiếp hình ảnh vào trình duyệt bằng cách sử dụng các lệnh ma thuật (magic commands) của IPython. Cụ thể:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> hiển thị biểu đồ dưới dạng ảnh tĩnh ngay bên dưới ô lệnh.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code> cho phép tạo biểu đồ tương tác, hỗ trợ các thao tác như phóng to, xoay, hoặc di chuyển trực tiếp trong trình duyệt.</p></li>
</ul>
<p>Chúng tôi khuyến nghị sử dụng <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code> khi có thể, nhằm tận dụng tính năng tương tác nâng cao trong việc khám phá và trình bày dữ liệu. Dưới đây là một ví dụ về tạo đồ thị bằng <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Tạo một chuỗi số từ -10 đến 10 với 100 bước ở giữa</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># Tạo một mảng thứ hai sử dụng sin</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Hàm plot tạo một biểu đồ đường của một mảng so với một mảng khác</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x15adb2a6710&gt;]
</pre></div>
</div>
<img alt="../_images/840a5e340893354a02a1fc07ca3f1ac86cb0b07ad154f378692835f5d0e7c51e.png" src="../_images/840a5e340893354a02a1fc07ca3f1ac86cb0b07ad154f378692835f5d0e7c51e.png" />
</div>
</div>
</section>
<section id="thu-vien-pandas">
<h4><span class="section-number">3.2.2.4. </span>Thư viện pandas<a class="headerlink" href="#thu-vien-pandas" title="Link to this heading">#</a></h4>
<hr><p><strong>pandas</strong> là một thư viện mạnh mẽ trong Python được thiết kế để hỗ trợ thao tác và phân tích dữ liệu có cấu trúc. Trọng tâm của pandas là cấu trúc dữ liệu <strong>DataFrame</strong>, được mô hình hóa theo khái niệm DataFrame trong ngôn ngữ R. Về cơ bản, một DataFrame là một bảng dữ liệu hai chiều, tương tự như bảng tính trong Excel hoặc một bảng trong cơ sở dữ liệu quan hệ.</p>
<p>pandas cung cấp một tập hợp phong phú các phương thức hỗ trợ thao tác với dữ liệu, bao gồm lọc, gộp nhóm, chuyển định dạng, xử lý thiếu dữ liệu, và nhiều chức năng tiền xử lý phổ biến khác. Đặc biệt, DataFrame trong pandas hỗ trợ các truy vấn dữ liệu có cú pháp gần giống với SQL, cũng như các phép kết hợp bảng linh hoạt và hiệu quả.</p>
<p>Khác với NumPy – nơi các mảng ndarray yêu cầu tất cả phần tử phải có cùng kiểu dữ liệu – pandas cho phép mỗi cột trong <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> có kiểu dữ liệu riêng biệt (chẳng hạn: số nguyên, số thực, chuỗi, kiểu ngày giờ). Điều này đặc biệt hữu ích khi làm việc với dữ liệu thực tế, nơi các thuộc tính thường có kiểu dữ liệu không đồng nhất.</p>
<p>Một trong những tính năng đáng giá khác của pandas là khả năng <strong>nhập dữ liệu từ nhiều nguồn phổ biến</strong>, bao gồm:</p>
<ul class="simple">
<li><p>Tệp CSV</p></li>
<li><p>Tệp Excel</p></li>
<li><p>Cơ sở dữ liệu quan hệ</p></li>
<li><p>Tệp JSON, Parquet, v.v.</p></li>
</ul>
<p>pandas đóng vai trò quan trọng trong hầu hết các quy trình xử lý dữ liệu và là thành phần không thể thiếu trong chuỗi công cụ học máy với Python.</p>
<p>Ví dụ đơn giản sau đây minh họa cách tạo một DataFrame từ một đối tượng kiểu từ điển trong Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="c1"># tạo một tập dữ liệu đơn giản về mọi người</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Anna&quot;</span><span class="p">,</span> <span class="s2">&quot;Peter&quot;</span><span class="p">,</span> <span class="s2">&quot;Linda&quot;</span><span class="p">],</span>
        <span class="s1">&#39;Location&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Paris&quot;</span><span class="p">,</span> <span class="s2">&quot;Berlin&quot;</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">],</span>
        <span class="s1">&#39;Age&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">33</span><span class="p">]</span>
       <span class="p">}</span>

<span class="n">data_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># IPython.display cho phép &quot;in đẹp&quot; các dataframe</span>
<span class="c1"># trong Jupyter notebook</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_pandas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Location</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>New York</td>
      <td>24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>Paris</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Peter</td>
      <td>Berlin</td>
      <td>53</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linda</td>
      <td>London</td>
      <td>33</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="ung-dung-thuc-te-cua-mo-hinh-hoc-may">
<h2><span class="section-number">3.3. </span>Ứng dụng thực tế của mô hình học máy<a class="headerlink" href="#ung-dung-thuc-te-cua-mo-hinh-hoc-may" title="Link to this heading">#</a></h2>
<hr><p>Việc tiếp cận các mô hình học máy thông qua ví dụ thực tế không chỉ giúp người học hiểu rõ bản chất của thuật toán mà còn rút ngắn khoảng cách giữa lý thuyết và ứng dụng. Thay vì bắt đầu bằng các công thức trừu tượng hoặc mô hình tổng quát, việc quan sát cách một thuật toán xử lý dữ liệu thực — như dự đoán giá nhà hay phân loại khách hàng — sẽ tạo điều kiện cho người học hình thành trực giác và nhận diện được ý nghĩa thực tiễn của các bước trong quy trình học máy. Trong phần tiếp theo, chúng tôi sẽ giới thiệu nhiều ví dụ cụ thể để minh họa cách xây dựng, huấn luyện và đánh giá mô hình, từ đó củng cố kiến thức lý thuyết thông qua trải nghiệm trực tiếp.</p>
<section id="phan-loai-cac-loai-hoa-iris">
<h3><span class="section-number">3.3.1. </span>Phân loại các loài hoa Iris<a class="headerlink" href="#phan-loai-cac-loai-hoa-iris" title="Link to this heading">#</a></h3>
<hr><p>Trong phần này, chúng ta sẽ cùng tìm hiểu một ứng dụng học máy đơn giản và xây dựng mô hình đầu tiên. Thông qua ví dụ minh họa, một số khái niệm và thuật ngữ cốt lõi trong học máy sẽ được giới thiệu một cách trực quan và dễ tiếp cận.</p>
<p>Giả sử bạn là một nhà thực vật học nghiệp dư quan tâm đến việc phân biệt các loài hoa <em>Iris</em> bắt gặp trong tự nhiên. Nhằm phục vụ mục tiêu phân loại, bạn đã tiến hành thu thập một số đặc trưng định lượng của từng bông hoa, bao gồm: chiều dài và chiều rộng của cánh hoa (<em>petal length</em> và <em>petal width</em>), cùng với chiều dài và chiều rộng của đài hoa (<em>sepal length</em> và <em>sepal width</em>). Tất cả các giá trị đều được đo bằng đơn vị centimet.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/iris.png"><img alt="../_images/iris.png" src="../_images/iris.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Phân loại hoa iris dựa trên các thuộc tính là độ dài và độ rộng của các cánh hoa</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Bên cạnh các quan sát thực tế, bạn còn có trong tay một tập dữ liệu tham chiếu bao gồm các đặc trưng tương tự của những bông hoa <em>Iris</em> đã được phân loại chính xác bởi các nhà thực vật học chuyên nghiệp. Tập dữ liệu này bao gồm ba loài hoa phổ biến: <strong>Iris setosa</strong>, <strong>Iris versicolor</strong>, và <strong>Iris virginica</strong>. Giả định rằng đây là ba loài duy nhất sẽ xuất hiện trong quá trình quan sát ngoài thực địa.</p>
<p>Mục tiêu đặt ra là xây dựng một mô hình học máy có khả năng học từ tập dữ liệu đã được gán nhãn – nghĩa là với mỗi mẫu dữ liệu, loài của bông hoa đã được xác định rõ – từ đó dự đoán chính xác loài của một bông hoa mới chỉ dựa trên các đặc trưng hình thái đã được đo đạc.</p>
<p>Ví dụ này là một trường hợp điển hình của <strong>bài toán phân loại có giám sát</strong> (<em>supervised classification</em>), trong đó:</p>
<ul class="simple">
<li><p><strong>Đầu vào</strong> là một tập hợp các đặc trưng định lượng, trong dữ liệu iris là các phép đo về hình thái của hoa.</p></li>
<li><p><strong>Đầu ra</strong> là một <strong>nhãn</strong> rời rạc, là loài của hoa iris trong dữ liệu.</p></li>
</ul>
<p>Vì dữ liệu huấn luyện đã cung cấp thông tin về đầu ra mong muốn, đây là một bài toán <strong>học có giám sát</strong>. Trong bối cảnh này, nhãn là loài của bông hoa, còn các giá trị nhãn khả dĩ (Iris setosa, Iris versicolor, Iris virginica) được gọi là các <strong>lớp</strong>, hay các <em>classes</em>. Mỗi mẫu hoa trong tập dữ liệu huấn luyện thuộc về đúng một trong ba lớp này, do đó bài toán này là một ví dụ về bài toán phân loại nhiều lớp.</p>
<p>Trong các phần tiếp theo, chúng ta sẽ sử dụng tập dữ liệu <em>Iris</em> để huấn luyện mô hình phân loại, đánh giá độ chính xác và thảo luận các kỹ thuật đánh giá hiệu suất mô hình cơ bản.</p>
<section id="lam-quen-voi-du-lieu-phan-loai-hoa-iris">
<h4><span class="section-number">3.3.1.1. </span>Làm quen với dữ liệu phân loại hoa iris<a class="headerlink" href="#lam-quen-voi-du-lieu-phan-loai-hoa-iris" title="Link to this heading">#</a></h4>
<hr><p>Dữ liệu chúng ta sẽ sử dụng cho ứng dụng này là tập dữ liệu Iris, một tập dữ liệu đơn giản và kinh điển trong xây dựng mô hình học máy và thống kê. Dữ liệu này đã được chứa sẵn trong thư viện <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> trong mô-đun <code class="docutils literal notranslate"><span class="pre">datasets</span></code>. Chúng ta có thể tải dữ liệu bằng cách gọi hàm <code class="docutils literal notranslate"><span class="pre">load_iris</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Tải dữ liệu iris</span>
<span class="n">iris_dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="c1"># Tạo DataFrame từ dữ liệu và tên cột</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>

<span class="c1"># Thêm cột target (nhãn loài)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iris_dataset</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># (Tùy chọn) Thêm tên loài (setosa, versicolor, virginica)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="o">.</span><span class="n">from_codes</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">iris_dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>

<span class="c1"># Xem dữ liệu</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>target</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>0</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>2</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>2</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>2</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>2</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>2</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 6 columns</p>
</div></div></div>
</div>
<p>Dữ liệu có tên <code class="docutils literal notranslate"><span class="pre">df</span></code> chứa các phép đo định lượng tương ứng với <strong>150 bông hoa</strong> khác nhau, trong đó mỗi hàng đại diện cho một <strong>mẫu</strong> (<em>sample</em>), và mỗi cột đại diện cho một <strong>đặc trưng</strong> (<em>feature</em>) mô tả thuộc tính hình thái của bông hoa. Cụ thể, mỗi mẫu bao gồm bốn đặc trưng: chiều dài và chiều rộng của cánh hoa (<em>petal length</em>, <em>petal width</em>), và chiều dài và chiều rộng của đài hoa (<em>sepal length</em>, <em>sepal width</em>), được đo bằng đơn vị centimet.</p>
<p>Cấu trúc của mảng dữ liệu tuân theo quy ước chung trong scikit-learn: một mảng hai chiều với hình dạng <code class="docutils literal notranslate"><span class="pre">(n_samples,</span> <span class="pre">n_features)</span></code>, tức là số lượng mẫu nhân với số lượng đặc trưng. Trong trường hợp của tập dữ liệu <em>Iris</em>, mảng dữ liệu có kích thước <code class="docutils literal notranslate"><span class="pre">(150,</span> <span class="pre">4)</span></code>, nghĩa là có 150 mẫu và mỗi mẫu có 4 đặc trưng.</p>
<p>Ví dụ, khi quan sát năm mẫu đầu tiên, ta thấy rằng tất cả đều có chiều rộng cánh hoa là 0.2 cm, và trong đó bông hoa đầu tiên có đài hoa dài nhất với chiều dài 5.1 cm. Những quan sát sơ bộ này cho phép người học bắt đầu hình dung mối quan hệ giữa các đặc trưng hình thái và loài hoa.</p>
<p>Song song với 4 đặc trưng, dữ liệu cũng cung cột <code class="docutils literal notranslate"><span class="pre">target</span></code>, là một mảng một chiều có chiều dài bằng số mẫu, trong đó mỗi phần tử là một nhãn số nguyên đại diện cho loài của bông hoa tương ứng trong cột <code class="docutils literal notranslate"><span class="pre">species</span></code>. Cụ thể:</p>
<ul class="simple">
<li><p>Nhãn 0 tương ứng với <em>setosa</em></p></li>
<li><p>Nhãn 1 tương ứng với <em>versicolor</em></p></li>
<li><p>Nhãn 2 tương ứng với <em>virginica</em></p></li>
</ul>
<p>Như vậy, mảng <code class="docutils literal notranslate"><span class="pre">target</span></code> đóng vai trò là nhãn giám sát, hay <em>labels</em>, trong bài toán phân loại có giám sát. Việc hiểu rõ cấu trúc này là điều kiện tiên quyết để xử lý và huấn luyện các mô hình học máy trên dữ liệu <em>Iris</em> một cách chính xác.</p>
</section>
<section id="du-lieu-huan-luyen-mo-hinh-va-du-lieu-kiem-tra-mo-hinh">
<h4><span class="section-number">3.3.1.2. </span>Dữ liệu huấn luyện mô hình và dữ liệu kiểm tra mô hình<a class="headerlink" href="#du-lieu-huan-luyen-mo-hinh-va-du-lieu-kiem-tra-mo-hinh" title="Link to this heading">#</a></h4>
<hr><p>Mục tiêu của chúng ta là xây dựng một mô hình học máy có khả năng dự đoán loài <em>Iris</em> dựa trên các phép đo hình thái học. Tuy nhiên, trước khi áp dụng mô hình cho các dữ liệu mới, một câu hỏi quan trọng cần được đặt ra: <em>Làm thế nào để biết mô hình có hoạt động hiệu quả không?</em></p>
<p>Một sai lầm phổ biến là <strong>đánh giá hiệu suất của mô hình bằng chính dữ liệu đã được sử dụng để huấn luyện nó</strong>. Cách tiếp cận này dễ dẫn đến hiện tượng <strong>khớp quá mức</strong>, hay còn gọi là <em>overfitting</em>, trong đó mô hình chỉ đơn giản là ghi nhớ toàn bộ tập huấn luyện thay vì học cách <strong>tổng quát hóa từ dữ liệu</strong>. Kết quả là, mô hình có thể đạt độ chính xác tuyệt đối trên dữ liệu huấn luyện nhưng lại hoạt động kém khi gặp dữ liệu mới.</p>
<p>Để đánh giá khách quan hiệu suất của mô hình, ta cần kiểm tra nó trên những <strong>dữ liệu mà nó chưa từng thấy trước đó</strong> — nhưng chúng ta vẫn cần có nhãn để so sánh kết quả dự đoán. Thực tế này dẫn đến một quy trình chuẩn trong học máy: chia tập dữ liệu có nhãn thành hai phần:</p>
<ul class="simple">
<li><p><strong>Tập huấn luyện</strong> (<em>training set</em>): Dùng để xây dựng mô hình.</p></li>
<li><p><strong>Tập kiểm tra</strong> (<em>test set</em>): Dùng để đánh giá mô hình sau khi huấn luyện.</p></li>
</ul>
<p>Trong scikit-learn, quá trình này được hỗ trợ bởi hàm <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code>, cho phép người dùng dễ dàng xáo trộn và phân chia dữ liệu một cách ngẫu nhiên. Theo thông lệ phổ biến, khoảng 50% đến 80% dữ liệu được sử dụng để huấn luyện và 50% đến 20% còn lại dành cho kiểm tra. Nguyên tắc phân chia được điều chỉnh tùy theo mục tiêu và kích thước của tập dữ liệu.</p>
<p>Một lưu ý quan trọng trước khi chia dữ liệu là chúng ta cần phải <strong>trộn toàn bộ dữ liệu một cách ngẫu nhiên</strong> để đảm bảo sự đa dạng và đại diện của cả ba lớp, bao gồm <em>setosa</em>, <em>versicolor</em>, <em>virginica</em>, trong cả hai tập huấn luyện và kiểm tra. Điều này là cần thiết bởi vì dữ liệu <em>Iris</em> mặc định được sắp xếp theo nhãn. Nếu chỉ lấy 30% cuối của dữ liệu làm tập kiểm tra, toàn bộ mẫu kiểm tra sẽ chỉ chứa một lớp duy nhất, chẳng hạn toàn bộ là <em>Iris virginica</em>, dẫn đến việc đánh giá sai lệch và không phản ánh đúng khả năng tổng quát hóa của mô hình.</p>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> thực hiện việc trộn dữ liệu một cách ngẫu nhiên. Để đảm bảo khả năng kiểm soát kết quả thực nghiệm, ta có thể truyền một giá trị cụ thể vào tham số <code class="docutils literal notranslate"><span class="pre">random_state</span></code> trong hàm <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> để cố định bộ tạo số ngẫu nhiên với mục đích tái lập việc chia dữ liệu trong các lần chạy sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;sepal length (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;sepal width (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;petal length (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;petal width (cm)&quot;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">],</span> 
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">Y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hình dạng X_train: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hình dạng Y_train: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hình dạng X_train: (105, 4)
Hình dạng Y_train: (105,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hình dạng X_test: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hình dạng Y_test: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hình dạng X_test: (45, 4)
Hình dạng Y_test: (45,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="phan-tich-du-lieu-kham-pha-eda">
<h4><span class="section-number">3.3.1.3. </span>Phân tích dữ liệu khám phá (EDA)<a class="headerlink" href="#phan-tich-du-lieu-kham-pha-eda" title="Link to this heading">#</a></h4>
<hr><p>Trước khi tiến hành xây dựng một mô hình học máy, việc kiểm tra và khám phá dữ liệu là một bước quan trọng không thể bỏ qua. Quá trình này không chỉ giúp xác định mức độ phù hợp của dữ liệu đối với bài toán học máy mà còn hỗ trợ đánh giá xem liệu bài toán có thể được giải quyết bằng các phương pháp phân tích đơn giản hơn, mà không cần đến mô hình hóa phức tạp.</p>
<p>Một mục tiêu khác của bước khám phá dữ liệu là phát hiện ra các điểm bất thường hoặc sai lệch tiềm ẩn. Trong các ứng dụng thực tế, dữ liệu thu thập thường không hoàn hảo: có thể chứa giá trị thiếu, lỗi đo lường, hoặc sự không nhất quán về đơn vị. Ví dụ, một số mẫu hoa <em>Iris</em> có thể đã được đo bằng inch thay vì centimet, gây ảnh hưởng nghiêm trọng đến kết quả phân tích nếu không được phát hiện và xử lý kịp thời.</p>
<p>Một trong những phương pháp hiệu quả nhất để khám phá dữ liệu là thông qua trực quan hóa. Cách tiếp cận đơn giản và phổ biến nhất là sử dụng <strong>biểu đồ phân tán</strong>, trong đó một đặc trưng được đặt trên trục hoành và một đặc trưng khác trên trục tung. Mỗi điểm dữ liệu sẽ được biểu diễn bằng một dấu chấm trên mặt phẳng hai chiều, cho phép người quan sát nhận diện trực tiếp các mối quan hệ tuyến tính, cụm dữ liệu, hoặc ngoại lệ.</p>
<p>Tuy nhiên, do hạn chế của không gian hiển thị hai chiều, việc trực quan hóa toàn bộ tập dữ liệu nhiều chiều là điều không khả thi. Một giải pháp khả thi trong trường hợp số lượng đặc trưng còn tương đối nhỏ là sử dụng <strong>biểu đồ cặp</strong>, hay còn gọi là <em>pair plot</em>. Biểu đồ này hiển thị tất cả các cặp kết hợp có thể giữa các đặc trưng, cho phép người dùng quan sát các mối liên hệ hai chiều giữa từng cặp biến. Trong trường hợp tập dữ liệu Iris, với chỉ bốn đặc trưng, phương pháp này hoàn toàn phù hợp.</p>
<p>Tuy nhiên, cần lưu ý rằng biểu đồ cặp chỉ thể hiện mối quan hệ giữa hai đặc trưng tại một thời điểm. Do đó, những tương tác phức tạp hơn liên quan đến ba hoặc nhiều đặc trưng cùng lúc có thể không được thể hiện đầy đủ qua hình thức trực quan này. Điều này nhấn mạnh tầm quan trọng của việc kết hợp nhiều phương pháp khám phá dữ liệu khác nhau, bao gồm cả phân tích thống kê và kỹ thuật giảm chiều, nhằm hiểu rõ hơn về cấu trúc và hành vi của tập dữ liệu trước khi áp dụng các thuật toán học máy.</p>
<p>Trước tiên chúng ta xem một vài thống kê mô tả của các đặc trưng và biến mục tiêu trong dữ liệu huấn luyện:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\AD\AppData\Local\Temp\ipykernel_23516\1437903973.py:1: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  X_train.groupby(Y_train).agg([&quot;mean&quot;, &quot;std&quot;, &quot;min&quot;, &quot;max&quot;])
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">sepal length (cm)</th>
      <th colspan="4" halign="left">sepal width (cm)</th>
      <th colspan="4" halign="left">petal length (cm)</th>
      <th colspan="4" halign="left">petal width (cm)</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>setosa</th>
      <td>5.047222</td>
      <td>0.374537</td>
      <td>4.3</td>
      <td>5.8</td>
      <td>3.480556</td>
      <td>0.371729</td>
      <td>2.9</td>
      <td>4.4</td>
      <td>1.463889</td>
      <td>0.175910</td>
      <td>1.0</td>
      <td>1.9</td>
      <td>0.236111</td>
      <td>0.099003</td>
      <td>0.1</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>versicolor</th>
      <td>5.948485</td>
      <td>0.539746</td>
      <td>4.9</td>
      <td>7.0</td>
      <td>2.766667</td>
      <td>0.293329</td>
      <td>2.2</td>
      <td>3.2</td>
      <td>4.209091</td>
      <td>0.518027</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.318182</td>
      <td>0.209843</td>
      <td>1.0</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>virginica</th>
      <td>6.541667</td>
      <td>0.650879</td>
      <td>4.9</td>
      <td>7.9</td>
      <td>2.983333</td>
      <td>0.322047</td>
      <td>2.2</td>
      <td>3.8</td>
      <td>5.538889</td>
      <td>0.534671</td>
      <td>4.5</td>
      <td>6.7</td>
      <td>2.005556</td>
      <td>0.290757</td>
      <td>1.4</td>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>counts</th>
      <th>freqs</th>
    </tr>
    <tr>
      <th>categories</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>setosa</th>
      <td>36</td>
      <td>0.342857</td>
    </tr>
    <tr>
      <th>versicolor</th>
      <td>33</td>
      <td>0.314286</td>
    </tr>
    <tr>
      <th>virginica</th>
      <td>36</td>
      <td>0.342857</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Có thể thấy rằng có sự khác biệt tương đối giữa các đặc trưng của ba loại hoa trong dữ liệu. Hai đặc trưng có sự phân biệt rõ nhất là <code class="docutils literal notranslate"><span class="pre">petal</span> <span class="pre">length</span></code> và <code class="docutils literal notranslate"><span class="pre">petal</span> <span class="pre">width</span></code>. Tuy nhiên thống kê mô tả chỉ cho chúng ta cảm nhận về từng biến riêng lẻ mà không nhìn nhận được mối liên hệ giữa các đặc trưng. Một cách trực quan để đánh giá mối liên hệ giữa các đặc trưng của từng loại hoa iris là trực quan hóa sử dụng đồ thị phân tán:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">X_train</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;petal length (cm)&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;petal width (cm)&quot;</span><span class="p">,</span>
    <span class="n">hue</span> <span class="o">=</span> <span class="n">Y_train</span><span class="p">,</span>  
    <span class="n">palette</span> <span class="o">=</span> <span class="s2">&quot;Set1&quot;</span><span class="p">,</span> 
    <span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># size điểm</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Biểu đồ phân tán Petal Length vs. Petal Width theo loại hoa&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/483856662749727a140fc9ff33cc8311feee8cee7f9714ad3bc8826327619708.png" src="../_images/483856662749727a140fc9ff33cc8311feee8cee7f9714ad3bc8826327619708.png" />
</div>
</div>
<p>Quan sát từ các biểu đồ trực quan cho thấy rằng ba lớp loài hoa có xu hướng được phân tách khá rõ ràng thông qua các đặc trưng hình thái của đài hoa. Điều này gợi ý rằng một mô hình học máy nhiều khả năng sẽ có thể học được các ranh giới phân biệt hiệu quả giữa các lớp dựa trên các đặc trưng này. Bạn đọc có thể tiếp tục trực quan hóa các đặc trưng khác để tìm ra các đặc trưng quan trọng khác.</p>
<p>Nhìn chung, quá trình phân tích dữ liệu khám phá đóng vai trò đặc biệt quan trọng trong việc lựa chọn các đặc trưng phù hợp để đưa vào mô hình học máy. Việc hiểu rõ cấu trúc, mối quan hệ và phân phối của các biến trong dữ liệu không chỉ giúp phát hiện các bất thường tiềm ẩn mà còn là cơ sở để xây dựng biểu diễn đầu vào hiệu quả. Chính chất lượng của bước lựa chọn đặc trưng này có ảnh hưởng trực tiếp đến hiệu suất tổng thể và khả năng khái quát hóa của mô hình.</p>
<p>Do đây chỉ là một ví dụ đơn giản, với ít đặc trưng, nên chúng tôi không đi sâu vào quá trình này mà sẽ sử dụng cả bốn đặc trưng ban đầu của dữ liệu để xây dựng mô hình</p>
</section>
<section id="mo-hinh-dau-tien-k-lang-gieng-gan-nhat">
<h4><span class="section-number">3.3.1.4. </span>Mô hình đầu tiên: k-láng giềng gần nhất<a class="headerlink" href="#mo-hinh-dau-tien-k-lang-gieng-gan-nhat" title="Link to this heading">#</a></h4>
<hr><p>Sau khi hoàn tất quá trình khám phá và tiền xử lý dữ liệu, chúng ta có thể bắt đầu xây dựng mô hình học máy đầu tiên. Thư viện <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> cung cấp nhiều thuật toán phân loại khác nhau, và trong phần này, chúng ta sẽ sử dụng một trong những thuật toán cơ bản và dễ hiểu nhất: phân loại bằng mô hình k-láng giềng gần nhất, hay <em>k-nearest neighbors classification</em>.</p>
<p>Mô hình k-láng giềng gần nhất là mô hình <strong>phi tham số</strong> vì không có một dạng tham số cụ thể cho mối liên hệ giữa các đặc trưng và biến mục tiêu. Ý tưởng cốt lõi của thuật toán này là rất trực quan: quá trình huấn luyện không liên quan đến việc tìm kiếm các tham số, mà chỉ đơn giản là lưu trữ toàn bộ tập huấn luyện. Khi cần dự đoán nhãn cho một điểm dữ liệu mới, thuật toán sẽ tìm các điểm trong tập huấn luyện có khoảng cách gần nhất với điểm mới đó, sau đó gán nhãn của đa số các điểm gần nhất làm kết quả dự đoán.</p>
<p>Tham số <code class="docutils literal notranslate"><span class="pre">k</span></code> trong tên gọi thuật toán đề cập đến số lượng điểm láng giềng được xem xét. Thay vì chỉ sử dụng một hàng xóm gần nhất, ta có thể xét <code class="docutils literal notranslate"><span class="pre">k</span></code> hàng xóm gần nhất, ví dụ là 3 hoặc 5, hoặc nhiều hơn. Nhãn được dự đoán sẽ là nhãn chiếm đa số trong số các hàng xóm này. Việc tăng <code class="docutils literal notranslate"><span class="pre">k</span></code> giúp làm giảm độ nhạy của mô hình với nhiễu hoặc các điểm bất thường trong dữ liệu huấn luyện. Trong ví dụ hiện tại, để đơn giản hóa, chúng ta sẽ sử dụng <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">3</span></code>, tức là chỉ xét ba láng giềng gần nhất.</p>
<p>Tất cả các thuật toán học máy trong scikit-learn đều được tổ chức dưới dạng các lớp riêng biệt, được gọi là <strong>Estimator</strong>, đại diện cho các mô hình học có thể huấn luyện và dự đoán. Thuật toán k- điểm láng giềng gần nhất được triển khai trong lớp <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>, thuộc mô-đun <code class="docutils literal notranslate"><span class="pre">sklearn.neighbors</span></code>.</p>
<p>Trước khi sử dụng mô hình, chúng ta cần khởi tạo một instance của lớp <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>. Tại thời điểm khởi tạo, các siêu tham số của mô hình có thể được thiết lập — trong trường hợp này là số lượng hàng xóm (<code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code>), mà chúng ta sẽ đặt bằng k = 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sau khi khởi tạo đối tượng <code class="docutils literal notranslate"><span class="pre">knn</span></code> từ lớp <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>, đối tượng này sẽ đóng vai trò là mô hình học máy, bao gồm cả thuật toán được sử dụng để huấn luyện mô hình từ dữ liệu và thuật toán để dự đoán trên các điểm dữ liệu mới. Bên cạnh đó, đối tượng còn lưu giữ các thông tin được trích xuất từ tập huấn luyện trong quá trình huấn luyện. Trong trường hợp của <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>, thông tin được lưu trữ đơn giản là toàn bộ tập dữ liệu huấn luyện, do thuật toán không thực hiện quá trình học tham số rõ ràng mà chỉ dựa trên khoảng cách đến các điểm đã biết.</p>
<p>Để thực hiện quá trình huấn luyện, ta sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> của đối tượng mô hình. Phương thức này nhận vào hai đối số:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_train</span></code>: một mảng NumPy hai chiều chứa dữ liệu huấn luyện, trong đó mỗi hàng tương ứng với một mẫu và mỗi cột là một đặc trưng.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y_train</span></code>: một mảng một chiều chứa nhãn tương ứng cho mỗi mẫu trong <code class="docutils literal notranslate"><span class="pre">X_train</span></code>.</p></li>
</ul>
<p>Lệnh huấn luyện được thực hiện như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier(n_neighbors=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>KNeighborsClassifier</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">?<span>Documentation for KNeighborsClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>KNeighborsClassifier(n_neighbors=3)</pre></div> </div></div></div></div></div></div>
</div>
<p>Phương thức <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> trong scikit-learn không chỉ thực hiện việc huấn luyện mô hình mà còn trả về chính đối tượng mô hình đã được huấn luyện, đồng thời sửa đổi nó tại chỗ. Do đó, khi gọi <code class="docutils literal notranslate"><span class="pre">fit</span></code>, ta nhận được một biểu diễn chuỗi của đối tượng mô hình, cho biết cấu hình và các tham số đã được sử dụng trong quá trình khởi tạo.</p>
<p>Ví dụ, sau khi gọi <code class="docutils literal notranslate"><span class="pre">knn.fit(X_train,</span> <span class="pre">Y_train)</span></code>, nếu in ra đối tượng <code class="docutils literal notranslate"><span class="pre">knn</span></code>, bạn sẽ thấy một chuỗi hiển thị tên lớp (<code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>) cùng với các tham số tương ứng. Trong số đó, tham số <code class="docutils literal notranslate"><span class="pre">n_neighbors=3</span></code> sẽ được liệt kê rõ ràng, vì đây là giá trị mà người dùng đã chỉ định. Các tham số còn lại thường giữ nguyên giá trị mặc định, được thiết kế để hoạt động tốt trong đa số trường hợp hoặc dành cho các tình huống sử dụng đặc biệt.</p>
<p>Mặc dù biểu diễn chuỗi của một mô hình scikit-learn có thể trông khá dài và phức tạp, bạn đọc không cần cảm thấy bị choáng ngợp. Phần lớn các tham số mặc định là các tối ưu hóa liên quan đến tốc độ hoặc độ ổn định, và chỉ một số ít trong số đó có ảnh hưởng đáng kể đến hành vi của mô hình. Các tham số quan trọng và thường được điều chỉnh sẽ được trình bày chi tiết trong các chương liên quan đến xây dựng mô hình.</p>
<p>Sau khi mô hình đã được huấn luyện, chúng ta có thể sử dụng nó để dự đoán loài hoa cho các điểm dữ liệu mới mà chưa được gán nhãn. Đây chính là mục tiêu cuối cùng của một mô hình phân loại: khả năng khái quát hóa để đưa ra dự đoán chính xác cho dữ liệu chưa từng gặp trước đó.</p>
<p>Giả sử trong một nghiên cứu thực địa, chúng ta bắt gặp một bông hoa <em>Iris</em> mới và tiến hành đo các đặc trưng hình thái học như sau:</p>
<ul class="simple">
<li><p>Chiều dài đài hoa (<em>sepal length</em>): 5.0 cm</p></li>
<li><p>Chiều rộng đài hoa (<em>sepal width</em>): 2.9 cm</p></li>
<li><p>Chiều dài cánh hoa (<em>petal length</em>): 1.0 cm</p></li>
<li><p>Chiều rộng cánh hoa (<em>petal width</em>): 0.2 cm</p></li>
</ul>
<p>Mục tiêu là xác định *loài của bông hoa này dựa trên các đặc trưng nêu trên.</p>
<p>Trước khi có thể đưa điểm dữ liệu mới này vào mô hình để dự đoán, chúng ta cần đảm bảo rằng nó có đúng định dạng đầu vào như dữ liệu huấn luyện: một mảng NumPy hai chiều với hình dạng <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">4)</span></code>, tương ứng với một mẫu và bốn đặc trưng.</p>
<p>Dưới đây là cách biểu diễn mẫu mới dưới dạng mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Để đưa ra dự đoán, chúng ta gọi phương thức <code class="docutils literal notranslate"><span class="pre">predict</span></code> của đối tượng <code class="docutils literal notranslate"><span class="pre">knn</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dự đoán: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dự đoán: [&#39;setosa&#39;]
</pre></div>
</div>
</div>
</div>
<p>Khi áp dụng mô hình học máy đã huấn luyện để phân loại một điểm dữ liệu mới, chẳng hạn như bông hoa <em>Iris</em> có các đặc trưng được nêu ở trên, mô hình dự đoán rằng mẫu này thuộc lớp 0, tương ứng với loài <em>Iris setosa</em>. Tuy nhiên, việc mô hình đưa ra một nhãn dự đoán không đồng nghĩa với việc chúng ta có thể hoàn toàn tin tưởng vào kết quả này.</p>
<p>Một câu hỏi thiết yếu trong học máy là: <em>Làm thế nào để biết liệu mô hình có đưa ra dự đoán đáng tin cậy hay không?</em></p>
<p>Trong thực tế, với các điểm dữ liệu mới được thu thập, chúng ta không biết nhãn thực tế – chính vì lý do này mà ta mới cần đến mô hình học máy để suy luận. Do đó, việc đánh giá hiệu suất mô hình không thể dựa trên các dự đoán đơn lẻ cho dữ liệu không có nhãn.</p>
<p>Thay vào đó, để kiểm tra và đánh giá độ chính xác tổng thể của mô hình, ta sử dụng một phần dữ liệu đã được gán nhãn nhưng <strong>không tham gia vào quá trình huấn luyện</strong>. Đây chính là vai trò của <strong>tập kiểm tra</strong> trong quy trình học có giám sát. Việc đánh giá mô hình trên tập kiểm tra sẽ giúp ta đo lường được khả năng tổng quát hóa của mô hình — tức là, mô hình có thể áp dụng tốt đến mức nào với dữ liệu mới mà nó chưa từng thấy trong quá trình huấn luyện.</p>
<p>Đây là lúc tập kiểm tra mà chúng ta đã tạo trước đó phát huy tác dụng. Dữ liệu này không được sử dụng để xây dựng mô hình, nhưng chúng ta biết loài chính xác của mỗi bông hoa iris trong tập kiểm tra.</p>
<p>Do đó, chúng ta có thể đưa ra dự đoán cho mỗi bông hoa iris trong dữ liệu kiểm tra và so sánh nó với nhãn của nó. Chúng ta có thể đo lường mô hình hoạt động tốt như thế nào bằng cách tính toán độ chính xác, là tỷ lệ phần trăm các bông hoa được dự đoán đúng loài:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dự đoán tập kiểm tra:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dự đoán tập kiểm tra:
 [&#39;versicolor&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;virginica&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;virginica&#39;
 &#39;versicolor&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;virginica&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;setosa&#39;
 &#39;setosa&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;virginica&#39; &#39;versicolor&#39;
 &#39;versicolor&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;virginica&#39;
 &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;setosa&#39; &#39;versicolor&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Điểm tập kiểm tra: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y_pred</span> <span class="o">==</span> <span class="n">Y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Điểm tập kiểm tra: 0.98
</pre></div>
</div>
</div>
</div>
<p>Chúng ta cũng có thể sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">score</span></code> của đối tượng <code class="docutils literal notranslate"><span class="pre">knn</span></code>. Phương thức này sẽ tính toán độ chính xác của tập kiểm tra cho chúng ta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Điểm tập kiểm tra: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Điểm tập kiểm tra: 0.98
</pre></div>
</div>
</div>
</div>
<p>Sau khi áp dụng mô hình đã huấn luyện lên tập dữ liệu kiểm tra, chúng ta thu được độ chính xác, hay <em>accuracy</em>, xấp xỉ <strong>0.98</strong>, nghĩa là mô hình đã dự đoán chính xác nhãn cho khoảng <strong>98% số mẫu</strong> trong tập kiểm tra. Chỉ số này phản ánh mức độ tương đồng giữa nhãn dự đoán và nhãn thực tế của các mẫu mà mô hình chưa từng được tiếp xúc trong quá trình huấn luyện.</p>
<p>Dưới một số giả định nhất định về tính đại diện của tập kiểm tra và phân phối dữ liệu, độ chính xác này có thể được hiểu như một ước lượng cho khả năng mô hình sẽ hoạt động chính xác trên các điểm dữ liệu mới. Cụ thể, chúng ta có thể kỳ vọng rằng mô hình sẽ đưa ra dự đoán đúng khoảng 98% số lần khi được áp dụng vào các bông hoa <em>Iris</em> mới trong điều kiện tương tự.</p>
<p>Trong bối cảnh ứng dụng thực tế của một nhà thực vật học nghiệp dư, mức độ chính xác cao như vậy là đủ để khẳng định rằng mô hình có thể được sử dụng một cách đáng tin cậy nhằm hỗ trợ phân loại loài hoa trong môi trường tự nhiên.</p>
<p>Tuy nhiên, cần lưu ý rằng độ chính xác không phải là chỉ số duy nhất để đánh giá hiệu suất mô hình, đặc biệt trong các bài toán mất cân bằng lớp hoặc có chi phí sai lệch cao. Trong các chương liên quan đến xây dựng mô hình, chúng ta sẽ khám phá các kỹ thuật cải thiện hiệu suất mô hình, cũng như những khía cạnh cần cân nhắc khi điều chỉnh các siêu tham số và lựa chọn thuật toán phù hợp cho từng bài toán cụ thể.</p>
</section>
<section id="mo-hinh-thu-hai-mo-hinh-cay-quyet-dinh">
<h4><span class="section-number">3.3.1.5. </span>Mô hình thứ hai: mô hình cây quyết định<a class="headerlink" href="#mo-hinh-thu-hai-mo-hinh-cay-quyet-dinh" title="Link to this heading">#</a></h4>
<hr><p>Mô hình <strong>cây quyết định</strong> là một thuật toán học máy thuộc nhóm mô hình <strong>có tham số</strong>, thường được sử dụng trong các bài toán phân loại và hồi quy. Khác với các mô hình dựa trên khoảng cách như k-láng giềng gần nhất, cây quyết định tìm kiếm các quy tắc phân tách dữ liệu dựa trên các ngưỡng của các đặc trưng, từ đó xây dựng một cấu trúc dạng cây nhằm ánh xạ các đặc trưng đầu vào đến biến mục tiêu.</p>
<p>Ý tưởng cốt lõi của cây quyết định là chia nhỏ không gian đặc trưng thành các vùng mà trong mỗi vùng, các mẫu thuộc cùng một lớp mục tiêu là đồng nhất nhất có thể. Mỗi nút trong cây tương ứng với một điều kiện phân chia trên một đặc trưng, và quá trình dự đoán được thực hiện bằng cách dẫn mẫu dữ liệu từ gốc cây đến một lá cây thông qua các điều kiện logic.</p>
<p>Một trong những ưu điểm lớn của cây quyết định là khả năng diễn giải mô hình một cách trực quan, dễ hiểu và không yêu cầu chuẩn hóa dữ liệu đầu vào. Tuy nhiên, cây quyết định đơn giản có thể dễ bị khớp quá mức nếu không được kiểm soát độ sâu hoặc số lượng mẫu tối thiểu tại mỗi nút phân chia.</p>
<p>Trong scikit-learn, mô hình cây quyết định được triển khai trong lớp <code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier</span></code>, thuộc mô-đun <code class="docutils literal notranslate"><span class="pre">sklearn.tree</span></code>. Giống như các thuật toán học máy khác trong scikit-learn, <code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier</span></code> là một lớp kế thừa từ <code class="docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, hỗ trợ các phương thức chuẩn như <code class="docutils literal notranslate"><span class="pre">.fit()</span></code>, <code class="docutils literal notranslate"><span class="pre">.predict()</span></code>, và <code class="docutils literal notranslate"><span class="pre">.score()</span></code>.</p>
<p>Để sử dụng mô hình, chúng ta cần khởi tạo một đối tượng từ lớp <code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier</span></code>. Tại thời điểm khởi tạo, có thể thiết lập nhiều siêu tham số, trong đó quan trọng nhất là <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>, quy định độ sâu tối đa của cây — một yếu tố quan trọng kiểm soát độ phức tạp và khả năng khái quát của mô hình. Trong ví dụ này, chúng ta sẽ giới hạn độ sâu của cây là 2, nghĩa là cây quyết định chỉ có 3 lá:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="c1"># Khởi tạo mô hình cây quyết định với độ sâu tối đa là 2</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Việc huấn luyện mô hình hoàn toàn tương tự như với thuật toán k-láng giềng gần nhất</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier(max_depth=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>DecisionTreeClassifier</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.tree.DecisionTreeClassifier.html">?<span>Documentation for DecisionTreeClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>DecisionTreeClassifier(max_depth=2)</pre></div> </div></div></div></div></div></div>
</div>
<p>Chúng ta dự đoán về loài hoa trên một dữ liệu mới:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]])</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dự đoán: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dự đoán: [&#39;setosa&#39;]
</pre></div>
</div>
</div>
</div>
<p>Xây dựng dự đoán trên toàn bộ dữ liệu kiểm tra:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dự đoán tập kiểm tra:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dự đoán tập kiểm tra:
 [&#39;versicolor&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;versicolor&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;virginica&#39;
 &#39;versicolor&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;virginica&#39; &#39;versicolor&#39; &#39;setosa&#39; &#39;setosa&#39;
 &#39;setosa&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;virginica&#39; &#39;versicolor&#39;
 &#39;versicolor&#39; &#39;versicolor&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;virginica&#39;
 &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;versicolor&#39;
 &#39;setosa&#39; &#39;versicolor&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Điểm tập kiểm tra: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Điểm tập kiểm tra: 0.98
</pre></div>
</div>
</div>
</div>
<p>Có thể thấy rằng mô hình cây quyết định cũng có khả năng dự đoán chính xác là 98% tương đương với k-láng giềng gần nhất.</p>
</section>
</section>
<section id="du-doan-gia-bat-dong-san-tai-ha-noi">
<h3><span class="section-number">3.3.2. </span>Dự đoán giá bất động sản tại Hà Nội<a class="headerlink" href="#du-doan-gia-bat-dong-san-tai-ha-noi" title="Link to this heading">#</a></h3>
<hr><section id="du-lieu-va-bai-toan-du-doan-gia-bat-dong-san">
<h4><span class="section-number">3.3.2.1. </span>Dữ liệu và baì toán dự đoán giá bất động sản<a class="headerlink" href="#du-lieu-va-bai-toan-du-doan-gia-bat-dong-san" title="Link to this heading">#</a></h4>
<hr><p>Sau một vài năm đi làm và tích lũy được một khoản tiết kiệm nho nhỏ, bạn bắt đầu nghiêm túc nghĩ đến việc mua một căn nhà để ổn định cuộc sống tại Hà Nội. Tuy nhiên, quá trình tìm hiểu thị trường bất động sản khiến bạn không khỏi bối rối: cùng một diện tích, mức giá có thể chênh lệch đáng kể chỉ vì khác vài con phố; nhiều nơi quảng cáo hấp dẫn nhưng giá lại vượt xa giá trị thực tế; và gần như không có công cụ nào giúp bạn xác định liệu một căn nhà có đang bị định giá quá cao hay không.</p>
<p>Trong bối cảnh thị trường còn chưa minh bạch, thông tin phân tán và thường xuyên bị “thổi giá”, bạn bắt đầu đặt câu hỏi: liệu có thể sử dụng các công cụ học máy để giúp người mua đưa ra quyết định sáng suốt hơn? Nếu có thể thu thập dữ liệu về vị trí, diện tích, loại hình nhà, tiện ích xung quanh, và giá bán thực tế của các bất động sản tương tự, một mô hình học máy hoàn toàn có khả năng học được mối quan hệ giữa các yếu tố này và giá nhà.</p>
<p>Dữ liệu dùng để xây dựng mô hình là dữ liệu về giá của hơn 10,000 ngôi nhà đất tại Hà Nội, bao gồm các thông tin:</p>
<ul class="simple">
<li><p>Các thông tin liên quan đến vị trí địa lý của ngôi nhà như địa chỉ, quận, huyện.</p></li>
<li><p>Các thông tin liên quan đến tính chất của ngôi nhà, chẳng hạn như nhà mặt phố hay trong ngõ, diện tích, chiều dài, chiều rộng, số phòng ngủ, số tầng.</p></li>
<li><p>Các thông tin liên quan đến pháp lý của ngôi nhà, chẳng hạn như có sổ đỏ hay chưa.</p></li>
</ul>
<p>Mục tiêu của bạn là dựa vào các đặc trưng trên của ngôi nhà để dự đoán mức giá tính theo đơn vị triệu đồng mỗi mét vuông. Dữ liệu được lưu trong file <code class="docutils literal notranslate"><span class="pre">HN_housing_dataset.csv</span></code>. Bạn đọc load dữ liệu như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/HN_housing_price_raw.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ngày</th>
      <th>Địa chỉ</th>
      <th>Quận</th>
      <th>Huyện</th>
      <th>Loại hình nhà ở</th>
      <th>Giấy tờ pháp lý</th>
      <th>Số tầng</th>
      <th>Số phòng ngủ</th>
      <th>Diện tích</th>
      <th>Dài</th>
      <th>Rộng</th>
      <th>Giá/m2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2021-06-05</td>
      <td>phố minh khai, Phường Minh Khai, Quận Hai Bà T...</td>
      <td>Quận Hai Bà Trưng</td>
      <td>Phường Minh Khai</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4 phòng</td>
      <td>40 m²</td>
      <td>10 m</td>
      <td>4 m</td>
      <td>65 triệu/m²</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-05</td>
      <td>Đường Bồ Đề, Phường Bồ Đề, Quận Long Biên, Hà Nội</td>
      <td>Quận Long Biên</td>
      <td>Phường Bồ Đề</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4 phòng</td>
      <td>52 m²</td>
      <td>12 m</td>
      <td>4.2 m</td>
      <td>93,27 triệu/m²</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-05</td>
      <td>Đường Tố Hữu, Phường La Khê, Quận Hà Đông, Hà Nội</td>
      <td>Quận Hà Đông</td>
      <td>Phường La Khê</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>5 phòng</td>
      <td>90 m²</td>
      <td>18 m</td>
      <td>5 m</td>
      <td>108,89 triệu/m²</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-05</td>
      <td>180/61/5, Đường Tây Mỗ, Phường Tây Mỗ, Quận Na...</td>
      <td>Quận Nam Từ Liêm</td>
      <td>Phường Tây Mỗ</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>3 phòng</td>
      <td>32 m²</td>
      <td>6.6 m</td>
      <td>4.5 m</td>
      <td>60,94 triệu/m²</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2021-06-05</td>
      <td>Đường Khương Trung, Phường Khương Trung, Quận ...</td>
      <td>Quận Thanh Xuân</td>
      <td>Phường Khương Trung</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4 phòng</td>
      <td>38 m²</td>
      <td>10 m</td>
      <td>3 m</td>
      <td>68,42 triệu/m²</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11466</th>
      <td>2021-06-05</td>
      <td>101b-c4, ngõ 231, Đường Tân Mai, Phường Tân Ma...</td>
      <td>Quận Hoàng Mai</td>
      <td>Phường Tân Mai</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>2</td>
      <td>2 phòng</td>
      <td>37 m²</td>
      <td>13 m</td>
      <td>3 m</td>
      <td>43,24 triệu/m²</td>
    </tr>
    <tr>
      <th>11467</th>
      <td>2021-06-05</td>
      <td>Đường Nguyễn Trãi, Phường Thượng Đình, Quận Th...</td>
      <td>Quận Thanh Xuân</td>
      <td>Phường Thượng Đình</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>9</td>
      <td>nhiều hơn 10 phòng</td>
      <td>100 m²</td>
      <td>16 m</td>
      <td>6 m</td>
      <td>115 triệu/m²</td>
    </tr>
    <tr>
      <th>11468</th>
      <td>2021-06-05</td>
      <td>Đường Hồ Đắc Di, Phường Nam Đồng, Quận Đống Đa...</td>
      <td>Quận Đống Đa</td>
      <td>Phường Nam Đồng</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4 phòng</td>
      <td>80 m²</td>
      <td>14 m</td>
      <td>5 m</td>
      <td>262,5 triệu/m²</td>
    </tr>
    <tr>
      <th>11469</th>
      <td>2021-06-05</td>
      <td>Đường Khâm Thiên, Phường Khâm Thiên, Quận Đống...</td>
      <td>Quận Đống Đa</td>
      <td>Phường Khâm Thiên</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>3</td>
      <td>5 phòng</td>
      <td>89 m²</td>
      <td>20 m</td>
      <td>4 m</td>
      <td>258,43 triệu/m²</td>
    </tr>
    <tr>
      <th>11470</th>
      <td>2021-06-05</td>
      <td>KĐT Văn Phú, Phường Phú La, Quận Hà Đông, Hà Nội</td>
      <td>Quận Hà Đông</td>
      <td>Phường Phú La</td>
      <td>Nhà phố liền kề</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4 phòng</td>
      <td>90 m²</td>
      <td>20 m</td>
      <td>4 m</td>
      <td>64,44 triệu/m²</td>
    </tr>
  </tbody>
</table>
<p>10980 rows × 12 columns</p>
</div></div></div>
</div>
</section>
<section id="phan-tich-khai-pha-du-lieu">
<h4><span class="section-number">3.3.2.2. </span>Phân tích khai phá dữ liệu<a class="headerlink" href="#phan-tich-khai-pha-du-lieu" title="Link to this heading">#</a></h4>
<hr><p>Không giống như tập dữ liệu <em>Iris</em> đã được tiền xử lý và tổ chức sẵn theo một cấu trúc nhất định, dữ liệu giá nhà thường tồn tại dưới dạng thô, chưa được làm sạch hay chuẩn hóa để sẵn sàng cho việc huấn luyện các mô hình học máy. Có thể nhận thấy rằng tập dữ liệu này thường gặp phải nhiều vấn đề phổ biến như giá trị thiếu, định dạng không đồng nhất, sự xuất hiện của các ngoại lệ (outliers), cũng như sự không nhất quán trong đơn vị đo lường giữa các trường dữ liệu.</p>
<p>Đối với những tập dữ liệu như vậy, quá trình phân tích và khai phá dữ liệu (<em>Exploratory Data Analysis – EDA</em>) đóng vai trò đặc biệt quan trọng trong chuỗi quy trình xây dựng mô hình học máy. Việc hiểu rõ cấu trúc dữ liệu, phân phối các biến, mối quan hệ giữa các đặc trưng, đồng thời phát hiện và xử lý các vấn đề liên quan đến chất lượng dữ liệu, có ảnh hưởng trực tiếp đến năng lực khái quát hóa và độ chính xác của mô hình đầu ra. Nói cách khác, chất lượng của quá trình EDA là yếu tố then chốt quyết định hiệu suất tổng thể của mô hình học máy được xây dựng từ tập dữ liệu này.</p>
<p>Hơn nữa, quá trình phân tích và khai phá dữ liệu không chỉ đòi hỏi kỹ năng kỹ thuật về xử lý và trực quan hóa dữ liệu, mà còn cần đến kiến thức chuyên sâu về lĩnh vực ứng dụng từ phía người xây dựng mô hình. Đối với bài toán dự đoán giá nhà, điều này có nghĩa là nhà phân tích cần hiểu rõ các yếu tố kinh tế, xã hội, hành chính và hạ tầng có ảnh hưởng đến giá trị bất động sản, cũng như các đặc thù vận hành của thị trường địa phương.</p>
<p>Việc lựa chọn, biến đổi và diễn giải các đặc trưng đầu vào một cách hợp lý — chẳng hạn như vị trí địa lý, tiện ích lân cận, loại hình nhà ở, diện tích sử dụng hay tính pháp lý — không thể chỉ dựa vào các thao tác kỹ thuật thuần túy. Thay vào đó, quá trình này cần được dẫn dắt bởi một sự kết hợp chặt chẽ giữa năng lực phân tích dữ liệu và kiến thức trong lĩnh vực bất động sản nhằm đảm bảo rằng mô hình học máy không chỉ chính xác về mặt thống kê, mà còn phản ánh đúng thực tiễn và có khả năng ứng dụng trong môi trường thực tế.</p>
<p>Do đây chỉ là phần giới thiệu về các mô hình học máy, nên chúng tôi chỉ đề xuất một vài kỹ thuật khai phá cho dữ liệu kể trên. Bạn đọc sẽ được tìm hiểu kỹ hơn về các kỹ thuật khai phá dữ liệu trong các phần sau của cuốn sách.</p>
<p>Trước tiên, biến mục tiêu là một biến dạng số thực, nhưng Python đang hiểu đây là một biến dạng chuỗi ký tự do có đơn vị triệu/m<span class="math notranslate nohighlight">\(^2\)</span>, hoặc tỷ/m<span class="math notranslate nohighlight">\(^2\)</span>, hoặc đ/m<span class="math notranslate nohighlight">\(^2\)</span> phía sau các con số. Để máy tính hiểu được đây là đơn vị con số, chúng ta tạo thêm 2 cột mới, tên là <code class="docutils literal notranslate"><span class="pre">price_value</span></code> chỉ chứa phần số của biến <code class="docutils literal notranslate"><span class="pre">Giá/mét</span> <span class="pre">vuông</span></code>, và cột <code class="docutils literal notranslate"><span class="pre">price_unit</span></code> chứa đơn vị của của giá</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tách cột giá nhà thành 2 cột price_value và price_unit</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;price_value&quot;</span><span class="p">,</span> <span class="s2">&quot;price_unit&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Giá/m2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([\d.,]+)\s*(.*)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Trong tập dữ liệu hiện tại, các giá trị thể hiện giá bất động sản được định dạng theo chuẩn số của Việt Nam, trong đó dấu <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> được sử dụng làm dấu phân tách hàng nghìn và hàng triệu, còn dấu <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code> đóng vai trò là dấu phân cách phần thập phân. Ví dụ, giá trị <code class="docutils literal notranslate"><span class="pre">&quot;2.350.000,5&quot;</span></code> biểu thị hai triệu ba trăm năm mươi nghìn đồng và năm hào.</p>
<p>Tuy nhiên, để có thể xử lý và tính toán trong Python, các giá trị này cần được chuyển đổi về kiểu số thực chuẩn quốc tế, trong đó dấu <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> được sử dụng làm dấu phân tách thập phân và dấu <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code> không được chấp nhận trong biểu diễn số. Do đó, cần thực hiện quá trình tiền xử lý bằng cách loại bỏ tất cả các dấu <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> và chuyển dấu <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code> thành <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> để phù hợp với định dạng số thực trong Python.</p>
<p>Ví dụ, chuỗi <code class="docutils literal notranslate"><span class="pre">&quot;2.350.000,5&quot;</span></code> sau khi chuyển đổi sẽ trở thành số thực <code class="docutils literal notranslate"><span class="pre">2350000.5</span></code>, có thể sử dụng trực tiếp trong các phép tính, mô hình học máy, và các thao tác phân tích dữ liệu khác.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;price_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;price_value&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>                     <span class="c1"># Đảm bảo là chuỗi</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>                   <span class="c1"># Chuyển sang số thực</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Xem các đơn vị khác nhau có thể của giá nhà</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;price_unit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;triệu/m²&#39;, &#39;tỷ/m²&#39;, &#39;đ/m²&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Trong tập dữ liệu, có thể nhận thấy rằng đơn vị giá được sử dụng không đồng nhất giữa các mẫu quan sát: một số bất động sản được định giá theo đơn vị triệu đồng trên mét vuông, một số khác theo tỷ đồng trên mét vuông, và thậm chí có trường hợp sử dụng đồng trên mét vuông. Nếu không được xử lý thích hợp, sự khác biệt trong đơn vị này có thể dẫn đến việc hiểu sai hoàn toàn về giá trị thực của bất động sản, ảnh hưởng nghiêm trọng đến chất lượng mô hình học máy.</p>
<p>Để đảm bảo tính nhất quán và khả năng so sánh giữa các quan sát, chúng ta thống nhất sử dụng đơn vị triệu đồng trên mét vuông làm chuẩn. Theo đó, tất cả các giá trị thuộc đơn vị khác sẽ được quy đổi về cùng một hệ đo lường bằng các phép biến đổi tương ứng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hàm số dùng để chuyển đổi đơn vị</span>
<span class="k">def</span><span class="w"> </span><span class="nf">normalize_price</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;triệu/m²&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;đ/m²&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;tỷ/m²&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># hoặc np.nan nếu đơn vị không rõ</span>

<span class="c1"># Áp dụng cho dữ liệu giá nhà</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;price_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">normalize_price</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;price_value&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;price_unit&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Xem lại các mô tả thống kê cho biến price_value</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;price_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    10980.000000
mean       109.191818
std        139.377876
min          0.054081
25%         72.500000
50%         91.180000
75%        117.310000
max       7894.736842
Name: price_value, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Có thể nhận thấy rằng một số bất động sản trong tập dữ liệu đã bị nhập sai đơn vị đo lường giá, dẫn đến những giá trị bất hợp lý. Ví dụ, bất động sản có mức giá thấp nhất được ghi nhận là 0.05 triệu đồng trên mỗi mét vuông – một con số không thực tế, nhiều khả năng xuất phát từ việc nhầm lẫn đơn vị từ triệu đồng hoặc tỷ đồng sang đồng. Ngược lại, bất động sản có mức giá cao nhất được ghi nhận là <span class="math notranslate nohighlight">\(7.894\)</span> triệu đồng trên mỗi mét vuông, tương đương 7,9 tỷ đồng/m², cũng là một giá trị vượt xa giới hạn hợp lý và có thể do sai sót trong nhập liệu.</p>
<p>Trong các chương tiếp theo của cuốn sách, những quan sát như vậy sẽ được phân loại là <strong>giá trị ngoại lai</strong>, hay <em>outliers</em>. Nếu không được xử lý thích hợp, các giá trị ngoại lai này có thể ảnh hưởng nghiêm trọng đến hiệu suất và độ tin cậy của các mô hình phân tích dữ liệu, gây sai lệch trong kết quả và làm giảm khả năng tổng quát hóa của mô hình đối với dữ liệu thực tế.</p>
<p>Quy trình xử lý dữ liệu sẽ được thực hiện tuần tự đối với biến mục tiêu cũng như từng biến đặc trưng, cho đến khi toàn bộ các biến trong mô hình được chuẩn hóa đầy đủ về kiểu dữ liệu và giá trị. Việc đảm bảo tính nhất quán và hợp lệ của các biến là điều kiện tiên quyết để xây dựng các mô hình phân tích có độ chính xác và khả năng tổng quát hóa cao. Toàn bộ quá trình này sẽ được trình bày chi tiết thông qua các phần thực hành trong các chương sau của cuốn sách.</p>
<p>Dữ liệu sau khi được làm sạch bằng các kỹ thuật được trình bày trong các chương liên quan đến tiền xử lý và xử lý dữ liệu được lưu trong file <code class="docutils literal notranslate"><span class="pre">HN_housing_price_clean.csv</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/HN_housing_price_clean.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Địa chỉ</th>
      <th>Quận</th>
      <th>Huyện</th>
      <th>Loại hình nhà ở</th>
      <th>Giấy tờ pháp lý</th>
      <th>Số tầng</th>
      <th>Số phòng ngủ</th>
      <th>Diện tích</th>
      <th>Dài</th>
      <th>Rộng</th>
      <th>Giá/m2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>phố minh khai, Phường Minh Khai, Quận Hai Bà T...</td>
      <td>Quận Hai Bà Trưng</td>
      <td>Phường Minh Khai</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>40.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>65.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Đường Bồ Đề, Phường Bồ Đề, Quận Long Biên, Hà Nội</td>
      <td>Quận Long Biên</td>
      <td>Phường Bồ Đề</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4</td>
      <td>50.4</td>
      <td>12.0</td>
      <td>4.2</td>
      <td>93.27</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Đường Tố Hữu, Phường La Khê, Quận Hà Đông, Hà Nội</td>
      <td>Quận Hà Đông</td>
      <td>Phường La Khê</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>5</td>
      <td>90.0</td>
      <td>18.0</td>
      <td>5.0</td>
      <td>108.89</td>
    </tr>
    <tr>
      <th>4</th>
      <td>180/61/5, Đường Tây Mỗ, Phường Tây Mỗ, Quận Na...</td>
      <td>Quận Nam Từ Liêm</td>
      <td>Phường Tây Mỗ</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>3</td>
      <td>29.7</td>
      <td>6.6</td>
      <td>4.5</td>
      <td>60.94</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Đường Khương Trung, Phường Khương Trung, Quận ...</td>
      <td>Quận Thanh Xuân</td>
      <td>Phường Khương Trung</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>30.0</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>68.42</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11466</th>
      <td>101b-c4, ngõ 231, Đường Tân Mai, Phường Tân Ma...</td>
      <td>Quận Hoàng Mai</td>
      <td>Phường Tân Mai</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>2</td>
      <td>2</td>
      <td>39.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>43.24</td>
    </tr>
    <tr>
      <th>11467</th>
      <td>Đường Nguyễn Trãi, Phường Thượng Đình, Quận Th...</td>
      <td>Quận Thanh Xuân</td>
      <td>Phường Thượng Đình</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>9</td>
      <td>10+</td>
      <td>96.0</td>
      <td>16.0</td>
      <td>6.0</td>
      <td>115.00</td>
    </tr>
    <tr>
      <th>11468</th>
      <td>Đường Hồ Đắc Di, Phường Nam Đồng, Quận Đống Đa...</td>
      <td>Quận Đống Đa</td>
      <td>Phường Nam Đồng</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4</td>
      <td>70.0</td>
      <td>14.0</td>
      <td>5.0</td>
      <td>262.50</td>
    </tr>
    <tr>
      <th>11469</th>
      <td>Đường Khâm Thiên, Phường Khâm Thiên, Quận Đống...</td>
      <td>Quận Đống Đa</td>
      <td>Phường Khâm Thiên</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>3</td>
      <td>5</td>
      <td>80.0</td>
      <td>20.0</td>
      <td>4.0</td>
      <td>258.43</td>
    </tr>
    <tr>
      <th>11470</th>
      <td>KĐT Văn Phú, Phường Phú La, Quận Hà Đông, Hà Nội</td>
      <td>Quận Hà Đông</td>
      <td>Phường Phú La</td>
      <td>Nhà phố liền kề</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>80.0</td>
      <td>20.0</td>
      <td>4.0</td>
      <td>64.44</td>
    </tr>
  </tbody>
</table>
<p>10701 rows × 11 columns</p>
</div></div></div>
</div>
<p>Một yêu cầu then chốt trong quá trình phân tích và khai phá dữ liệu là xác định các đặc trưng sẵn có hoặc xây dựng thêm các đặc trưng mới có ý nghĩa, nhằm nâng cao hiệu quả của mô hình dự đoán – chẳng hạn như mô hình dự đoán giá bất động sản. Đối với các biến phân loại, việc đánh giá xem liệu một biến có ảnh hưởng đến biến mục tiêu hay không thường được thực hiện thông qua kết hợp giữa phương pháp trực quan hóa, chẳng hạn như biểu đồ hộp, và kiểm định thống kê.</p>
<p>Chẳng hạn, để kiểm tra xem giá nhà có sự khác biệt đáng kể giữa các quận hay không, ta có thể tiến hành trực quan hóa như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Sắp xếp các quận theo giá trung bình</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Quận&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Quận&#39;</span><span class="p">],</span> 
                             <span class="n">categories</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Quận&#39;</span><span class="p">)[</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                             <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Vẽ boxplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Quận&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#00A7F0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>  <span class="c1"># Giới hạn trục y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9f0d4709fa652b93b18f19081fc3e2f0f91f71881e5e00f4587e494a6d536560.png" src="../_images/9f0d4709fa652b93b18f19081fc3e2f0f91f71881e5e00f4587e494a6d536560.png" />
</div>
</div>
<p>Kết quả trực quan hóa cho thấy giá nhà thực sự có sự khác biệt rõ rệt giữa các quận. Đáng chú ý, quận Hoàn Kiếm có mức giá nhà trung bình cao vượt trội so với các quận còn lại. Trong khi đó, quận Tây Hồ – mặc dù theo nhận định ban đầu được cho là có mức giá cao – trên thực tế chỉ tương đương với các quận như Ba Đình hoặc Đống Đa về mặt giá trung bình.</p>
<p>Bên cạnh vị trí địa lý, một yếu tố khác cũng có khả năng ảnh hưởng đáng kể đến giá nhà là số tầng của ngôi nhà. Do số tầng là một biến phân loại có thứ tự (ordinal categorical variable), biểu đồ hộp (boxplot) tiếp tục là công cụ hữu ích để khám phá mối quan hệ giữa đặc trưng này và biến mục tiêu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sắp xếp các quận theo giá trung bình</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Số tầng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Số tầng&#39;</span><span class="p">],</span> 
                            <span class="n">categories</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Số tầng&#39;</span><span class="p">)[</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                            <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Vẽ boxplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Số tầng&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#00A7F0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>  <span class="c1"># Giới hạn trục y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5090c355951d2b928110a84a69bd78fd8af17cbb0398d9b496e4c1c07332606b.png" src="../_images/5090c355951d2b928110a84a69bd78fd8af17cbb0398d9b496e4c1c07332606b.png" />
</div>
</div>
<p>Kết quả phân tích cho thấy mối quan hệ thuận chiều giữa số tầng của một ngôi nhà và mức giá tính trên mỗi mét vuông, phù hợp với giả thuyết được đặt ra từ trước. Diễn giải theo cách đơn giản, giá trị của một bất động sản không chỉ phản ánh giá trị của quyền sử dụng đất, mà còn bao gồm chi phí xây dựng. Khi số tầng tăng, chi phí xây dựng trên mỗi mét vuông sàn cũng có xu hướng tăng theo, do các yêu cầu kỹ thuật, kết cấu và vật liệu cao tầng phức tạp hơn. Do đó, giá nhà trên mỗi mét vuông ở những ngôi nhà có nhiều tầng thường cao hơn so với nhà thấp tầng.</p>
<p>Chúng ta tiếp tục với hai biến <code class="docutils literal notranslate"><span class="pre">Loại</span> <span class="pre">hình</span> <span class="pre">nhà</span> <span class="pre">ở</span></code> và <code class="docutils literal notranslate"><span class="pre">Giấy</span> <span class="pre">tờ</span> <span class="pre">pháp</span> <span class="pre">lý</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tạo figure và 2 axes nằm ngang cạnh nhau</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ----- Biểu đồ 1: theo Loại hình nhà ở -----</span>
<span class="c1"># Sắp xếp theo giá trung bình</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">],</span>
    <span class="n">categories</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">)[</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#00A7F0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>  <span class="c1"># Giới hạn trục y</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Theo Loại hình nhà ở&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># ----- Biểu đồ 2: theo Giấy tờ pháp lý -----</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Giấy tờ pháp lý&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Giấy tờ pháp lý&#39;</span><span class="p">],</span>
    <span class="n">categories</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Giấy tờ pháp lý&#39;</span><span class="p">)[</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Giấy tờ pháp lý&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#00A7F0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>  <span class="c1"># Giới hạn trục y</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Theo Giấy tờ pháp lý&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/82724753cbd8fb6f7b192b229059701fdfcb8c90d95624e33825fe01fc03852d.png" src="../_images/82724753cbd8fb6f7b192b229059701fdfcb8c90d95624e33825fe01fc03852d.png" />
</div>
</div>
<p>Phân tích dữ liệu cho thấy giá nhà đối với các loại hình như biệt thự và nhà mặt phố có xu hướng cao hơn rõ rệt so với các loại hình như nhà phố liền kề hay nhà trong ngõ hẻm. Khi xét đến yếu tố pháp lý, những bất động sản đã có giấy chứng nhận quyền sử dụng đất (sổ đỏ) thường có mức giá cao hơn so với các trường hợp chưa có sổ. Ngoài ra, các ngôi nhà đang trong quá trình chờ cấp sổ đỏ cũng có mức giá trung bình nhỉnh hơn một chút so với nhóm nhà có “giấy tờ khác” – một nhóm thường kém minh bạch về mặt pháp lý.</p>
<p>Đối với các biến định lượng (kiểu số liên tục), phương pháp trực quan hóa phổ biến là sử dụng đồ thị phân tán để mô tả mối quan hệ giữa biến giải thích và biến mục tiêu. Chẳng hạn, để kiểm tra xem diện tích đất có liên quan đến giá nhà tính trên mỗi mét vuông hay không, ta có thể sử dụng biểu đồ phân tán như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Xác định các giá trị duy nhất của biến &quot;Loại hình nhà ở&quot;</span>
<span class="n">loai_hinh</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># Tạo figure 2x2</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Chuyển thành 1D list để dễ duyệt</span>

<span class="c1"># Vẽ từng scatter plot cho từng loại hình</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">loai</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loai_hinh</span><span class="p">):</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loại hình nhà ở&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">loai</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Diện tích&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Giá/m2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loại hình: </span><span class="si">{</span><span class="n">loai</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Diện tích (m²)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Giá/m²&#39;</span><span class="p">)</span>

<span class="c1"># Xóa subplot dư nếu ít hơn 4 loại hình</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loai_hinh</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8a7fbbacce3080fcf6cdd4c95c8a8924fa6891c67eec35da42a6ce72800da72c.png" src="../_images/8a7fbbacce3080fcf6cdd4c95c8a8924fa6891c67eec35da42a6ce72800da72c.png" />
</div>
</div>
<p>Trái với giả định ban đầu cho rằng diện tích đất của một ngôi nhà có thể ảnh hưởng đến giá bán tính trên mỗi mét vuông, biểu đồ phân tán lại không cho thấy mối quan hệ rõ ràng giữa hai biến này. Điều này cho thấy rằng, trong một số trường hợp, những đặc trưng tưởng chừng có ý nghĩa lại không thực sự đóng vai trò quyết định đối với biến mục tiêu.</p>
<p>Quá trình phân tích mối quan hệ giữa các biến đặc trưng và biến mục tiêu sẽ tiếp tục được thực hiện theo hướng tiếp cận tương tự, nhằm lựa chọn ra tập biến đầu vào phù hợp cho mô hình dự đoán. Ngoài việc sử dụng các biến sẵn có trong dữ liệu, người phân tích hoàn toàn có thể xây dựng thêm các biến đặc trưng mới có khả năng cải thiện hiệu quả dự báo. Ví dụ, từ địa chỉ chi tiết của bất động sản, ta có thể tính toán một số đại lượng được giả định là có ảnh hưởng đáng kể đến giá nhà như: khoảng cách đến trục đường chính, mức độ kết nối với hệ thống đường cao tốc, khoảng cách đến trung tâm thương mại, cơ sở y tế, trường học, v.v.</p>
<p>Các phương pháp tạo biến đặc trưng nâng cao như vậy sẽ được trình bày chi tiết trong các phần thực hành tiếp theo của cuốn sách.</p>
</section>
<section id="xay-dung-mo-hinh-du-doan-gia-nha">
<h4><span class="section-number">3.3.2.3. </span>Xây dựng mô hình dự đoán giá nhà<a class="headerlink" href="#xay-dung-mo-hinh-du-doan-gia-nha" title="Link to this heading">#</a></h4>
<hr><p>Đối với biến mục tiêu dạng số, các mô hình dự đoán được gọi là các <strong>mô hình hồi quy</strong>, hay <em>regression</em>. Chúng ta sẽ xây dựng một mô hình <strong>rừng ngẫu nhiên</strong>, hay <em>Random Forest</em>, nhằm dự đoán giá nhà trên mỗi mét vuông. Rừng ngẫu nhiên là một thuật toán học có giám sát thuộc nhóm mô hình tổ hợp <em>ensemble learning</em>, hoạt động bằng cách xây dựng nhiều cây quyết định độc lập trên các tập dữ liệu con được lấy mẫu ngẫu nhiên từ tập huấn luyện. Đối với bài toán hồi quy, dự đoán cuối cùng của mô hình rừng ngẫu nhiên được xác định bằng cách tổng hợp bằng trung bình các dự đoán từ các cây riêng lẻ. Cách tiếp cận như vậy giúp mô hình có khả năng tổng quát hóa tốt hơn và giảm thiểu hiện tượng khớp quá mức của mô hình.</p>
<p>Tương tự như ví dụ trước, tập dữ liệu sẽ được chia thành hai phần: tập huấn luyện và tập kiểm tra. Tập huấn luyện được sử dụng để xây dựng mô hình, trong khi tập kiểm tra giúp đánh giá khả năng dự đoán của mô hình trên dữ liệu chưa từng được nhìn thấy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Thống nhất các biến kiểu số</span>
<span class="n">num_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Diện tích&quot;</span><span class="p">,</span> <span class="s2">&quot;Dài&quot;</span><span class="p">,</span>	<span class="s2">&quot;Rộng&quot;</span><span class="p">,</span> <span class="s2">&quot;Giá/m2&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">num_vars</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Quận&quot;</span><span class="p">,</span> <span class="s2">&quot;Huyện&quot;</span><span class="p">,</span> <span class="s2">&quot;Loại hình nhà ở&quot;</span><span class="p">,</span> <span class="s2">&quot;Giấy tờ pháp lý&quot;</span><span class="p">,</span><span class="s2">&quot;Số tầng&quot;</span><span class="p">,</span><span class="s2">&quot;Số phòng ngủ&quot;</span><span class="p">,</span><span class="s2">&quot;Diện tích&quot;</span><span class="p">,</span> <span class="s2">&quot;Dài&quot;</span><span class="p">,</span><span class="s2">&quot;Rộng&quot;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Giá/m2&quot;</span><span class="p">],</span> 
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Quận</th>
      <th>Huyện</th>
      <th>Loại hình nhà ở</th>
      <th>Giấy tờ pháp lý</th>
      <th>Số tầng</th>
      <th>Số phòng ngủ</th>
      <th>Diện tích</th>
      <th>Dài</th>
      <th>Rộng</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>911</th>
      <td>Quận Hoàng Mai</td>
      <td>Phường Tân Mai</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>3</td>
      <td>37.4</td>
      <td>11.0</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>2433</th>
      <td>Quận Long Biên</td>
      <td>Phường Long Biên</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4</td>
      <td>35.0</td>
      <td>7.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7596</th>
      <td>Quận Cầu Giấy</td>
      <td>Phường Mai Dịch</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>5</td>
      <td>40.0</td>
      <td>10.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>9220</th>
      <td>Quận Thanh Xuân</td>
      <td>Phường Hạ Đình</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>2</td>
      <td>27.0</td>
      <td>9.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>918</th>
      <td>Quận Hà Đông</td>
      <td>Phường Phú Lương</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>3</td>
      <td>35.0</td>
      <td>10.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9888</th>
      <td>Quận Ba Đình</td>
      <td>Phường Giảng Võ</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>3</td>
      <td>40.0</td>
      <td>8.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5166</th>
      <td>Quận Tây Hồ</td>
      <td>Phường Quảng An</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4</td>
      <td>30.0</td>
      <td>10.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3476</th>
      <td>Quận Ba Đình</td>
      <td>Phường Cống Vị</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>7</td>
      <td>50.0</td>
      <td>10.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>10553</th>
      <td>Quận Hoàng Mai</td>
      <td>Phường Lĩnh Nam</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>3</td>
      <td>3</td>
      <td>33.0</td>
      <td>11.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2912</th>
      <td>Quận Thanh Xuân</td>
      <td>Phường Khương Trung</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>100.0</td>
      <td>25.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3211, 9)
</pre></div>
</div>
</div>
</div>
<p>Tổng cộng có 7.490 bất động sản được sử dụng làm tập dữ liệu huấn luyện để xây dựng mô hình và 3.211 bất động sản còn lại được sử dụng làm tập kiểm tra nhằm đánh giá hiệu quả dự đoán của mô hình.</p>
<p>Trước khi đưa các biến vào mô hình học máy, một bước tiền xử lý quan trọng là chuyển đổi các biến phân loại sang dạng <strong>biến giả</strong>, hay <em>biến kiểu one-hot</em> nhằm đảm bảo tính tương thích với các thuật toán mô hình hóa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Chuyển đổi biến sang kiểu one hot</span>
<span class="n">X_train_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Đồng bộ hóa cột giữa train/test</span>
<span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">X_train_encoded</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sau khi hoàn tất quá trình tiền xử lý dữ liệu, mô hình rừng ngẫu nhiên sẽ được gọi từ thư viện <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> để tiến hành huấn luyện trên tập dữ liệu đã chuẩn hóa:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Khởi tạo mô hình Random Forest</span>
<span class="n">rf_model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>      <span class="c1"># số lượng cây</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>        <span class="c1"># độ sâu tối đa</span>
    <span class="n">max_features</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>        <span class="c1"># số lượng đặc trưng của mỗi cây quyết định</span>
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>       <span class="c1"># khởi tạo ngẫu nhiên để tái lập kết quả</span>
<span class="p">)</span>

<span class="c1"># Huấn luyện mô hình với dữ liệu huấn luyện</span>
<span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sau khi mô hình rừng ngẫu nhiên đã được huấn luyện và được lưu dưới tên <code class="docutils literal notranslate"><span class="pre">rf_model</span></code>, chúng ta có thể sử dụng mô hình này để dự đoán giá bất động sản trên tập dữ liệu kiểm tra <code class="docutils literal notranslate"><span class="pre">X_test</span></code>.</p>
<p>Việc dự đoán được thực hiện thông qua phương thức <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> của mô hình đã huấn luyện.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_pred</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Chúng ta có thể so sánh giá của 10 ngôi nhà đầu tiên trong dữ liệu kiểm tra và giá được dự đoán từ mô hình rùng ngẫu nhiên</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Quận</th>
      <th>Huyện</th>
      <th>Loại hình nhà ở</th>
      <th>Giấy tờ pháp lý</th>
      <th>Số tầng</th>
      <th>Số phòng ngủ</th>
      <th>Diện tích</th>
      <th>Dài</th>
      <th>Rộng</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6058</th>
      <td>Quận Đống Đa</td>
      <td>Phường Ô Chợ Dừa</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>45.00</td>
      <td>15.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3083</th>
      <td>Quận Hà Đông</td>
      <td>Phường Phúc La</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>40.00</td>
      <td>10.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1218</th>
      <td>Quận Cầu Giấy</td>
      <td>Phường Mai Dịch</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>6</td>
      <td>57.96</td>
      <td>12.6</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Quận Nam Từ Liêm</td>
      <td>Phường Phương Canh</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>3</td>
      <td>31.20</td>
      <td>7.8</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>11129</th>
      <td>Quận Hai Bà Trưng</td>
      <td>Phường Minh Khai</td>
      <td>Nhà mặt phố, mặt tiền</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>45.00</td>
      <td>9.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6197</th>
      <td>Quận Bắc Từ Liêm</td>
      <td>Phường Phú Diễn</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Giấy tờ khác</td>
      <td>4</td>
      <td>4</td>
      <td>30.00</td>
      <td>10.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4267</th>
      <td>Quận Long Biên</td>
      <td>Phường Ngọc Thụy</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>3</td>
      <td>27.00</td>
      <td>9.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5824</th>
      <td>Quận Đống Đa</td>
      <td>Phường Ô Chợ Dừa</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>4</td>
      <td>4</td>
      <td>48.00</td>
      <td>12.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>8529</th>
      <td>Quận Hà Đông</td>
      <td>Phường Phú La</td>
      <td>Nhà biệt thự</td>
      <td>Đã có sổ</td>
      <td>5</td>
      <td>4</td>
      <td>80.00</td>
      <td>16.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5842</th>
      <td>Quận Đống Đa</td>
      <td>Phường Láng Hạ</td>
      <td>Nhà ngõ, hẻm</td>
      <td>Đã có sổ</td>
      <td>6</td>
      <td>3</td>
      <td>32.00</td>
      <td>8.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Giá thực tế&#39;</span><span class="p">:</span> <span class="n">Y_test</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;Giá dự đoán&#39;</span><span class="p">:</span> <span class="n">Y_pred</span><span class="p">[:</span><span class="mi">10</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Giá thực tế</th>
      <th>Giá dự đoán</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6058</th>
      <td>270.00</td>
      <td>182.666425</td>
    </tr>
    <tr>
      <th>3083</th>
      <td>125.00</td>
      <td>96.177279</td>
    </tr>
    <tr>
      <th>1218</th>
      <td>127.59</td>
      <td>112.345545</td>
    </tr>
    <tr>
      <th>131</th>
      <td>79.03</td>
      <td>77.220001</td>
    </tr>
    <tr>
      <th>11129</th>
      <td>162.86</td>
      <td>105.353566</td>
    </tr>
    <tr>
      <th>6197</th>
      <td>78.57</td>
      <td>74.992164</td>
    </tr>
    <tr>
      <th>4267</th>
      <td>98.33</td>
      <td>81.359276</td>
    </tr>
    <tr>
      <th>5824</th>
      <td>100.00</td>
      <td>131.327675</td>
    </tr>
    <tr>
      <th>8529</th>
      <td>100.00</td>
      <td>98.833940</td>
    </tr>
    <tr>
      <th>5842</th>
      <td>120.00</td>
      <td>118.905283</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Kết quả dự đoán từ mô hình cho thấy phần nào khả năng phản ánh sự biến động của giá bất động sản trên thị trường.</p>
<ul class="simple">
<li><p>Một số trường hợp có mức sai lệch nhỏ giữa giá trị thực tế và giá trị dự đoán, cho thấy mô hình hoạt động hiệu quả đối với những quan sát điển hình — chẳng hạn như các bất động sản mang chỉ số 131, 8529 hoặc 5842.</p></li>
<li><p>Tuy nhiên, vẫn tồn tại những trường hợp mô hình chưa dự đoán chính xác, đặc biệt là các bất động sản có đặc điểm không phổ biến hoặc khác biệt đáng kể, như các trường hợp mang chỉ số 6058 và 11129, nơi giá trị dự đoán thấp hơn nhiều so với thực tế.</p></li>
</ul>
<p>Kết quả dự đoán và giá trị thực tế của 3.211 bất động sản trong tập dữ liệu kiểm tra được minh họa thông qua đồ thị dưới đây. Hình vẽ cho phép trực quan hóa mức độ phù hợp giữa mô hình dự đoán và dữ liệu thực, đồng thời hỗ trợ nhận diện các điểm sai lệch lớn hoặc các xu hướng sai khác có hệ thống.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tạo đồ thị scatter: Giá thực tế vs Giá dự đoán</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y_pred</span><span class="p">)</span>

<span class="c1"># Thêm đường chéo y = x để tham chiếu</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">Y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
         <span class="p">[</span><span class="n">Y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;grey&quot;</span><span class="p">)</span>

<span class="c1"># Nhãn trục và tiêu đề</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Giá thực tế (Y_test)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Giá dự đoán (Y_pred)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;So sánh giá thực tế và giá dự đoán&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1c2c38d22f5816b6b2ac2d3fde7be9e04f2ffc6dbbe5876cdb8296bdaee7127d.png" src="../_images/1c2c38d22f5816b6b2ac2d3fde7be9e04f2ffc6dbbe5876cdb8296bdaee7127d.png" />
</div>
</div>
<p>Trong các bài toán hồi quy, hiệu quả của mô hình thường được đánh giá thông qua ba thước đo phổ biến:</p>
<ul class="simple">
<li><p>Sai số tuyệt đối trung bình, hay <em>Mean Absolute Error</em>, đo lường sai lệch trung bình tuyệt đối giữa giá trị dự đoán và giá trị thực tế.</p></li>
<li><p>Sai số bình phương trung bình, hay <em>Mean Squared Error</em>, tính trung bình của bình phương sai số, nhấn mạnh các sai lệch lớn.</p></li>
<li><p>Hệ số xác định, hay R-squared, phản ánh tỷ lệ phương sai của biến mục tiêu được giải thích bởi mô hình, dao động từ 0 đến 1.</p></li>
</ul>
<p>Các thước đo này cung cấp cái nhìn toàn diện về độ chính xác và độ tin cậy của mô hình hồi quy trong việc dự đoán dữ liệu thực tế. Các sai số này được tích hợp sẵn trong thư viện <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">root_mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.038014384108962
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.44714869744024754
</pre></div>
</div>
</div>
</div>
<p>Kết quả đánh giá cho thấy chỉ số R-squared đạt giá trị 0.447, điều này đồng nghĩa với việc mô hình hiện tại có khả năng giải thích khoảng 44,7% sự biến động của giá bất động sản dựa trên các đặc trưng đầu vào.</p>
<p>Bên cạnh đó, sai số tuyệt đối trung bình là 28.0, cho thấy rằng trung bình mô hình dự đoán sai lệch khoảng 28 triệu đồng mỗi mét vuông so với giá trị thực tế. Mức sai số này phản ánh mức độ chênh lệch cần được cải thiện trong các bước tinh chỉnh tiếp theo của mô hình.</p>
<p>Mặc dù mô hình hiện tại đã phần nào phản ánh được ảnh hưởng của các đặc trưng đầu vào đến giá bất động sản, nhưng độ chính xác vẫn chưa đạt kỳ vọng. Để cải thiện năng lực dự đoán của mô hình, có thể xem xét các hướng tiếp cận sau:</p>
<ol class="arabic simple">
<li><p>Tiếp tục chuẩn hóa và biến đổi dữ liệu hiện có: với các biến phân loại, một kỹ thuật hiệu quả là gộp các nhóm có giá trị trung bình của biến mục tiêu tương đương nhằm giảm nhiễu và cải thiện tính khái quát của mô hình.</p></li>
<li><p>Tạo thêm các biến mới có ý nghĩa kinh tế: việc thiết kế các đặc trưng mới có thể cải thiện đáng kể hiệu năng dự đoán. Ví dụ, với hai bất động sản có cùng diện tích, bất động sản có mặt tiền rộng thường có giá cao hơn, điều này gợi ý có thể bổ sung biến như tỷ lệ mặt tiền trên chiều sâu (Rộng/Dài) để đưa thêm thông tin về hình dạng lô đất vào mô hình.</p></li>
<li><p>Tích hợp dữ liệu từ các nguồn bên ngoài: một số yếu tố quan trọng như vị trí địa lý, hạ tầng, và tiện ích xung quanh không có sẵn trong dữ liệu gốc nhưng có thể thu thập từ các hệ thống bản đồ thông qua biến địa chỉ của bất động sản. Các đặc trưng như khoảng cách đến đường lớn, độ rộng mặt đường, khoảng cách đến trường học, bệnh viện, trung tâm thương mại, chợ… có thể đóng vai trò then chốt trong việc cải thiện khả năng dự báo.</p></li>
<li><p>Xem xét các lớp mô hình học máy khác: khi bộ đặc trưng đã đầy đủ và có chất lượng, nên thử nghiệm với nhiều thuật toán mô hình khác nhau, không giới hạn trong rừng ngẫu nhiên. Trên thực tế, các mô hình thuộc nhóm học tăng cường, hay boosting, như <strong>Gradient Boosting Machines (GBM)</strong>, <strong>XGBoost</strong>, <strong>LightGBM</strong> thường cho hiệu năng cao hơn trong các bài toán dự đoán giá bất động sản.</p></li>
</ol>
</section>
</section>
<section id="tim-khach-hang-tiem-nang-cho-chien-dich-quang-cao">
<h3><span class="section-number">3.3.3. </span>Tìm khách hàng tiềm năng cho chiến dịch quảng cáo<a class="headerlink" href="#tim-khach-hang-tiem-nang-cho-chien-dich-quang-cao" title="Link to this heading">#</a></h3>
<hr><section id="gioi-thieu-ve-du-lieu">
<h4><span class="section-number">3.3.3.1. </span>Giới thiệu về dữ liệu<a class="headerlink" href="#gioi-thieu-ve-du-lieu" title="Link to this heading">#</a></h4>
<hr><p>Trong bối cảnh cạnh tranh gay gắt giữa các tổ chức tài chính, việc tối ưu hóa chiến dịch tiếp thị nhằm tiếp cận đúng tệp khách hàng tiềm năng là yếu tố then chốt giúp tăng tỷ lệ chuyển đổi, giảm chi phí, và nâng cao hiệu quả hoạt động.</p>
<p>Là một chuyên gia phân tích dữ liệu trong một ngân hàng, bạn được giao phụ trách một chiến dịch tiếp thị đến khách hàng về mở sổ tiết kiệm có kỳ hạn. Bạn được trung tâm dữ liệu gửi cho thông tin của 20 nghìn khách hàng tiềm năng, nhưng với mức kinh phí được giao, bạn chỉ có thể tiếp cận đến 10% số khách hàng trong danh sách, nghĩa là khoảng 2000 người. Một cách tự nhiên, câu hỏi đặt ra với bạn là: <em>“Nên tiếp cận 2000 khách hàng nào sao cho tổng số khách hàng đồng ý mở sổ tiết kiệm kỳ hạn?”</em></p>
<p>Với kinh nghiệm làm việc với dữ liệu, bạn hiểu rằng phân tích dữ liệu lịch sử từ các chiến dịch tiếp thị trước đây, bạn có thể xây dựng một mô hình dự đoán, giúp tính toán được khả năng đồng ý mở sổ tiết kiệm của khách hành. Tiếp cận đến 2000 khách hàng có khả năng đồng ý cao nhất sẽ giúp bạn ưu tiên gọi điện đến đúng đối tượng và tối ưu được hiệu quả tiếp thị.</p>
<p>Tập dữ liệu thu thập từ các chiến dịch tiếp thị qua điện thoại của một ngân hàng tại Việt Nam. Mỗi dòng trong dữ liệu đại diện cho một khách hàng đã được gọi điện trong một chiến dịch cụ thể. Tập dữ liệu bao gồm:</p>
<ul class="simple">
<li><p>**Biến mục tiêu là biến <code class="docutils literal notranslate"><span class="pre">term_deposit</span></code>, cho biết khách hàng có đăng ký tiền gửi có kỳ hạn hay không? Đây là một biến nhị phân chỉ nhận giá trị 0 nếu khách hàng không đồng ý và 1 nếu khách hàng đồng ý.</p></li>
<li><p>Các biến liên quan đến thông tin về khách hàng được mô tả trong bảng dưới đây:</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tên biến</p></th>
<th class="head"><p>Diễn giải</p></th>
<th class="head"><p>Kiểu dữ liệu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">age</span></code></p></td>
<td><p>Tuổi của khách hàng</p></td>
<td><p>Số</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">job</span></code></p></td>
<td><p>Nghề nghiệp (VD: admin., technician, retired, …)</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">marital</span></code></p></td>
<td><p>Tình trạng hôn nhân</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">education</span></code></p></td>
<td><p>Trình độ học vấn</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">default</span></code></p></td>
<td><p>Đang nợ xấu không?</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">balance</span></code></p></td>
<td><p>Tổng số tiền gửi và dư nợ của khách hàng?</p></td>
<td><p>Số (triệu đồng)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">housing</span></code></p></td>
<td><p>Có đang vay mua nhà không?</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">loan</span></code></p></td>
<td><p>Có đang vay tiêu dùng không?</p></td>
<td><p>Phân loại</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Các biến liên quan đến thông tin về cuộc gọi gần nhất</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tên biến</p></th>
<th class="head"><p>Diễn giải</p></th>
<th class="head"><p>Kiểu dữ liệu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">month</span></code></p></td>
<td><p>Tháng gọi điện</p></td>
<td><p>Phân loại</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dayofweek</span></code></p></td>
<td><p>Thứ trong tuần gọi điện</p></td>
<td><p>Phân loại</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Các biến liên quan đến thông tin từ các chiến dịch tiếp thị</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tên biến</p></th>
<th class="head"><p>Diễn giải</p></th>
<th class="head"><p>Kiểu dữ liệu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">campaign</span></code></p></td>
<td><p>Số lần gọi trong chiến dịch hiện tại</p></td>
<td><p>Số</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pdays</span></code></p></td>
<td><p>Số ngày kể từ lần liên hệ trước đó (999 nếu chưa từng liên hệ)</p></td>
<td><p>Số</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">previous</span></code></p></td>
<td><p>Số lần liên hệ trong các chiến dịch trước</p></td>
<td><p>Số</p></td>
</tr>
</tbody>
</table>
</div>
<p>Dữ liệu được lưu trong file <code class="docutils literal notranslate"><span class="pre">BankCustomerData.csv</span></code>. Chúng ta đọc dữ liệu vào Python như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/BankCustomerData.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>balance</th>
      <th>housing</th>
      <th>loan</th>
      <th>day</th>
      <th>month</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>term_deposit</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>58</td>
      <td>management</td>
      <td>2</td>
      <td>tertiary</td>
      <td>0</td>
      <td>2143</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>261</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>44</td>
      <td>technician</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>29</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>151</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33</td>
      <td>entrepreneur</td>
      <td>2</td>
      <td>secondary</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>may</td>
      <td>76</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>47</td>
      <td>blue-collar</td>
      <td>2</td>
      <td>unknown</td>
      <td>0</td>
      <td>1506</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>92</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>33</td>
      <td>unknown</td>
      <td>1</td>
      <td>unknown</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>198</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42635</th>
      <td>21</td>
      <td>student</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>2488</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>jan</td>
      <td>661</td>
      <td>2</td>
      <td>92</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42636</th>
      <td>87</td>
      <td>retired</td>
      <td>2</td>
      <td>primary</td>
      <td>0</td>
      <td>2190</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>jan</td>
      <td>512</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42637</th>
      <td>34</td>
      <td>blue-collar</td>
      <td>2</td>
      <td>primary</td>
      <td>0</td>
      <td>6718</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>278</td>
      <td>4</td>
      <td>97</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>42638</th>
      <td>22</td>
      <td>student</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>254</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>143</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42639</th>
      <td>32</td>
      <td>management</td>
      <td>1</td>
      <td>tertiary</td>
      <td>0</td>
      <td>1962</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>130</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>42639 rows × 15 columns</p>
</div></div></div>
</div>
</section>
<section id="id1">
<h4><span class="section-number">3.3.3.2. </span>Phân tích khai phá dữ liệu<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<hr><p>Trước hết có thể thấy rằng đây là một dữ liệu đã được làm sạch và không cần quá nhiều các bước tiền xử lý hay định dạng lại dữ liệu giống như ví dụ vè giá nhà tại Hà Nội. Trước tiên, chúng ta xem phân phối của biến mục tiêu</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;term_deposit&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phân phối biến mục tiêu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;term_deposit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/589cadc356df0fb900898184ccbf1166d5ca79918f68bcf3317877fde5c2b9f7.png" src="../_images/589cadc356df0fb900898184ccbf1166d5ca79918f68bcf3317877fde5c2b9f7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>term_deposit
0    0.907104
1    0.092896
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Có thể thấy rằng số tỷ lệ khách hành đồng ý gửi tiết kiệm có kỳ hạn chỉ khoảng 9.3%, nghĩa là nếu chúng ta tiếp cận khách hàng một cách ngẫu nhiên mà không có tính toán, chỉ có 1 trên 10 khách hàng đồng ý gửi tiết kiệm. Bằng cách sử dụng mô hình học máy, chúng ta kỳ vọng rằng tỷ lệ khách hàng đồng ý sẽ lớn hơn so với lựa chọn ngẫu nhiên.</p>
<p>Chúng ta sẽ quan sát phân phối của một số biến liên tục quan trọng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numerical_vars</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#0277B8&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Phân phối biến </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;term_deposit&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> theo term_deposit&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0ad992eab9cb5b97c0236cea4983f55b286d1a17771a48d96b609804f9031d9a.png" src="../_images/0ad992eab9cb5b97c0236cea4983f55b286d1a17771a48d96b609804f9031d9a.png" />
<img alt="../_images/7269f4d816d1b56434afb73169556f357f291f6bcd9855b68d0411936d1c89c6.png" src="../_images/7269f4d816d1b56434afb73169556f357f291f6bcd9855b68d0411936d1c89c6.png" />
</div>
</div>
<p>Phân tích thống kê mô tả đối với biến balance cho thấy phần lớn các quan sát tập trung trong khoảng giá trị từ -1000 đến 4000. Ngoài ra, có mối liên hệ dương giữa mức số dư tài khoản và khả năng khách hàng đồng ý tham gia tiền gửi có kỳ hạn, gợi ý rằng nhóm khách hàng có khả năng tài chính tốt hơn có xu hướng quan tâm nhiều hơn đến sản phẩm tiết kiệm của ngân hàng. Biến <code class="docutils literal notranslate"><span class="pre">balance</span></code> là một đặc trưng tốt để đưa vào trong mô hình học máy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numerical_vars</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Phân phối biến </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#plt.xlim([-2000, 10000])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;term_deposit&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> theo term_deposit&#39;</span><span class="p">)</span>
    <span class="c1">#plt.ylim([-2000, 10000])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6f783d9836c98cd85a862990ea139fb98f179a7e76db2ee8f4035818d1d55510.png" src="../_images/6f783d9836c98cd85a862990ea139fb98f179a7e76db2ee8f4035818d1d55510.png" />
<img alt="../_images/7722fbcd2b404ddbc9dd55bdf4e6186cdf2099a838a1df3b7eb6373bec0c0f49.png" src="../_images/7722fbcd2b404ddbc9dd55bdf4e6186cdf2099a838a1df3b7eb6373bec0c0f49.png" />
</div>
</div>
<p>Khác với biến <code class="docutils literal notranslate"><span class="pre">balance</span></code>, <code class="docutils literal notranslate"><span class="pre">biến</span> <span class="pre">age</span></code> không thể hiện mối quan hệ tuyến tính hoặc xu hướng rõ ràng đối với xác suất khách hàng đồng ý gửi tiền tiết kiệm. Điều này cho thấy độ tuổi không phải là yếu tố quyết định hành vi tài chính liên quan đến sản phẩm tiền gửi có kỳ hạn trong tập khách hàng được khảo sát.</p>
<p>Mặc dù tuổi có thể ảnh hưởng đến các quyết định tài chính cá nhân, kết quả phân tích cho thấy không tồn tại mối quan hệ rõ ràng giữa độ tuổi và xu hướng gửi tiết kiệm. Điều này hàm ý rằng yếu tố độ tuổi có thể bị chi phối bởi các đặc điểm khác như nghề nghiệp, mức thu nhập, hoặc mục tiêu tài chính cá nhân, và do đó không đóng vai trò nổi bật khi xét độc lập trong dự đoán hành vi khách hàng.</p>
<p>Chúng ta sẽ đánh giá một số biến phân loại đến biến mục tiêu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Đếm số lượng theo housing/loan và term_deposit</span>
<span class="n">housing_td</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;housing&#39;</span><span class="p">,</span> <span class="s1">&#39;term_deposit&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loan_td</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;loan&#39;</span><span class="p">,</span> <span class="s1">&#39;term_deposit&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Tính tỷ lệ phần trăm</span>
<span class="n">housing_td_pct</span> <span class="o">=</span> <span class="n">housing_td</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">housing_td</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loan_td_pct</span> <span class="o">=</span> <span class="n">loan_td</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">loan_td</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Vẽ biểu đồ</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># BIỂU ĐỒ 1: Housing</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">housing_td</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">housing_td</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Không gửi&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">housing_td</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="o">-</span><span class="n">housing_td</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gửi tiết kiệm&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Phân bố term_deposit theo trạng thái Housing&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Housing (0 = Không vay, 1 = Có vay)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Số lượng khách hàng&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Thêm nhãn %</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">housing_td</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">housing_td</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">housing_td</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">housing_td_pct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># BIỂU ĐỒ 2: Loan</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">loan_td</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">loan_td</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Không gửi&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">loan_td</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="o">-</span><span class="n">loan_td</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gửi tiết kiệm&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Phân bố term_deposit theo trạng thái Loan&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Loan (0 = Không vay, 1 = Có vay)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Số lượng khách hàng&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Thêm nhãn %</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loan_td</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">loan_td</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">loan_td</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loan_td_pct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/af558a6ea43e0622cae194d9f3908f7eaf00dd05bb76e4a4310c3576ffb8300f.png" src="../_images/af558a6ea43e0622cae194d9f3908f7eaf00dd05bb76e4a4310c3576ffb8300f.png" />
</div>
</div>
<p>Phân tích dữ liệu cho thấy sự khác biệt rõ rệt trong hành vi gửi tiền tiết kiệm giữa các nhóm khách hàng có và không có khoản vay tài chính như vay mua nhà hoặc vay tiêu dùng. Cụ thể, khách hàng đang có các nghĩa vụ tài chính hiện hữu thường ít có xu hướng đăng ký sản phẩm tiền gửi có kỳ hạn. Điều này có thể được lý giải bởi áp lực chi trả định kỳ từ các khoản vay, làm giảm khả năng tích lũy vốn nhàn rỗi cũng như nhu cầu tiếp cận các sản phẩm tiết kiệm dài hạn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tính số lượng khách hàng theo job và term_deposit</span>
<span class="n">job_ct</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;job&#39;</span><span class="p">,</span> <span class="s1">&#39;term_deposit&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Tính tỷ lệ phần trăm đồng ý</span>
<span class="n">job_pct</span> <span class="o">=</span> <span class="n">job_ct</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">job_ct</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Sắp xếp theo tổng số để biểu đồ trực quan hơn</span>
<span class="n">job_ct</span> <span class="o">=</span> <span class="n">job_ct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">job_ct</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">job_pct</span> <span class="o">=</span> <span class="n">job_pct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">job_ct</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># Trục x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">job_ct</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.6</span>

<span class="c1"># Vẽ biểu đồ</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">bars1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">job_ct</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Không đồng ý&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
<span class="n">bars2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">job_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">job_ct</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Đồng ý&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>

<span class="c1"># Cài đặt trục và tiêu đề</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">job_ct</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Số lượng khách hàng&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Tỷ lệ đồng ý gửi tiết kiệm theo nhóm nghề nghiệp&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Thêm nhãn phần trăm ở phía trên cột</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">job_ct</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">pct_yes</span> <span class="o">=</span> <span class="n">job_pct</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">job_ct</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">job_ct</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">top</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pct_yes</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a9dbd509daa28b788cc9b0b66f4c9a3a3f7d91ddffddf63e9b33aa583a0fd59a.png" src="../_images/a9dbd509daa28b788cc9b0b66f4c9a3a3f7d91ddffddf63e9b33aa583a0fd59a.png" />
</div>
</div>
<p>Phân tích dữ liệu cho thấy nhóm khách hàng là sinh viên và người đã nghỉ hưu có xác suất đồng ý gửi tiền tiết kiệm cao hơn đáng kể so với các nhóm nghề nghiệp khác. Ngược lại, những người làm việc trong khối hành chính – văn phòng (ví dụ: nhóm ‘admin.’) lại thể hiện xu hướng ít quan tâm đến sản phẩm tiền gửi có kỳ hạn.</p>
<p>Có thể giải thích từ góc độ hành vi tài chính:</p>
<ul class="simple">
<li><p>Người nghỉ hưu thường có dòng tiền ổn định từ lương hưu và nhu cầu bảo toàn vốn cao. Do đó, họ có xu hướng lựa chọn các sản phẩm tài chính an toàn, như tiền gửi có kỳ hạn – nơi không yêu cầu mức độ rủi ro cao và vẫn đảm bảo sinh lời ổn định.</p></li>
<li><p>Sinh viên, mặc dù có thu nhập hạn chế, lại có thể bị thu hút bởi các chương trình khuyến mãi hoặc chính sách ưu đãi từ ngân hàng. Đồng thời, một bộ phận sinh viên có thể đang quản lý khoản tiền được gia đình gửi định kỳ, từ đó dẫn đến hành vi gửi tiết kiệm để tích lũy cho tương lai gần.</p></li>
<li><p>Nhân viên văn phòng có thể đang trong độ tuổi lao động tích cực, với nhiều lựa chọn đầu tư khác như chứng khoán, bảo hiểm, hoặc tiêu dùng lớn (mua nhà, mua xe), nên mức độ ưu tiên cho tiền gửi có kỳ hạn thấp hơn. Ngoài ra, nhóm này có thể có xu hướng thích các sản phẩm tài chính linh hoạt hơn so với tiền gửi cố định.</p></li>
</ul>
<p>Quá trình phân tích khai phá dữ liệu sẽ tiếp tục được thực hiện đối với tất cả các biến được đưa vào mô hình. Đối với các biến phân loại có nhiều mức giá trị (category levels), bạn đọc cần lưu ý rằng nguyên tắc chuyển đổi các biến này thành đặc trưng đầu vào có ý nghĩa là dựa trên việc nhóm các mức có giá trị trung bình của biến mục tiêu tương đồng lại với nhau. Cách tiếp cận này không chỉ giúp giảm số lượng đặc trưng cần xử lý mà còn đảm bảo tính ổn định và khả năng giải thích của mô hình.</p>
</section>
<section id="xay-dung-mo-hinh-hoc-may">
<h4><span class="section-number">3.3.3.3. </span>Xây dựng mô hình học máy<a class="headerlink" href="#xay-dung-mo-hinh-hoc-may" title="Link to this heading">#</a></h4>
<hr><p>Sau quá trình phân tích khai phá, chúng ta sẽ lựa chọn các biến phân loại bao gồm <code class="docutils literal notranslate"><span class="pre">job</span></code>, <code class="docutils literal notranslate"><span class="pre">marital</span></code>, <code class="docutils literal notranslate"><span class="pre">education</span></code>, <code class="docutils literal notranslate"><span class="pre">housing</span></code>, <code class="docutils literal notranslate"><span class="pre">loan</span></code>, <code class="docutils literal notranslate"><span class="pre">previous</span></code>, và <code class="docutils literal notranslate"><span class="pre">campaign</span></code> vào mô hình dự đoán. Biến <code class="docutils literal notranslate"><span class="pre">balance</span></code> là biến liên tục duy nhất được sử dụng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/BankCustomerData_clean.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>balance</th>
      <th>housing</th>
      <th>loan</th>
      <th>day</th>
      <th>month</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>term_deposit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>58</td>
      <td>management</td>
      <td>2</td>
      <td>tertiary</td>
      <td>0</td>
      <td>2143</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>261</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>44</td>
      <td>technician</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>29</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>151</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>33</td>
      <td>entrepreneur</td>
      <td>2</td>
      <td>secondary</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>may</td>
      <td>76</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>47</td>
      <td>blue-collar</td>
      <td>2</td>
      <td>unknown</td>
      <td>0</td>
      <td>1506</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>92</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>33</td>
      <td>unknown</td>
      <td>1</td>
      <td>unknown</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>may</td>
      <td>198</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42635</th>
      <td>42635</td>
      <td>21</td>
      <td>student</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>2488</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>jan</td>
      <td>661</td>
      <td>2</td>
      <td>92</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42636</th>
      <td>42636</td>
      <td>87</td>
      <td>retired</td>
      <td>2</td>
      <td>primary</td>
      <td>0</td>
      <td>2190</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>jan</td>
      <td>512</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42637</th>
      <td>42637</td>
      <td>34</td>
      <td>blue-collar</td>
      <td>2</td>
      <td>primary</td>
      <td>0</td>
      <td>6718</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>278</td>
      <td>4</td>
      <td>97</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>42638</th>
      <td>42638</td>
      <td>22</td>
      <td>student</td>
      <td>1</td>
      <td>secondary</td>
      <td>0</td>
      <td>254</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>143</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42639</th>
      <td>42639</td>
      <td>32</td>
      <td>management</td>
      <td>1</td>
      <td>tertiary</td>
      <td>0</td>
      <td>1962</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>jan</td>
      <td>130</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>42639 rows × 16 columns</p>
</div></div></div>
</div>
<p>Chúng ta chia dữ liệu thành phần huấn luyện mô hình và kiểm tra mô hình theo tỷ lệ 50%-50%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;job&quot;</span><span class="p">,</span> <span class="s2">&quot;marital&quot;</span><span class="p">,</span> <span class="s2">&quot;education&quot;</span><span class="p">,</span> <span class="s2">&quot;housing&quot;</span><span class="p">,</span> <span class="s2">&quot;loan&quot;</span><span class="p">,</span> <span class="s2">&quot;previous&quot;</span><span class="p">,</span> <span class="s2">&quot;campaign&quot;</span><span class="p">,</span><span class="s2">&quot;balance&quot;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;term_deposit&quot;</span><span class="p">],</span> 
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>housing</th>
      <th>loan</th>
      <th>previous</th>
      <th>campaign</th>
      <th>balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31256</th>
      <td>retired</td>
      <td>1</td>
      <td>unknown</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>588</td>
    </tr>
    <tr>
      <th>19548</th>
      <td>technician</td>
      <td>2</td>
      <td>secondary</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>277</td>
    </tr>
    <tr>
      <th>32854</th>
      <td>management</td>
      <td>1</td>
      <td>tertiary</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>146</td>
    </tr>
    <tr>
      <th>40921</th>
      <td>blue-collar</td>
      <td>1</td>
      <td>primary</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>334</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>management</td>
      <td>2</td>
      <td>primary</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>226</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32104</th>
      <td>blue-collar</td>
      <td>2</td>
      <td>secondary</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>-145</td>
    </tr>
    <tr>
      <th>30404</th>
      <td>management</td>
      <td>1</td>
      <td>tertiary</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>995</td>
    </tr>
    <tr>
      <th>21244</th>
      <td>management</td>
      <td>2</td>
      <td>tertiary</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5+</td>
      <td>750</td>
    </tr>
    <tr>
      <th>42614</th>
      <td>management</td>
      <td>2</td>
      <td>tertiary</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>323</td>
    </tr>
    <tr>
      <th>2733</th>
      <td>blue-collar</td>
      <td>1</td>
      <td>secondary</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>57</td>
    </tr>
  </tbody>
</table>
<p>21319 rows × 8 columns</p>
</div></div></div>
</div>
<p>Tương tự như ví dụ trước, chúng ta biến đổi biến phân loại thành biến dummy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Chuyển đổi biến sang kiểu one hot</span>
<span class="n">X_train_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Đồng bộ hóa cột giữa train/test</span>
<span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">X_train_encoded</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mô hình hồi quy logistic là một trong những phương pháp kinh điển thường được sử dụng khi biến mục tiêu là biến nhị phân. Mặc dù tồn tại một số vấn đề cần được xem xét kỹ lưỡng trước khi xây dựng mô hình – chẳng hạn như sự mất cân bằng giữa hai lớp của biến mục tiêu – trong phạm vi hiện tại, chúng ta tạm thời chưa đi sâu vào các khía cạnh này và sẽ trực tiếp thực thi mô hình. Những vấn đề liên quan đến chất lượng dữ liệu, đặc biệt là mất cân bằng lớp, sẽ được phân tích và thảo luận chi tiết hơn trong các phần tiếp theo của cuốn sách.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="c1"># Huấn luyện mô hình Logistic Regression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

<span class="c1"># Dự đoán</span>
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Khi xây dựng mô hình dự đoán với biến mục tiêu nhị phân, việc đánh giá hiệu quả mô hình thường được thực hiện thông qua Confusion Matrix. Đây là một bảng 2x2 thể hiện số lượng dự đoán đúng và sai của mô hình, phân theo từng lớp của biến mục tiêu. Đối với mô hình phân loại nhị phân, confusion matrix bao gồm bốn thành phần chính:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>Dự đoán: 0</strong></p></th>
<th class="head"><p><strong>Dự đoán: 1</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Thực tế: 0</strong></p></td>
<td><p><strong>TN</strong></p></td>
<td><p><strong>FP</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Thực tế: 1</strong></p></td>
<td><p><strong>FN</strong></p></td>
<td><p><strong>TP</strong></p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>True Positive (TP):</strong><br />
Số lượng quan sát có giá trị thực là 1 và được mô hình dự đoán đúng là 1.<br />
→ Dự đoán đúng trường hợp dương tính.</p></li>
<li><p><strong>True Negative (TN):</strong><br />
Số lượng quan sát có giá trị thực là 0 và được dự đoán đúng là 0.<br />
→ Dự đoán đúng trường hợp âm tính.</p></li>
<li><p><strong>False Positive (FP):</strong><br />
Số lượng quan sát có giá trị thực là 0 nhưng bị mô hình dự đoán nhầm là 1.<br />
→ Dự đoán sai dương tính (hay còn gọi là <em>Type I error</em>).</p></li>
<li><p><strong>False Negative (FN):</strong><br />
Số lượng quan sát có giá trị thực là 1 nhưng bị mô hình dự đoán nhầm là 0.<br />
→ Dự đoán sai âm tính (<em>Type II error</em>).</p></li>
</ul>
<p>Từ các thành phần trên, ta có thể tính được nhiều <strong>chỉ số đánh giá quan trọng</strong>, bao gồm:</p>
<ul class="simple">
<li><p><strong>Accuracy</strong> (Độ chính xác tổng thể):<br />
[
\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}
]</p></li>
<li><p><strong>Precision</strong> (Độ chính xác cho lớp dương):<br />
[
\text{Precision} = \frac{TP}{TP + FP}
]</p></li>
<li><p><strong>Recall</strong> (Khả năng phát hiện lớp dương):<br />
[
\text{Recall} = \frac{TP}{TP + FN}
]</p></li>
<li><p><strong>F1-score</strong> (Trung bình điều hòa của Precision và Recall):<br />
[
\text{F1} = 2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}
]</p></li>
</ul>
<p>Confusion Matrix cung cấp một cái nhìn chi tiết và cân bằng hơn về hiệu quả của mô hình phân loại so với chỉ số đơn lẻ như accuracy. Đặc biệt trong các bài toán mất cân bằng lớp, các chỉ số như precision, recall và F1-score thường phản ánh chính xác hơn năng lực của mô hình đối với lớp mục tiêu quan trọng.</p>
<p>Confusiton matrix được tính toán cho kết quả của mô hình hồi quy logistic như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># Đánh giá mô hình</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix:
 [[12381  6955]
 [  802  1182]]

Classification Report:
               precision    recall  f1-score   support

           0       0.94      0.64      0.76     19336
           1       0.15      0.60      0.23      1984

    accuracy                           0.64     21320
   macro avg       0.54      0.62      0.50     21320
weighted avg       0.87      0.64      0.71     21320
</pre></div>
</div>
</div>
</div>
<p>Có thể nhận xét kết quả như sau:</p>
<ul class="simple">
<li><p>Recall của lớp 1 đạt 60%: cho thấy mô hình đã có khả năng phát hiện đáng kể số lượng khách hàng thực sự gửi tiền – đây là yếu tố quan trọng trong bài toán marketing nhắm mục tiêu.</p></li>
<li><p>F1-score của lớp 0 là 0.76, chứng tỏ mô hình vẫn duy trì được hiệu suất khá tốt với nhóm khách hàng không gửi tiền.</p></li>
<li><p>Precision của lớp 1 rất thấp (0.15): chỉ 15% trong số những khách hàng được dự đoán sẽ gửi tiền là đúng thực tế.</p></li>
<li><p>F1-score của lớp 1 chỉ đạt 0.23, phản ánh độ chính xác tổng thể đối với nhóm mục tiêu còn yếu.</p></li>
</ul>
<p>Mặc dù mô hình vẫn còn nhiều điểm cần cải thiện, tuy nhiên chúng ta vẫn có thể thấy được hiệu quả của mô hình trong lựa chọn khách hàng tiềm năng. Quay trở lại với mục tiêu ban đầu, chúng ta cần lựa chọn 2000 khách hành có khả năng cao chấp nhận mở sổ tiết kiệm. Nếu chúng ta lựa chọn ngẫu nhiên, số lượng khách hàng đồng ý rơi vào khoảng 9.3%, tương đương với khoảng 185 khách hàng.</p>
<p>Nếu sử dụng kết quả của mô hình logistic, chúng ta sẽ lựa chọn 2000 khách hàng có xác suất đồng ý mở sổ tiết kiệm cao nhất trong hơn 20 nghìn khách hàng của tập dữ liệu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dự đoán xác suất đồng ý gửi tiết kiệm</span>
<span class="n">y_proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Đưa xác suất vào DataFrame</span>
<span class="n">df_proba</span> <span class="o">=</span> <span class="n">X_test_encoded</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_proba</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_proba</span>

<span class="c1"># Thêm biến nhãn thật</span>
<span class="n">df_proba</span><span class="p">[</span><span class="s1">&#39;true_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y_test</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Sắp xếp theo xác suất giảm dần</span>
<span class="n">df_top2000</span> <span class="o">=</span> <span class="n">df_proba</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Số lượng khách hàng đồng ý</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">df_top2000</span><span class="p">[</span><span class="s1">&#39;true_label&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>494
</pre></div>
</div>
</div>
</div>
<p>Dựa trên kết quả dự đoán xác suất từ mô hình hồi quy logistic, khi lựa chọn 2.000 khách hàng có xác suất đồng ý cao nhất, có tổng cộng 494 khách hàng thực sự đồng ý mở sổ tiết kiệm. Điều này tương đương với tỷ lệ chuyển đổi là 24.7%.</p>
<p>So sánh với tỷ lệ đồng ý trung bình trong toàn bộ tập dữ liệu là 9.3%, tương ứng với lựa chọn ngẫu nhiên, mô hình đã giúp tăng gần gấp 3 lần tỷ lệ chuyển đổi, cho thấy hiệu quả đáng kể trong việc ưu tiên tiếp cận nhóm khách hàng tiềm năng.</p>
<p>Chúng ta cũng có thể sử dụng mô hình <em>rừng ngẫu nhiên</em> như trong ví dụ kể trên để dự đoán khách hàng có hay không đồng ý mở thẻ tín dụng. Mô hình được thực thi và cho kết quả như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Khởi tạo mô hình Random Forest</span>
<span class="n">rf_model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>      <span class="c1"># số lượng cây</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>        <span class="c1"># độ sâu tối đa</span>
    <span class="n">max_features</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>        <span class="c1"># số lượng đặc trưng của mỗi cây quyết định</span>
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>       <span class="c1"># khởi tạo ngẫu nhiên để tái lập kết quả</span>
<span class="p">)</span>

<span class="c1"># Huấn luyện mô hình với dữ liệu huấn luyện</span>
<span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">)</span>

<span class="n">df_proba</span> <span class="o">=</span> <span class="n">X_test_encoded</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_proba</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y_pred</span>

<span class="c1"># Thêm biến nhãn thật</span>
<span class="n">df_proba</span><span class="p">[</span><span class="s1">&#39;true_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y_test</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Sắp xếp theo xác suất giảm dần</span>
<span class="n">df_top2000</span> <span class="o">=</span> <span class="n">df_proba</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Số lượng khách hàng đồng ý</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">df_top2000</span><span class="p">[</span><span class="s1">&#39;true_label&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>511
</pre></div>
</div>
</div>
</div>
<p>Kết quả phân tích cho thấy số lượng khách hàng thực sự đồng ý mở sổ tiết kiệm trong nhóm được mô hình lựa chọn đã tăng từ 494 lên 511 khi chuyển từ mô hình hồi quy logistic sang mô hình rừng ngẫu nhiên. Điều này cho thấy hiệu suất dự báo của mô hình rừng ngẫu nhiên có phần vượt trội hơn so với mô hình hồi quy logistic truyền thống trong trường hợp cụ thể này.</p>
<p>Tuy nhiên, cần lưu ý rằng hồi quy logistic là một mô hình dạng tham số, cho phép diễn giải trực tiếp mối quan hệ giữa các biến đầu vào và biến mục tiêu. Ngược lại, mô hình rừng ngẫu nhiên tuy có khả năng dự báo mạnh mẽ hơn, lại thuộc nhóm mô hình phi tham số, do đó khó đưa ra các suy diễn định lượng rõ ràng. Đây chính là ví dụ điển hình cho một vấn đề phổ biến trong học máy: sự đánh đổi giữa khả năng dự báo và khả năng giải thích của mô hình.</p>
<p>Từ góc độ ứng dụng, việc sử dụng các mô hình dự đoán cho phép tổ chức không chỉ tối ưu hóa chi phí tiếp thị thông qua việc xác định nhóm khách hàng tiềm năng, mà còn gia tăng đáng kể tỷ lệ chuyển đổi trong các chiến dịch. Kết quả này là một minh chứng cụ thể cho tính khả thi và hiệu quả của việc tích hợp các mô hình học máy vào chiến lược chăm sóc khách hàng và phân bổ nguồn lực trong lĩnh vực ngân hàng.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="nguyen-ly-phan-tich-du-lieu.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Nguyên lý phân tích dữ liệu</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter4-basics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Python cơ bản</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu-chung-ve-xay-dung-mo-hinh">3.1. Giới thiệu chung về xây dựng mô hình</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lich-su-hinh-thanh-cua-cac-mo-hinh-hoc-may">3.1.1. Lịch sử hình thành của các mô hình học máy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoc-may-trong-kinh-te-va-kinh-doanh">3.1.2. Học máy trong kinh tế và kinh doanh?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-van-de-hoc-may-co-the-giai-quyet">3.1.3. Các vấn đề học máy có thể giải quyết</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hoc-may-va-ngon-ngu-python">3.2. Học máy và ngôn ngữ Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-xay-dung-mo-hinh-hoc-may">3.2.1. Thư viện xây dựng mô hình học máy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-thu-vien-va-cong-cu-ho-tro">3.2.2. Các thư viện và công cụ hỗ trợ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-numpy">3.2.2.1. Thư viện NumPy</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-scipy">3.2.2.2. Thư viện SciPy</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">3.2.2.3. matplotlib</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thu-vien-pandas">3.2.2.4. Thư viện pandas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ung-dung-thuc-te-cua-mo-hinh-hoc-may">3.3. Ứng dụng thực tế của mô hình học máy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-loai-cac-loai-hoa-iris">3.3.1. Phân loại các loài hoa Iris</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lam-quen-voi-du-lieu-phan-loai-hoa-iris">3.3.1.1. Làm quen với dữ liệu phân loại hoa iris</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-huan-luyen-mo-hinh-va-du-lieu-kiem-tra-mo-hinh">3.3.1.2. Dữ liệu huấn luyện mô hình và dữ liệu kiểm tra mô hình</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-du-lieu-kham-pha-eda">3.3.1.3. Phân tích dữ liệu khám phá (EDA)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-hinh-dau-tien-k-lang-gieng-gan-nhat">3.3.1.4. Mô hình đầu tiên: k-láng giềng gần nhất</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-hinh-thu-hai-mo-hinh-cay-quyet-dinh">3.3.1.5. Mô hình thứ hai: mô hình cây quyết định</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#du-doan-gia-bat-dong-san-tai-ha-noi">3.3.2. Dự đoán giá bất động sản tại Hà Nội</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-va-bai-toan-du-doan-gia-bat-dong-san">3.3.2.1. Dữ liệu và baì toán dự đoán giá bất động sản</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-khai-pha-du-lieu">3.3.2.2. Phân tích khai phá dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xay-dung-mo-hinh-du-doan-gia-nha">3.3.2.3. Xây dựng mô hình dự đoán giá nhà</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tim-khach-hang-tiem-nang-cho-chien-dich-quang-cao">3.3.3. Tìm khách hàng tiềm năng cho chiến dịch quảng cáo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu-ve-du-lieu">3.3.3.1. Giới thiệu về dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.3.2. Phân tích khai phá dữ liệu</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xay-dung-mo-hinh-hoc-may">3.3.3.3. Xây dựng mô hình học máy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Trường Công nghệ, Đại học Kinh tế Quốc dân
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
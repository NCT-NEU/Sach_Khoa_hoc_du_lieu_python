
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>9. Sắp xếp và biến đổi dữ liệu &#8212; Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/chapter9-transform';</script>
    <link rel="canonical" href="/Sach_Khoa_hoc_du_lieu_python/chapters/chapter9-transform.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Trực quan hóa dữ liệu" href="chapter10-visualization.html" />
    <link rel="prev" title="8. Làm sạch và chuẩn bị dữ liệu" href="chapter8-prepare.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python) - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh (Sử dụng ngôn ngữ Python) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Khoa học dữ liệu trong Kinh tế và Kinh doanh
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Danh sách chương</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gioi-thieu-ve-khoa-hoc-du-lieu.html">1. Các khái niệm cơ bản trong khoa học dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="nguyen-ly-phan-tich-du-lieu.html">2. Nguyên lý phân tích dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="khung-phuong-phap-xay-dung-mo-hinh.html">3. Tổng quan về xây dựng mô hình trên dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4-basics.html">4. Python cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5-Numpy.html">5. Kiến thức cơ bản về NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6-pandas.html">6. Giới thiệu về pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7-Import-data.html">7. Nhập và lưu trữ dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8-prepare.html">8. Làm sạch và chuẩn bị dữ liệu</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">9. Sắp xếp và biến đổi dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter10-visualization.html">10. Trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter12-Supervised.html">11. Các mô hình học máy có giám sát</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bài tập thực hành</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/100_bai_tap_python_day_du.html">Python cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_numpy.html">Bài tập NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/30_bai_tap_pandas.html">Bài tập trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/Pandas_Exercise.html">Thực hành nhập liệu từ các nguồn khác nhau</a></li>





<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_tien_xu_ly_du_lieu.html">Tiền xử lý dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_matplotlib_seaborn.html">Thực hành trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_linear_softmax_models.html">Mô hình tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/50_bai_tap_cay_rung_boosting.html">Cây quyết định và tập hợp cây quyết định</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/NCT-NEU/Sach_Khoa_hoc_du_lieu_python/main?urlpath=tree/chapters/chapter9-transform.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/NCT-NEU/Sach_Khoa_hoc_du_lieu_python/blob/main/chapters/chapter9-transform.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NCT-NEU/Sach_Khoa_hoc_du_lieu_python" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCT-NEU/Sach_Khoa_hoc_du_lieu_python/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter9-transform.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/chapter9-transform.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sắp xếp và biến đổi dữ liệu</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-so-phan-cap">9.1. Chỉ số phân cấp</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sap-xep-lai-va-sap-xep-cac-cap">9.1.1. Sắp xếp lại và sắp xếp các cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thong-ke-tom-tat-theo-cap">9.1.2. Thống kê tóm tắt theo cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tao-chi-so-bang-cac-cot-cua-dataframe">9.1.3. Tạo chỉ số bằng các cột của dataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-cac-tap-du-lieu">9.2. Kết hợp các tập dữ liệu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-gop-va-noi-du-lieu">9.2.1. Các phép gộp và nối dữ liệu</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-du-lieu-dua-tren-chi-so">9.2.2. Kết hợp dữ liệu dựa trên chỉ số</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#noi-du-lieu-theo-mot-truc">9.2.3. Nối dữ liệu theo một trục</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-hinh-lai-du-lieu-va-thay-doi-truc">9.3. Định hình lại dữ liệu và thay đổi trục</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-hinh-lai-voi-chi-so-phan-cap">9.3.1. Định hình lại với chỉ số phân cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xoay-truc-tu-dinh-dang-dai-sang-rong-va-nguoc-lai">9.3.2. Xoay trục từ định dạng dài sang rộng và ngược lại</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="" src="../_images/banner.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="sap-xep-va-bien-doi-du-lieu">
<h1><span class="section-number">9. </span>Sắp xếp và biến đổi dữ liệu<a class="headerlink" href="#sap-xep-va-bien-doi-du-lieu" title="Link to this heading">#</a></h1>
<p>Trong nhiều ứng dụng, dữ liệu có thể nằm rải rác trên nhiều tệp hoặc cơ sở dữ liệu, hoặc được sắp xếp dưới dạng không thuận tiện cho việc phân tích. Chương này tập trung vào các công cụ giúp kết hợp, nối và sắp xếp lại dữ liệu.</p>
<p>Đầu tiên, chúng ta sẽ làm quen với khái niệm về chỉ số phân cấp (hierarchical indexing) trong <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, một công cụ được sử dụng rộng rãi trong sắp xếp và biến đổi dữ liệu. Sau đó, chương sách sẽ đi sâu vào các thao tác xử lý dữ liệu cụ thể. Bạn đọc có thể xem các ứng dụng thực tế của những công cụ này cả trong các phần sau của cuốn sách</p>
<section id="chi-so-phan-cap">
<h2><span class="section-number">9.1. </span>Chỉ số phân cấp<a class="headerlink" href="#chi-so-phan-cap" title="Link to this heading">#</a></h2>
<hr><p>Chỉ số phân cấp, hay hierarchical indexing, là một tính năng quan trọng của pandas cho phép bạn có nhiều cấp độ chỉ số trên một trục. Một cách khác để hình dung về chỉ số phân cấp là nó cung cấp cho bạn một cách làm việc với dữ liệu nhiều chiều bằng cách thao tác trên các dữ liệu chiều thấp hơn. Hãy bắt đầu với một ví dụ đơn giản: tạo một Series với một danh sách các danh sách hoặc mảng làm chỉ số:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">),</span>
                 <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a  1    0.372762
   2    0.745619
   3    0.331739
b  1    0.748899
   3    0.458633
c  1    0.230011
   2    0.688013
d  2    0.787755
   3    0.207612
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>  <span class="mi">1</span>    <span class="mf">0.929616</span>
   <span class="mi">2</span>    <span class="mf">0.316376</span>
   <span class="mi">3</span>    <span class="mf">0.183919</span>
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">0.204560</span>
   <span class="mi">3</span>    <span class="mf">0.567725</span>
<span class="n">c</span>  <span class="mi">1</span>    <span class="mf">0.595545</span>
   <span class="mi">2</span>    <span class="mf">0.964515</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">0.653177</span>
   <span class="mi">3</span>    <span class="mf">0.748907</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Những gì bạn đang thấy là một dạng xem được làm đẹp của một Series với một MultiIndex làm chỉ số hàng. Các “khoảng trống” trong hiển thị chỉ số hàng chỉ mục có nghĩa là sử dụng chỉ số ngay phía trên:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;a&#39;, 1),
            (&#39;a&#39;, 2),
            (&#39;a&#39;, 3),
            (&#39;b&#39;, 1),
            (&#39;b&#39;, 3),
            (&#39;c&#39;, 1),
            (&#39;c&#39;, 2),
            (&#39;d&#39;, 2),
            (&#39;d&#39;, 3)],
           )
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
           <span class="p">)</span>
</pre></div>
</div>
<p>Với một đối tượng có chỉ mục phân cấp, có thể thực hiện thao tác được gọi là <em>truy cập một phần</em>, hay partial indexing, cho phép bạn chọn các tập hợp con của dữ liệu một cách ngắn gọn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    0.748899
3    0.458633
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>    <span class="mf">0.204560</span>
<span class="mi">3</span>    <span class="mf">0.567725</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b  1    0.748899
   3    0.458633
c  1    0.230011
   2    0.688013
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>  <span class="mi">1</span>    <span class="mf">0.204560</span>
   <span class="mi">3</span>    <span class="mf">0.567725</span>
<span class="n">c</span>  <span class="mi">1</span>    <span class="mf">0.595545</span>
   <span class="mi">2</span>    <span class="mf">0.964515</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b  1    0.748899
   3    0.458633
d  2    0.787755
   3    0.207612
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>  <span class="mi">1</span>    <span class="mf">0.204560</span>
   <span class="mi">3</span>    <span class="mf">0.567725</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">0.653177</span>
   <span class="mi">3</span>    <span class="mf">0.748907</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Việc lựa chọn có thể thực hiện từ các chỉ số cấp nhỏ hơn. Ví dụ, chúng ta có thể chọn các giá trị có chỉ số 1 ở cấp chỉ số thứ hai:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0.372762
b    0.748899
c    0.230011
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.316376</span>
<span class="n">c</span>    <span class="mf">0.964515</span>
<span class="n">d</span>    <span class="mf">0.653177</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Chỉ số phân cấp đóng một vai trò quan trọng trong việc định hình lại dữ liệu và trong các hoạt động dựa trên nhóm như tạo bảng tổng hợp. Ví dụ, bạn có thể sắp xếp lại dữ liệu này thành một DataFrame bằng phương thức <code class="docutils literal notranslate"><span class="pre">unstack</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.372762</td>
      <td>0.745619</td>
      <td>0.331739</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.748899</td>
      <td>NaN</td>
      <td>0.458633</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.230011</td>
      <td>0.688013</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>0.787755</td>
      <td>0.207612</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>
<span class="n">a</span>  <span class="mf">0.929616</span>  <span class="mf">0.316376</span>  <span class="mf">0.183919</span>
<span class="n">b</span>  <span class="mf">0.204560</span>       <span class="n">NaN</span>  <span class="mf">0.567725</span>
<span class="n">c</span>  <span class="mf">0.595545</span>  <span class="mf">0.964515</span>       <span class="n">NaN</span>
<span class="n">d</span>       <span class="n">NaN</span>  <span class="mf">0.653177</span>  <span class="mf">0.748907</span>
</pre></div>
</div>
<p>Thao tác ngược lại của <code class="docutils literal notranslate"><span class="pre">unstack</span></code> là <code class="docutils literal notranslate"><span class="pre">stack</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a  1    0.372762
   2    0.745619
   3    0.331739
b  1    0.748899
   3    0.458633
c  1    0.230011
   2    0.688013
d  2    0.787755
   3    0.207612
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>  <span class="mi">1</span>    <span class="mf">0.929616</span>
   <span class="mi">2</span>    <span class="mf">0.316376</span>
   <span class="mi">3</span>    <span class="mf">0.183919</span>
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">0.204560</span>
   <span class="mi">3</span>    <span class="mf">0.567725</span>
<span class="n">c</span>  <span class="mi">1</span>    <span class="mf">0.595545</span>
   <span class="mi">2</span>    <span class="mf">0.964515</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">0.653177</span>
   <span class="mi">3</span>    <span class="mf">0.748907</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">stack</span></code> và <code class="docutils literal notranslate"><span class="pre">unstack</span></code> sẽ được khám phá chi tiết hơn sau trong phần sắp xếp và chuyển đổi dữ liệu</p>
<p>Với một DataFrame, cả hàng và cột đều có thể có chỉ số phân cấp:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                     <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s2">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s2">&quot;Colorado&quot;</span><span class="p">],</span>
                              <span class="p">[</span><span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">Ohio</span>     <span class="n">Colorado</span>
       <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">a</span> <span class="mi">1</span>        <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
  <span class="mi">2</span>        <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="n">b</span> <span class="mi">1</span>        <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
  <span class="mi">2</span>        <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>
</pre></div>
</div>
<p>Các cấp phân cấp có thể được đặt tên tên dưới dạng chuỗi của Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
    <tr>
      <th>key1</th>
      <th>key2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>   <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span>  <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key1</span> <span class="n">key2</span>
<span class="n">a</span>    <span class="mi">1</span>       <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
     <span class="mi">2</span>       <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="n">b</span>    <span class="mi">1</span>       <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
     <span class="mi">2</span>       <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>
</pre></div>
</div>
<p>Những tên này thay thế thuộc tính <code class="docutils literal notranslate"><span class="pre">name</span></code>, vốn chỉ được sử dụng với các chỉ số chỉ có một cấp.</p>
<p><strong>Lưu ý</strong></p>
<p>Hãy cẩn thận lưu ý rằng tên chỉ số “state” và “color” là một phần của tên hàng và có thể được gọi bằng thuộc tính <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<p>Bạn có thể xem một chỉ số có bao nhiêu cấp bằng cách sử dụng thuộc tính <code class="docutils literal notranslate"><span class="pre">nlevels</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<p>Với việc truy cập một phần cột, bạn cũng có thể chọn các nhóm cột tương tự:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;Ohio&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
    </tr>
    <tr>
      <th>key1</th>
      <th>key2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">color</span>     <span class="n">Green</span>  <span class="n">Red</span>
<span class="n">key1</span> <span class="n">key2</span>
<span class="n">a</span>    <span class="mi">1</span>          <span class="mi">0</span>    <span class="mi">1</span>
     <span class="mi">2</span>          <span class="mi">3</span>    <span class="mi">4</span>
<span class="n">b</span>    <span class="mi">1</span>          <span class="mi">6</span>    <span class="mi">7</span>
     <span class="mi">2</span>          <span class="mi">9</span>   <span class="mi">10</span>
</pre></div>
</div>
<section id="sap-xep-lai-va-sap-xep-cac-cap">
<h3><span class="section-number">9.1.1. </span>Sắp xếp lại và sắp xếp các cấp<a class="headerlink" href="#sap-xep-lai-va-sap-xep-cac-cap" title="Link to this heading">#</a></h3>
<hr><p>Đôi khi chúng ta có thể cần sắp xếp lại thứ tự các cấp của chỉ số hoặc sắp xếp dữ liệu theo giá trị ở một cấp cụ thể. Phương thức <code class="docutils literal notranslate"><span class="pre">swaplevel</span></code> nhận hai số hoặc tên cấp và trả về một đối tượng mới với các cấp được hoán đổi nhưng dữ liệu không thay đổi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
    <tr>
      <th>key2</th>
      <th>key1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <th>a</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <th>b</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <th>b</th>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>   <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span>  <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key2</span> <span class="n">key1</span>
<span class="mi">1</span>    <span class="n">a</span>       <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
<span class="mi">2</span>    <span class="n">a</span>       <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="mi">1</span>    <span class="n">b</span>       <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
<span class="mi">2</span>    <span class="n">b</span>       <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sort_index</span></code> theo mặc định sắp xếp dữ liệu theo thứ tự từ điển sử dụng tất cả các cấp chỉ số, nhưng bạn có thể chọn chỉ sử dụng một cấp hoặc một tập hợp con các cấp để sắp xếp bằng cách truyền tham số <code class="docutils literal notranslate"><span class="pre">level</span></code>. Ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
    <tr>
      <th>key1</th>
      <th>key2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>b</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>a</th>
      <th>2</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <th>2</th>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>   <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span>  <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key1</span> <span class="n">key2</span>
<span class="n">a</span>    <span class="mi">1</span>       <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
<span class="n">b</span>    <span class="mi">1</span>       <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
<span class="n">a</span>    <span class="mi">2</span>       <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="n">b</span>    <span class="mi">2</span>       <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
    <tr>
      <th>key2</th>
      <th>key1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>a</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>   <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span>  <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key2</span> <span class="n">key1</span>
<span class="mi">1</span>    <span class="n">a</span>       <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
     <span class="n">b</span>       <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
<span class="mi">2</span>    <span class="n">a</span>       <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
     <span class="n">b</span>       <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>
</pre></div>
</div>
<p><strong>Lưu ý</strong></p>
<p>Hiệu suất lựa chọn dữ liệu tốt hơn nhiều trên các đối tượng có chỉ số phân cấp nếu chỉ số được sắp xếp theo thứ tự từ điển bắt đầu từ cấp ngoài cùng—nghĩa là, kết quả của việc gọi <code class="docutils literal notranslate"><span class="pre">sort_index(level=0)</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">sort_index()</span></code>.</p>
</section>
<section id="thong-ke-tom-tat-theo-cap">
<h3><span class="section-number">9.1.2. </span>Thống kê tóm tắt theo cấp<a class="headerlink" href="#thong-ke-tom-tat-theo-cap" title="Link to this heading">#</a></h3>
<hr><p>Nhiều thống kê mô tả và tóm tắt trên <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> và <code class="docutils literal notranslate"><span class="pre">Series</span></code> có một tùy chọn <code class="docutils literal notranslate"><span class="pre">level</span></code> trong đó bạn có thể chỉ định cấp bạn muốn tổng hợp theo trên một hàng hay một cột. Hãy xem xét <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ở trên; chúng ta có thể tổng hợp theo cấp trên hàng hoặc cột, như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;key2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>state</th>
      <th colspan="2" halign="left">Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
      <th>Green</th>
    </tr>
    <tr>
      <th>key2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>14</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>  <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span> <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key2</span>
<span class="mi">1</span>         <span class="mi">6</span>   <span class="mi">8</span>       <span class="mi">10</span>
<span class="mi">2</span>        <span class="mi">12</span>  <span class="mi">14</span>       <span class="mi">16</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>Green</th>
      <th>Red</th>
    </tr>
    <tr>
      <th>key1</th>
      <th>key2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>14</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">color</span>     <span class="n">Green</span>  <span class="n">Red</span>
<span class="n">key1</span> <span class="n">key2</span>
<span class="n">a</span>    <span class="mi">1</span>          <span class="mi">2</span>    <span class="mi">1</span>
     <span class="mi">2</span>          <span class="mi">8</span>    <span class="mi">4</span>
<span class="n">b</span>    <span class="mi">1</span>         <span class="mi">14</span>    <span class="mi">7</span>
     <span class="mi">2</span>         <span class="mi">20</span>   <span class="mi">10</span>
</pre></div>
</div>
<p>Chúng ta sẽ thảo luận chi tiết hơn về <code class="docutils literal notranslate"><span class="pre">groupby</span></code> sau trong phần tổng hợp dữ liệu.</p>
</section>
<section id="tao-chi-so-bang-cac-cot-cua-dataframe">
<h3><span class="section-number">9.1.3. </span>Tạo chỉ số bằng các cột của dataFrame<a class="headerlink" href="#tao-chi-so-bang-cac-cot-cua-dataframe" title="Link to this heading">#</a></h3>
<hr><p>Trong nhiều trường hợp, chúng ta có thể sử dụng một hoặc nhiều cột từ DataFrame làm chỉ số và ngược lại, bạn có thể muốn chuyển chỉ số vào các cột của DataFrame. Ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>7</td>
      <td>one</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>6</td>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>5</td>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>two</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3</td>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>2</td>
      <td>two</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>1</td>
      <td>two</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">a</span>  <span class="n">b</span>    <span class="n">c</span>  <span class="n">d</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">7</span>  <span class="n">one</span>  <span class="mi">0</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">6</span>  <span class="n">one</span>  <span class="mi">1</span>
<span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="n">one</span>  <span class="mi">2</span>
<span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="n">two</span>  <span class="mi">0</span>
<span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="n">two</span>  <span class="mi">1</span>
<span class="mi">5</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="n">two</span>  <span class="mi">2</span>
<span class="mi">6</span>  <span class="mi">6</span>  <span class="mi">1</span>  <span class="n">two</span>  <span class="mi">3</span>
</pre></div>
</div>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">set_index</span></code> của DataFrame sẽ tạo một DataFrame mới sử dụng một hoặc nhiều cột làm chỉ số:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame2</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
    <tr>
      <th>c</th>
      <th>d</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">one</th>
      <th>0</th>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">two</th>
      <th>0</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">a</span>  <span class="n">b</span>
<span class="n">c</span>   <span class="n">d</span>
<span class="n">one</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">7</span>
    <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">6</span>
    <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">5</span>
<span class="n">two</span> <span class="mi">0</span>  <span class="mi">3</span>  <span class="mi">4</span>
    <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">3</span>
    <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">2</span>
    <span class="mi">3</span>  <span class="mi">6</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>Theo mặc định, các cột được loại bỏ khỏi DataFrame, mặc dù chúng ta có thể giữ chúng lại bằng cách truyền <code class="docutils literal notranslate"><span class="pre">drop=False</span></code> cho <code class="docutils literal notranslate"><span class="pre">set_index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
    <tr>
      <th>c</th>
      <th>d</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">one</th>
      <th>0</th>
      <td>0</td>
      <td>7</td>
      <td>one</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>6</td>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>5</td>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">two</th>
      <th>0</th>
      <td>3</td>
      <td>4</td>
      <td>two</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>2</td>
      <td>two</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>1</td>
      <td>two</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">a</span>  <span class="n">b</span>    <span class="n">c</span>  <span class="n">d</span>
<span class="n">c</span>   <span class="n">d</span>
<span class="n">one</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">7</span>  <span class="n">one</span>  <span class="mi">0</span>
    <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">6</span>  <span class="n">one</span>  <span class="mi">1</span>
    <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="n">one</span>  <span class="mi">2</span>
<span class="n">two</span> <span class="mi">0</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="n">two</span>  <span class="mi">0</span>
    <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="n">two</span>  <span class="mi">1</span>
    <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="n">two</span>  <span class="mi">2</span>
    <span class="mi">3</span>  <span class="mi">6</span>  <span class="mi">1</span>  <span class="n">two</span>  <span class="mi">3</span>
</pre></div>
</div>
<p>Phương thức <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>, mặt khác, thực hiện ngược lại với <code class="docutils literal notranslate"><span class="pre">set_index</span></code>; các phân cấp chỉ số được chuyển vào các cột:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c</th>
      <th>d</th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">c</span>  <span class="n">d</span>  <span class="n">a</span>  <span class="n">b</span>
<span class="mi">0</span>  <span class="n">one</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">7</span>
<span class="mi">1</span>  <span class="n">one</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">6</span>
<span class="mi">2</span>  <span class="n">one</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">5</span>
<span class="mi">3</span>  <span class="n">two</span>  <span class="mi">0</span>  <span class="mi">3</span>  <span class="mi">4</span>
<span class="mi">4</span>  <span class="n">two</span>  <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">3</span>
<span class="mi">5</span>  <span class="n">two</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">2</span>
<span class="mi">6</span>  <span class="n">two</span>  <span class="mi">3</span>  <span class="mi">6</span>  <span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="ket-hop-cac-tap-du-lieu">
<h2><span class="section-number">9.2. </span>Kết hợp các tập dữ liệu<a class="headerlink" href="#ket-hop-cac-tap-du-lieu" title="Link to this heading">#</a></h2>
<hr><p>Trong quá trình phân tích và xử lý dữ liệu, nhu cầu kết hợp nhiều nguồn dữ liệu khác nhau là rất phổ biến. Thư viện <strong>pandas</strong> cung cấp một số phương pháp linh hoạt và hiệu quả để kết hợp dữ liệu được lưu trữ trong các đối tượng <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Cụ thể, ba phương pháp thường được sử dụng bao gồm:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code></strong><br />
Phương pháp này cho phép kết nối các hàng giữa hai hoặc nhiều <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> dựa trên một hoặc nhiều khóa chung. Cách tiếp cận này tương tự với các thao tác <em>join</em> trong ngôn ngữ truy vấn SQL và thường được sử dụng trong các hệ quản trị cơ sở dữ liệu quan hệ.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code></strong>
Được sử dụng để ghép nối các đối tượng dọc theo một trục xác định (theo hàng hoặc theo cột). Phương pháp này thích hợp trong các tình huống cần kết hợp dữ liệu có cùng cấu trúc.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">combine_first</span></code></strong>
Dùng để kết hợp hai đối tượng có cấu trúc tương tự, trong đó các giá trị bị thiếu (<em>missing values</em>) trong một đối tượng sẽ được điền bởi các giá trị tương ứng từ đối tượng còn lại. Đây là phương pháp hữu ích trong việc làm sạch và bổ sung dữ liệu.</p></li>
</ul>
<p>Trong các phần tiếp theo, chúng ta sẽ trình bày chi tiết từng phương pháp trên kèm theo ví dụ minh họa cụ thể. Những phương pháp này cũng sẽ được sử dụng xuyên suốt các chương còn lại của cuốn sách để giải quyết các tình huống thực tiễn trong phân tích dữ liệu.</p>
<section id="cac-phep-gop-va-noi-du-lieu">
<h3><span class="section-number">9.2.1. </span>Các phép gộp và nối dữ liệu<a class="headerlink" href="#cac-phep-gop-va-noi-du-lieu" title="Link to this heading">#</a></h3>
<hr><p>Các hoạt động <strong>gộp (merge)</strong> hoặc <strong>nối (join)</strong> cho phép kết hợp nhiều tập dữ liệu lại với nhau bằng cách liên kết các hàng dựa trên một hoặc nhiều khóa chung. Đây là các thao tác cốt lõi trong phân tích dữ liệu, đặc biệt quan trọng trong ngữ cảnh của các hệ quản trị cơ sở dữ liệu quan hệ, chẳng hạn như các hệ thống dựa trên SQL.</p>
<p>Trong thư viện <strong>pandas</strong>, hàm <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> là công cụ chính để thực hiện các thao tác gộp dữ liệu, triển khai các thuật toán tương tự như các phép <em>join</em> trong SQL, bao gồm <code class="docutils literal notranslate"><span class="pre">inner</span></code>, <code class="docutils literal notranslate"><span class="pre">outer</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code>, và <code class="docutils literal notranslate"><span class="pre">right</span> <span class="pre">join</span></code>.</p>
<p>Hãy bắt đầu với một ví dụ đơn giản:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;data1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;data2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>b</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data1</span>
<span class="mi">0</span>   <span class="n">b</span>      <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>
<span class="mi">3</span>   <span class="n">c</span>      <span class="mi">3</span>
<span class="mi">4</span>   <span class="n">a</span>      <span class="mi">4</span>
<span class="mi">5</span>   <span class="n">a</span>      <span class="mi">5</span>
<span class="mi">6</span>   <span class="n">b</span>      <span class="mi">6</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">d</span>      <span class="mi">2</span>
</pre></div>
</div>
<p>Đây là một ví dụ minh họa cho phép nối <strong>nhiều–một</strong> (<em>many-to-one</em>), trong đó dữ liệu trong <code class="docutils literal notranslate"><span class="pre">df1</span></code> chứa nhiều hàng có cùng tên, chẳng hạn như <code class="docutils literal notranslate"><span class="pre">'a'</span></code> và <code class="docutils literal notranslate"><span class="pre">'b'</span></code>, trong khi <code class="docutils literal notranslate"><span class="pre">df2</span></code> chỉ chứa một hàng tương ứng cho mỗi giá trị trong cột <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<p>Khi gọi hàm <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> để kết hợp hai bảng dữ liệu này, các hàng trong <code class="docutils literal notranslate"><span class="pre">df1</span></code> sẽ được ghép nối với các hàng phù hợp trong <code class="docutils literal notranslate"><span class="pre">df2</span></code> dựa trên giá trị khóa. Kết quả thu được là một dữ liệu mới, trong đó mỗi hàng của <code class="docutils literal notranslate"><span class="pre">df1</span></code> được bổ sung thông tin từ <code class="docutils literal notranslate"><span class="pre">df2</span></code> theo cách tương ứng với cấu trúc nhiều–một.</p>
<p>Cụ thể, ta thực hiện như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>b</td>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data1</span>  <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">b</span>      <span class="mi">0</span>      <span class="mi">1</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">b</span>      <span class="mi">6</span>      <span class="mi">1</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">2</span>      <span class="mi">0</span>
<span class="mi">4</span>   <span class="n">a</span>      <span class="mi">4</span>      <span class="mi">0</span>
<span class="mi">5</span>   <span class="n">a</span>      <span class="mi">5</span>      <span class="mi">0</span>
</pre></div>
</div>
<p>Trong câu lệnh ở trên, chúng ta không chỉ định cột nào để join. Nếu thông tin đó không được chỉ định, <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> sử dụng các tên cột giống nhau làm khóa. Tuy nhiên, chúng tôi khuyến khích bạn đọc nên chỉ định rõ ràng tên cột dùng để join.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>b</td>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data1</span>  <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">b</span>      <span class="mi">0</span>      <span class="mi">1</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">b</span>      <span class="mi">6</span>      <span class="mi">1</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">2</span>      <span class="mi">0</span>
<span class="mi">4</span>   <span class="n">a</span>      <span class="mi">4</span>      <span class="mi">0</span>
<span class="mi">5</span>   <span class="n">a</span>      <span class="mi">5</span>      <span class="mi">0</span>
</pre></div>
</div>
<p>Nói chung, thứ tự của các cột trong dữ liệu đầu ra từ <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> là không xác định. Nếu tên cột khác nhau trong mỗi đối tượng, chúng ta có thể chỉ định. Theo mặc định, <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> thực hiện phép join trong (<code class="docutils literal notranslate"><span class="pre">inner</span></code>). Các tùy chọn khả thi khác là <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>, và <code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code>. Phép join ngoài (<code class="docutils literal notranslate"><span class="pre">outer</span> <span class="pre">join</span></code>) lấy hợp của các khóa, kết hợp hiệu ứng của việc áp dụng cả phép join trái và phải:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>b</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>c</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>7</th>
      <td>d</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span> <span class="n">data1</span> <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">b</span>     <span class="mi">0</span>     <span class="mi">1</span>
<span class="mi">1</span>   <span class="n">b</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">b</span>     <span class="mi">6</span>     <span class="mi">1</span>
<span class="mi">3</span>   <span class="n">a</span>     <span class="mi">2</span>     <span class="mi">0</span>
<span class="mi">4</span>   <span class="n">a</span>     <span class="mi">4</span>     <span class="mi">0</span>
<span class="mi">5</span>   <span class="n">a</span>     <span class="mi">5</span>     <span class="mi">0</span>
<span class="mi">6</span>   <span class="n">c</span>     <span class="mi">3</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="mi">7</span>   <span class="n">d</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">2</span>
</pre></div>
</div>
<p>Trong phép join ngoài, các hàng từ đối tượng DataFrame bên trái hoặc bên phải không khớp khóa trong DataFrame kia sẽ xuất hiện với giá trị <code class="docutils literal notranslate"><span class="pre">NA</span></code> trong các cột của DataFrame kia cho các hàng không khớp.</p>
<p>Xem Bảng … để biết tóm tắt các tùy chọn cho <code class="docutils literal notranslate"><span class="pre">how</span></code>.</p>
<p><strong>Bảng … Các loại join khác nhau với đối số <code class="docutils literal notranslate"><span class="pre">how</span></code></strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tùy chọn</p></th>
<th class="head"><p>Hành vi</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">how=&quot;inner&quot;</span></code></p></td>
<td><p>Chỉ sử dụng các tổ hợp khóa được quan sát thấy trong cả hai bảng</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">how=&quot;left&quot;</span></code></p></td>
<td><p>Sử dụng tất cả các tổ hợp khóa được tìm thấy trong bảng bên trái</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">how=&quot;right&quot;</span></code></p></td>
<td><p>Sử dụng tất cả các tổ hợp khóa được tìm thấy trong bảng bên phải</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">how=&quot;outer&quot;</span></code></p></td>
<td><p>Sử dụng tất cả các tổ hợp khóa được quan sát thấy trong cả hai bảng cùng nhau</p></td>
</tr>
</tbody>
</table>
</div>
<p>Các phép gộp nhiều-nhiều (many-to-many) tạo thành tích Descartes (Cartesian product) của các khóa khớp. Đây là một ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;data1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;data2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>b</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data1</span>
<span class="mi">0</span>   <span class="n">b</span>      <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>
<span class="mi">3</span>   <span class="n">c</span>      <span class="mi">3</span>
<span class="mi">4</span>   <span class="n">a</span>      <span class="mi">4</span>
<span class="mi">5</span>   <span class="n">b</span>      <span class="mi">5</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>d</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>
<span class="mi">3</span>   <span class="n">b</span>      <span class="mi">3</span>
<span class="mi">4</span>   <span class="n">d</span>      <span class="mi">4</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>c</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>7</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>a</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>b</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>b</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">key</span>  <span class="n">data1</span> <span class="n">data2</span>
<span class="mi">0</span>    <span class="n">b</span>      <span class="mi">0</span>     <span class="mi">1</span>
<span class="mi">1</span>    <span class="n">b</span>      <span class="mi">0</span>     <span class="mi">3</span>
<span class="mi">2</span>    <span class="n">b</span>      <span class="mi">1</span>     <span class="mi">1</span>
<span class="mi">3</span>    <span class="n">b</span>      <span class="mi">1</span>     <span class="mi">3</span>
<span class="mi">4</span>    <span class="n">a</span>      <span class="mi">2</span>     <span class="mi">0</span>
<span class="mi">5</span>    <span class="n">a</span>      <span class="mi">2</span>     <span class="mi">2</span>
<span class="mi">6</span>    <span class="n">c</span>      <span class="mi">3</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="mi">7</span>    <span class="n">a</span>      <span class="mi">4</span>     <span class="mi">0</span>
<span class="mi">8</span>    <span class="n">a</span>      <span class="mi">4</span>     <span class="mi">2</span>
<span class="mi">9</span>    <span class="n">b</span>      <span class="mi">5</span>     <span class="mi">1</span>
<span class="mi">10</span>   <span class="n">b</span>      <span class="mi">5</span>     <span class="mi">3</span>
</pre></div>
</div>
<p>Vì có ba hàng “b” trong DataFrame bên trái và hai hàng trong DataFrame bên phải, nên có sáu hàng “b” trong kết quả. Phương thức join được truyền cho đối số từ khóa <code class="docutils literal notranslate"><span class="pre">how</span></code> chỉ ảnh hưởng đến các giá trị khóa riêng biệt xuất hiện trong kết quả:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>a</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>b</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>b</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">data1</span>  <span class="n">data2</span>
<span class="mi">0</span>   <span class="n">b</span>      <span class="mi">0</span>      <span class="mi">1</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">0</span>      <span class="mi">3</span>
<span class="mi">2</span>   <span class="n">b</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="mi">3</span>   <span class="n">b</span>      <span class="mi">1</span>      <span class="mi">3</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">5</span>      <span class="mi">1</span>
<span class="mi">5</span>   <span class="n">b</span>      <span class="mi">5</span>      <span class="mi">3</span>
<span class="mi">6</span>   <span class="n">a</span>      <span class="mi">2</span>      <span class="mi">0</span>
<span class="mi">7</span>   <span class="n">a</span>      <span class="mi">2</span>      <span class="mi">2</span>
<span class="mi">8</span>   <span class="n">a</span>      <span class="mi">4</span>      <span class="mi">0</span>
<span class="mi">9</span>   <span class="n">a</span>      <span class="mi">4</span>      <span class="mi">2</span>
</pre></div>
</div>
<p>Để gộp với nhiều khóa, hãy truyền một danh sách tên cột:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">],</span>
                     <span class="s2">&quot;lval&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;Int64&#39;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">],</span>
                      <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">],</span>
                      <span class="s2">&quot;rval&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;Int64&#39;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>two</td>
      <td>&lt;NA&gt;</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>foo</td>
      <td>two</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2</span> <span class="n">lval</span> <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>  <span class="n">one</span>    <span class="mi">1</span>    <span class="mi">4</span>
<span class="mi">1</span>  <span class="n">foo</span>  <span class="n">one</span>    <span class="mi">1</span>    <span class="mi">5</span>
<span class="mi">2</span>  <span class="n">foo</span>  <span class="n">two</span>    <span class="mi">2</span> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="mi">3</span>  <span class="n">bar</span>  <span class="n">one</span>    <span class="mi">3</span>    <span class="mi">6</span>
<span class="mi">4</span>  <span class="n">bar</span>  <span class="n">two</span> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>    <span class="mi">7</span>
</pre></div>
</div>
<p>Để xác định tổ hợp khóa nào sẽ xuất hiện trong kết quả tùy thuộc vào lựa chọn phương thức gộp, hãy coi nhiều khóa như tạo thành một mảng các tuple được sử dụng làm một khóa join duy nhất.</p>
<p><strong>Lưu ý</strong></p>
<p>Khi bạn join cột với cột, các chỉ số trên các đối tượng DataFrame được truyền vào sẽ bị loại bỏ. Nếu bạn cần giữ lại các giá trị chỉ số, bạn có thể sử dụng <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> để nối chỉ mục vào các cột.</p>
<p>Một vấn đề cũng cần xem xét trong các hoạt động kết hợp dữ liệu là việc xử lý các tên cột giống nhau trong 2 dữ liệu. Ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2_x</th>
      <th>lval</th>
      <th>key2_y</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>2</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>2</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>one</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>two</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2_x</span>  <span class="n">lval</span> <span class="n">key2_y</span>  <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>    <span class="n">one</span>     <span class="mi">1</span>    <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">1</span>  <span class="n">foo</span>    <span class="n">one</span>     <span class="mi">1</span>    <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">2</span>  <span class="n">foo</span>    <span class="n">two</span>     <span class="mi">2</span>    <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">3</span>  <span class="n">foo</span>    <span class="n">two</span>     <span class="mi">2</span>    <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">4</span>  <span class="n">bar</span>    <span class="n">one</span>     <span class="mi">3</span>    <span class="n">one</span>     <span class="mi">6</span>
<span class="mi">5</span>  <span class="n">bar</span>    <span class="n">one</span>     <span class="mi">3</span>    <span class="n">two</span>     <span class="mi">7</span>
</pre></div>
</div>
<p>Bạn đọc có thể sử dụng tham số <code class="docutils literal notranslate"><span class="pre">suffixes</span></code> để chỉ định các chuỗi được nối vào các tên chồng chéo trong các đối tượng DataFrame bên trái và bên phải:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_left&quot;</span><span class="p">,</span> <span class="s2">&quot;_right&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2_left</th>
      <th>lval</th>
      <th>key2_right</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>2</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>2</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>one</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>two</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2_left</span>  <span class="n">lval</span> <span class="n">key2_right</span>  <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>       <span class="n">one</span>     <span class="mi">1</span>        <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">1</span>  <span class="n">foo</span>       <span class="n">one</span>     <span class="mi">1</span>        <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">2</span>  <span class="n">foo</span>       <span class="n">two</span>     <span class="mi">2</span>        <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">3</span>  <span class="n">foo</span>       <span class="n">two</span>     <span class="mi">2</span>        <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">4</span>  <span class="n">bar</span>       <span class="n">one</span>     <span class="mi">3</span>        <span class="n">one</span>     <span class="mi">6</span>
<span class="mi">5</span>  <span class="n">bar</span>       <span class="n">one</span>     <span class="mi">3</span>        <span class="n">two</span>     <span class="mi">7</span>
</pre></div>
</div>
<p>Xem Bảng … để tham khảo các tham số của hàm <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code>. Phần tiếp theo bao gồm việc join bằng chỉ số hàng của DataFrame.</p>
<p><strong>Bảng ….: Các tham số của hàm <code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code></strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Đối số</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left</span></code></p></td>
<td><p>DataFrame được gộp ở phía bên trái.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right</span></code></p></td>
<td><p>DataFrame được gộp ở phía bên phải.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p></td>
<td><p>Loại join để áp dụng: một trong số <code class="docutils literal notranslate"><span class="pre">&quot;inner&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code>, hoặc <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>; mặc định là <code class="docutils literal notranslate"><span class="pre">&quot;inner&quot;</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></td>
<td><p>Tên cột để join. Phải được tìm thấy trong cả hai đối tượng DataFrame. Nếu không được chỉ định và không có khóa join nào khác được cung cấp, sẽ sử dụng giao điểm của các tên cột trong <code class="docutils literal notranslate"><span class="pre">left</span></code> và <code class="docutils literal notranslate"><span class="pre">right</span></code> làm khóa join.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code></p></td>
<td><p>Các cột trong DataFrame <code class="docutils literal notranslate"><span class="pre">left</span></code> để sử dụng làm khóa join. Có thể là một tên cột duy nhất hoặc một danh sách các tên cột.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right_on</span></code></p></td>
<td><p>Tương tự như <code class="docutils literal notranslate"><span class="pre">left_on</span></code> cho DataFrame <code class="docutils literal notranslate"><span class="pre">right</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left_index</span></code></p></td>
<td><p>Sử dụng chỉ mục hàng trong <code class="docutils literal notranslate"><span class="pre">left</span></code> làm khóa join của nó (hoặc các khóa, nếu là <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right_index</span></code></p></td>
<td><p>Tương tự như <code class="docutils literal notranslate"><span class="pre">left_index</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sort</span></code></p></td>
<td><p>Sắp xếp dữ liệu đã gộp theo thứ tự từ điển bằng các khóa join; <code class="docutils literal notranslate"><span class="pre">False</span></code> theo mặc định.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">suffixes</span></code></p></td>
<td><p>Tuple các giá trị chuỗi để nối vào tên cột trong trường hợp chồng chéo; mặc định là <code class="docutils literal notranslate"><span class="pre">(&quot;_x&quot;,</span> <span class="pre">&quot;_y&quot;)</span></code> (ví dụ: nếu “data” có trong cả hai đối tượng DataFrame, sẽ xuất hiện dưới dạng “data_x” và “data_y” trong kết quả).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">copy</span></code></p></td>
<td><p>Nếu <code class="docutils literal notranslate"><span class="pre">False</span></code>, tránh sao chép dữ liệu vào cấu trúc dữ liệu kết quả trong một số trường hợp ngoại lệ; theo mặc định luôn sao chép.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">validate</span></code></p></td>
<td><p>Xác minh xem phép gộp có thuộc loại được chỉ định hay không, cho dù là một-một, một-nhiều, hay nhiều-nhiều. Xem docstring để biết chi tiết đầy đủ về các tùy chọn.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">indicator</span></code></p></td>
<td><p>Thêm một cột đặc biệt <code class="docutils literal notranslate"><span class="pre">_merge</span></code> chỉ ra nguồn của mỗi hàng; các giá trị sẽ là <code class="docutils literal notranslate"><span class="pre">&quot;left_only&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;right_only&quot;</span></code>, hoặc <code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> dựa trên nguồn gốc của dữ liệu được join trong mỗi hàng.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ket-hop-du-lieu-dua-tren-chi-so">
<h3><span class="section-number">9.2.2. </span>Kết hợp dữ liệu dựa trên chỉ số<a class="headerlink" href="#ket-hop-du-lieu-dua-tren-chi-so" title="Link to this heading">#</a></h3>
<hr><p>Trong một số trường hợp, các khóa trong một DataFrame sẽ được tìm thấy trong chỉ số hàng. Trong trường hợp này, bạn có thể truyền <code class="docutils literal notranslate"><span class="pre">left_index=True</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">right_index=True</span></code> (hoặc cả hai) để chỉ ra rằng chỉ số được sử dụng làm khóa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
                      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;group_val&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>c</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>
<span class="mi">5</span>   <span class="n">c</span>      <span class="mi">5</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>3.5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">group_val</span>
<span class="n">a</span>        <span class="mf">3.5</span>
<span class="n">b</span>        <span class="mf">7.0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left1</span><span class="p">,</span> <span class="n">right1</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>  <span class="n">group_val</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>        <span class="mf">3.5</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>        <span class="mf">3.5</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>        <span class="mf">3.5</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>        <span class="mf">7.0</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>        <span class="mf">7.0</span>
</pre></div>
</div>
<p><strong>Lưu ý</strong></p>
<p>Nếu bạn xem xét kỹ ví dụ trên, bạn sẽ thấy rằng các giá trị chỉ số cho <code class="docutils literal notranslate"><span class="pre">left1</span></code> đã được giữ lại, trong khi ở các ví dụ khác ở trên, các chỉ số của các đối tượng DataFrame đầu vào bị loại bỏ. Bởi vì chỉ số của <code class="docutils literal notranslate"><span class="pre">right1</span></code> là duy nhất, phép gộp “nhiều-một” này (với phương thức <code class="docutils literal notranslate"><span class="pre">how=&quot;inner&quot;</span></code> mặc định) có thể giữ lại các giá trị chỉ số từ <code class="docutils literal notranslate"><span class="pre">left1</span></code> tương ứng với các hàng trong đầu ra.</p>
<p>Vì phương thức gộp mặc định là lấy phần giao của các khóa join, bạn có thể sử dụng phép join ngoài nếu muốn lấy phần hợp của các khóa join:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left1</span><span class="p">,</span> <span class="n">right1</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>c</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>  <span class="n">group_val</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>        <span class="mf">3.5</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>        <span class="mf">3.5</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>        <span class="mf">3.5</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>        <span class="mf">7.0</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>        <span class="mf">7.0</span>
<span class="mi">5</span>   <span class="n">c</span>      <span class="mi">5</span>        <span class="n">NaN</span>
</pre></div>
</div>
</section>
<section id="noi-du-lieu-theo-mot-truc">
<h3><span class="section-number">9.2.3. </span>Nối dữ liệu theo một trục<a class="headerlink" href="#noi-du-lieu-theo-mot-truc" title="Link to this heading">#</a></h3>
<hr><p>Một loại hoạt động kết hợp dữ liệu khác được gọi thay thế cho nhau là nối dữ liệu. Hàm <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> của NumPy có thể thực hiện điều này với các mảng NumPy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arr</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3,  0,  1,  2,  3],
       [ 4,  5,  6,  7,  4,  5,  6,  7],
       [ 8,  9, 10, 11,  8,  9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>Đối với các đối tượng <code class="docutils literal notranslate"><span class="pre">pandas</span></code> như <code class="docutils literal notranslate"><span class="pre">Series</span></code> và <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, việc mỗi trục đều được gán nhãn cho phép chúng ta mở rộng khái niệm nối mảng với mảng  theo hướng tổng quát và linh hoạt hơn. Khi thao tác với các đối tượng này, một số vấn đề bổ sung cần được xem xét nhằm đảm bảo tính nhất quán và toàn vẹn của dữ liệu sau khi thực hiện phép nối:</p>
<ul class="simple">
<li><p><strong>Thứ nhất</strong>, khi các đối tượng có hệ thống chỉ số khác nhau trên trục được nối, cần quyết định liệu có nên giữ lại tất cả các chỉ số hay chỉ sử dụng phần giao nhau của chúng.</p></li>
<li><p><strong>Thứ hai</strong>, liệu các dữ liệu đầu vào có cần được bảo toàn dưới dạng riêng biệt trong đối tượng kết quả hay không, tức là có nên tạo phân vùng rõ ràng giữa các phần được nối?</p></li>
<li><p><strong>Thứ ba</strong>, trục được sử dụng để nối dữ liệu có chứa thông tin có ý nghĩa cần được bảo toàn không? Trong nhiều trường hợp thực hành, các chỉ số dạng số nguyên mặc định của <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> không mang thông tin và nên được loại bỏ trong quá trình kết hợp.</p></li>
</ul>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">concat</span></code> trong thư viện <code class="docutils literal notranslate"><span class="pre">pandas</span></code> cung cấp một cơ chế thống nhất và linh hoạt để giải quyết các câu hỏi nêu trên. Trong các phần tiếp theo, chúng ta sẽ minh họa cách thức hoạt động của <code class="docutils literal notranslate"><span class="pre">concat</span></code> thông qua các ví dụ cụ thể.</p>
<p>Giả sử chúng ta có ba đối tượng <code class="docutils literal notranslate"><span class="pre">Series</span></code> với các chỉ số không chồng chéo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Gọi <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code> với các đối tượng này trong một danh sách sẽ gắn kết các giá trị và chỉ số lại với nhau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    1
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mi">0</span>
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c    2
d    3
e    4
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span>    <span class="mi">2</span>
<span class="n">d</span>    <span class="mi">3</span>
<span class="n">e</span>    <span class="mi">4</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f    5
g    6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>    <span class="mi">5</span>
<span class="n">g</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    1
c    2
d    3
e    4
f    5
g    6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mi">0</span>
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">c</span>    <span class="mi">2</span>
<span class="n">d</span>    <span class="mi">3</span>
<span class="n">e</span>    <span class="mi">4</span>
<span class="n">f</span>    <span class="mi">5</span>
<span class="n">g</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<p>Theo mặc định, <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code> hoạt động dọc theo hàng, hay <code class="docutils literal notranslate"><span class="pre">axis=&quot;index&quot;</span></code>, để tạo ra một <code class="docutils literal notranslate"><span class="pre">Series</span></code> khác. Nếu bạn truyền <code class="docutils literal notranslate"><span class="pre">axis=&quot;columns&quot;</span></code>, kết quả sẽ là một DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>c</th>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>d</th>
      <td>&lt;NA&gt;</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>e</th>
      <td>&lt;NA&gt;</td>
      <td>4</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>f</th>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">2</span>
<span class="n">a</span>     <span class="mi">0</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">b</span>     <span class="mi">1</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">c</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">2</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">d</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">3</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">e</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">4</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">f</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">5</span>
<span class="n">g</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">6</span>
</pre></div>
</div>
<p>Trong trường hợp này, bạn đọc có thể thấy kết quả là hợp, hay phép join ngoài của các chỉ số. Thay vào đó, bạn có thể lấy phần giao của chỉ số bằng cách truyền <code class="docutils literal notranslate"><span class="pre">join=&quot;inner&quot;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    1
f    5
g    6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mi">0</span>
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">f</span>    <span class="mi">5</span>
<span class="n">g</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>f</th>
      <td>&lt;NA&gt;</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>&lt;NA&gt;</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">0</span>  <span class="mi">1</span>
<span class="n">a</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">b</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="n">f</span> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="mi">5</span>
<span class="n">g</span> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="mi">6</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">0</span>  <span class="mi">1</span>
<span class="n">a</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">b</span>  <span class="mi">1</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>Trong ví dụ cuối cùng này, các chỉ số “f” và “g” đã biến mất do tùy chọn <code class="docutils literal notranslate"><span class="pre">join=&quot;inner&quot;</span></code>.</p>
<p>Trong trường hợp kết hợp Series dọc theo <code class="docutils literal notranslate"><span class="pre">axis=&quot;columns&quot;</span></code>, các <code class="docutils literal notranslate"><span class="pre">keys</span></code> trở thành tiêu đề cột của DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>c</th>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>d</th>
      <td>&lt;NA&gt;</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>e</th>
      <td>&lt;NA&gt;</td>
      <td>4</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>f</th>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">one</span>   <span class="n">two</span> <span class="n">three</span>
<span class="n">a</span>     <span class="mi">0</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">b</span>     <span class="mi">1</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">c</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">2</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">d</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">3</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">e</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">4</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">f</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">5</span>
<span class="n">g</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>     <span class="mi">6</span>
</pre></div>
</div>
<p>Logic tương tự cho các đối tượng DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;three&quot;</span><span class="p">,</span> <span class="s2">&quot;four&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>    <span class="mi">0</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">2</span>    <span class="mi">3</span>
<span class="n">c</span>    <span class="mi">4</span>    <span class="mi">5</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">three</span>  <span class="n">four</span>
<span class="n">a</span>      <span class="mi">5</span>     <span class="mi">6</span>
<span class="n">c</span>      <span class="mi">7</span>     <span class="mi">8</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;level1&quot;</span><span class="p">,</span> <span class="s2">&quot;level2&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">level1</th>
      <th colspan="2" halign="left">level2</th>
    </tr>
    <tr>
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">level1</span>      <span class="n">level2</span>
       <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">a</span>        <span class="mi">0</span>    <span class="mi">1</span>    <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>        <span class="mi">2</span>    <span class="mi">3</span>    <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>        <span class="mi">4</span>    <span class="mi">5</span>    <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Ở đây, tham số <code class="docutils literal notranslate"><span class="pre">keys</span></code> được sử dụng để tạo một chỉ số phân cấp nơi cấp đầu tiên có thể được sử dụng để xác định từng đối tượng DataFrame được nối.</p>
<p>Nếu bạn truyền một từ điển các đối tượng thay vì một danh sách, các khóa của từ điển sẽ được sử dụng cho tùy chọn <code class="docutils literal notranslate"><span class="pre">keys</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">({</span><span class="s2">&quot;level1&quot;</span><span class="p">:</span> <span class="n">df1</span><span class="p">,</span> <span class="s2">&quot;level2&quot;</span><span class="p">:</span> <span class="n">df2</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">level1</th>
      <th colspan="2" halign="left">level2</th>
    </tr>
    <tr>
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">level1</span>      <span class="n">level2</span>
       <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">a</span>        <span class="mi">0</span>    <span class="mi">1</span>    <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>        <span class="mi">2</span>    <span class="mi">3</span>    <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>        <span class="mi">4</span>    <span class="mi">5</span>    <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Có các tham số bổ sung chi phối cách tạo chỉ số phân cấp. Ví dụ, chúng ta có thể đặt tên cho các cấp trục được tạo bằng tham số <code class="docutils literal notranslate"><span class="pre">names</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;level1&quot;</span><span class="p">,</span> <span class="s2">&quot;level2&quot;</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>upper</th>
      <th colspan="2" halign="left">level1</th>
      <th colspan="2" halign="left">level2</th>
    </tr>
    <tr>
      <th>lower</th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">upper</span> <span class="n">level1</span>      <span class="n">level2</span>
<span class="n">lower</span>    <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">a</span>          <span class="mi">0</span>    <span class="mi">1</span>    <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>          <span class="mi">2</span>    <span class="mi">3</span>    <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>          <span class="mi">4</span>    <span class="mi">5</span>    <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Một xem xét cuối cùng liên quan đến các DataFrame trong đó chỉ số hàng không chứa bất kỳ dữ liệu liên quan nào:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.829415</td>
      <td>-0.204988</td>
      <td>0.989926</td>
      <td>0.580779</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.443155</td>
      <td>0.875395</td>
      <td>-1.548317</td>
      <td>0.112107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.715309</td>
      <td>-0.105508</td>
      <td>0.710475</td>
      <td>0.495683</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">a</span>         <span class="n">b</span>         <span class="n">c</span>         <span class="n">d</span>
<span class="mi">0</span>  <span class="mf">1.248804</span>  <span class="mf">0.774191</span> <span class="o">-</span><span class="mf">0.319657</span> <span class="o">-</span><span class="mf">0.624964</span>
<span class="mi">1</span>  <span class="mf">1.078814</span>  <span class="mf">0.544647</span>  <span class="mf">0.855588</span>  <span class="mf">1.343268</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.267175</span>  <span class="mf">1.793095</span> <span class="o">-</span><span class="mf">0.652929</span> <span class="o">-</span><span class="mf">1.886837</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.480363</td>
      <td>0.039213</td>
      <td>-1.982412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.756469</td>
      <td>-0.585666</td>
      <td>0.144867</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">b</span>         <span class="n">d</span>         <span class="n">a</span>
<span class="mi">0</span>  <span class="mf">1.059626</span>  <span class="mf">0.644448</span> <span class="o">-</span><span class="mf">0.007799</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.449204</span>  <span class="mf">2.448963</span>  <span class="mf">0.667226</span>
</pre></div>
</div>
<p>Trong trường hợp này, bạn có thể truyền <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code>, thao tác này sẽ loại bỏ các chỉ số từ mỗi DataFrame và chỉ nối dữ liệu trong các cột, gán một chỉ số mặc định mới:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.829415</td>
      <td>-0.204988</td>
      <td>0.989926</td>
      <td>0.580779</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.443155</td>
      <td>0.875395</td>
      <td>-1.548317</td>
      <td>0.112107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.715309</td>
      <td>-0.105508</td>
      <td>0.710475</td>
      <td>0.495683</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.982412</td>
      <td>-1.480363</td>
      <td>NaN</td>
      <td>0.039213</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.144867</td>
      <td>-1.756469</td>
      <td>NaN</td>
      <td>-0.585666</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">a</span>         <span class="n">b</span>         <span class="n">c</span>         <span class="n">d</span>
<span class="mi">0</span>  <span class="mf">1.248804</span>  <span class="mf">0.774191</span> <span class="o">-</span><span class="mf">0.319657</span> <span class="o">-</span><span class="mf">0.624964</span>
<span class="mi">1</span>  <span class="mf">1.078814</span>  <span class="mf">0.544647</span>  <span class="mf">0.855588</span>  <span class="mf">1.343268</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.267175</span>  <span class="mf">1.793095</span> <span class="o">-</span><span class="mf">0.652929</span> <span class="o">-</span><span class="mf">1.886837</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.007799</span>  <span class="mf">1.059626</span>       <span class="n">NaN</span>  <span class="mf">0.644448</span>
<span class="mi">4</span>  <span class="mf">0.667226</span> <span class="o">-</span><span class="mf">0.449204</span>       <span class="n">NaN</span>  <span class="mf">2.448963</span>
</pre></div>
</div>
<p>Bảng … mô tả các tham số của hàm <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code>.</p>
<p><strong>Bảng … các tham số của hàm <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code></strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Đối số</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">objs</span></code></p></td>
<td><p>Danh sách hoặc từ điển các đối tượng pandas cần nối; đây là đối số bắt buộc duy nhất.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p></td>
<td><p>Trục để nối dọc theo; mặc định là nối dọc theo hàng (<code class="docutils literal notranslate"><span class="pre">axis=&quot;index&quot;</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">join</span></code></p></td>
<td><p>Hoặc <code class="docutils literal notranslate"><span class="pre">&quot;inner&quot;</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code> theo mặc định); liệu có lấy giao điểm (inner) hay hợp (outer) các chỉ số dọc theo các trục khác.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">keys</span></code></p></td>
<td><p>Các giá trị để liên kết với các đối tượng đang được nối, tạo thành một chỉ số phân cấp dọc theo trục nối; có thể là một danh sách hoặc mảng các giá trị tùy ý, một mảng các tuple, hoặc một danh sách các mảng (nếu nhiều mảng cấp được truyền vào <code class="docutils literal notranslate"><span class="pre">levels</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">names</span></code></p></td>
<td><p>Tên cho các cấp phân cấp được tạo nếu <code class="docutils literal notranslate"><span class="pre">keys</span></code> và/hoặc <code class="docutils literal notranslate"><span class="pre">levels</span></code> được truyền.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">verify_integrity</span></code></p></td>
<td><p>Kiểm tra trục mới trong đối tượng được nối xem có trùng lặp không và đưa ra một ngoại lệ nếu có; theo mặc định (<code class="docutils literal notranslate"><span class="pre">False</span></code>) cho phép trùng lặp.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span></code></p></td>
<td><p>Không bảo toàn các chỉ số dọc theo trục nối, thay vào đó tạo ra một chỉ số <code class="docutils literal notranslate"><span class="pre">range(total_length)</span></code> mới.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="dinh-hinh-lai-du-lieu-va-thay-doi-truc">
<h2><span class="section-number">9.3. </span>Định hình lại dữ liệu và thay đổi trục<a class="headerlink" href="#dinh-hinh-lai-du-lieu-va-thay-doi-truc" title="Link to this heading">#</a></h2>
<hr><p>Có một số hoạt động cơ bản để sắp xếp lại dữ liệu dạng bảng, các hoạt động này bao gồm định hình lại dữ liệu, hay reshape, hoặc và thay đổi trục hay còn gọi là pivot.</p>
<section id="dinh-hinh-lai-voi-chi-so-phan-cap">
<h3><span class="section-number">9.3.1. </span>Định hình lại với chỉ số phân cấp<a class="headerlink" href="#dinh-hinh-lai-voi-chi-so-phan-cap" title="Link to this heading">#</a></h3>
<p>Chỉ số phân cấp cung cấp một cách nhất quán để sắp xếp lại dữ liệu trong một <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Có hai thao tác chính khi định hình lại là:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stack</span></code>: thao tác này “xoay” hoặc chuyển các cột trong dữ liệu thành hàng.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unstack</span></code>: thao tác này chuyển các hàng thành cột.</p></li>
</ul>
<p>Chúng ta sẽ minh họa các thao tác này thông qua các ví dụ. Hãy xem xét một DataFrame nhỏ với các mảng chuỗi làm chỉ số hàng và cột:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                     <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s2">&quot;Colorado&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">),</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>number</th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span>    <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>
<span class="n">state</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>
<span class="n">Colorado</span>    <span class="mi">3</span>    <span class="mi">4</span>      <span class="mi">5</span>
</pre></div>
</div>
<p>Sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">stack</span></code> trên dữ liệu này sẽ xoay các cột thành hàng, tạo ra một Series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state     number
Ohio      one       0
          two       1
          three     2
Colorado  one       3
          two       4
          three     5
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>     <span class="n">number</span>
<span class="n">Ohio</span>      <span class="n">one</span>       <span class="mi">0</span>
          <span class="n">two</span>       <span class="mi">1</span>
          <span class="n">three</span>     <span class="mi">2</span>
<span class="n">Colorado</span>  <span class="n">one</span>       <span class="mi">3</span>
          <span class="n">two</span>       <span class="mi">4</span>
          <span class="n">three</span>     <span class="mi">5</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Từ một Series có chỉ số phân cấp, chúng ta có thể sắp xếp lại dữ liệu trở lại thành một DataFrame bằng <code class="docutils literal notranslate"><span class="pre">unstack</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>number</th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span>    <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>
<span class="n">state</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>
<span class="n">Colorado</span>    <span class="mi">3</span>    <span class="mi">4</span>      <span class="mi">5</span>
</pre></div>
</div>
<p>Khi sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">unstack</span></code>, dữ liệu được tạo ra có thể có dữ liệu không quan sát được nếu không phải tất cả các giá trị đều được tìm thấy trong mỗi nhóm con:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one  a    0
     b    1
     c    2
     d    3
two  c    4
     d    5
     e    6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">one</span>  <span class="n">a</span>    <span class="mi">0</span>
     <span class="n">b</span>    <span class="mi">1</span>
     <span class="n">c</span>    <span class="mi">2</span>
     <span class="n">d</span>    <span class="mi">3</span>
<span class="n">two</span>  <span class="n">c</span>    <span class="mi">4</span>
     <span class="n">d</span>    <span class="mi">5</span>
     <span class="n">e</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<p>Phương thức <code class="docutils literal notranslate"><span class="pre">stack</span></code> lọc bỏ dữ liệu không quan sát được theo mặc định, vì vậy thao tác này dễ dàng đảo ngược hơn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>two</th>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">a</span>     <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>     <span class="n">e</span>
<span class="n">one</span>    <span class="mi">0</span>     <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">two</span> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>  <span class="mi">4</span>  <span class="mi">5</span>     <span class="mi">6</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one  a    0
     b    1
     c    2
     d    3
two  c    4
     d    5
     e    6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">one</span>  <span class="n">a</span>    <span class="mi">0</span>
     <span class="n">b</span>    <span class="mi">1</span>
     <span class="n">c</span>    <span class="mi">2</span>
     <span class="n">d</span>    <span class="mi">3</span>
<span class="n">two</span>  <span class="n">c</span>    <span class="mi">4</span>
     <span class="n">d</span>    <span class="mi">5</span>
     <span class="n">e</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one  a       0
     b       1
     c       2
     d       3
     e    &lt;NA&gt;
two  a    &lt;NA&gt;
     b    &lt;NA&gt;
     c       4
     d       5
     e       6
dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">one</span>  <span class="n">a</span>       <span class="mi">0</span>
     <span class="n">b</span>       <span class="mi">1</span>
     <span class="n">c</span>       <span class="mi">2</span>
     <span class="n">d</span>       <span class="mi">3</span>
     <span class="n">e</span>    <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
<span class="n">two</span>  <span class="n">a</span>    <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
     <span class="n">b</span>    <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
     <span class="n">c</span>       <span class="mi">4</span>
     <span class="n">d</span>       <span class="mi">5</span>
     <span class="n">e</span>       <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">Int64</span>
</pre></div>
</div>
<p>Khi <code class="docutils literal notranslate"><span class="pre">unstack</span></code> trong một DataFrame, cấp được <code class="docutils literal notranslate"><span class="pre">unstack</span></code> trở thành cấp thấp nhất trong kết quả:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="n">result</span> <span class="o">+</span> <span class="mi">5</span><span class="p">},</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;side&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>side</th>
      <th>left</th>
      <th>right</th>
    </tr>
    <tr>
      <th>state</th>
      <th>number</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Ohio</th>
      <th>one</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>three</th>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Colorado</th>
      <th>one</th>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>two</th>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>three</th>
      <td>5</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">side</span>        <span class="n">left</span>  <span class="n">right</span>
<span class="n">state</span>    <span class="n">number</span>
<span class="n">Ohio</span>     <span class="n">one</span>       <span class="mi">0</span>      <span class="mi">5</span>
         <span class="n">two</span>       <span class="mi">1</span>      <span class="mi">6</span>
         <span class="n">three</span>     <span class="mi">2</span>      <span class="mi">7</span>
<span class="n">Colorado</span> <span class="n">one</span>       <span class="mi">3</span>      <span class="mi">8</span>
         <span class="n">two</span>       <span class="mi">4</span>      <span class="mi">9</span>
         <span class="n">three</span>     <span class="mi">5</span>     <span class="mi">10</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>side</th>
      <th colspan="2" halign="left">left</th>
      <th colspan="2" halign="left">right</th>
    </tr>
    <tr>
      <th>state</th>
      <th>Ohio</th>
      <th>Colorado</th>
      <th>Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>three</th>
      <td>2</td>
      <td>5</td>
      <td>7</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">side</span>   <span class="n">left</span>          <span class="n">right</span>
<span class="n">state</span>  <span class="n">Ohio</span> <span class="n">Colorado</span>  <span class="n">Ohio</span> <span class="n">Colorado</span>
<span class="n">number</span>
<span class="n">one</span>       <span class="mi">0</span>        <span class="mi">3</span>     <span class="mi">5</span>        <span class="mi">8</span>
<span class="n">two</span>       <span class="mi">1</span>        <span class="mi">4</span>     <span class="mi">6</span>        <span class="mi">9</span>
<span class="n">three</span>     <span class="mi">2</span>        <span class="mi">5</span>     <span class="mi">7</span>       <span class="mi">10</span>
</pre></div>
</div>
<p>Tương tự như <code class="docutils literal notranslate"><span class="pre">unstack</span></code>, khi gọi <code class="docutils literal notranslate"><span class="pre">stack</span></code>, chúng ta có thể chỉ định tên của trục:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;side&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>Ohio</th>
      <th>Colorado</th>
    </tr>
    <tr>
      <th>number</th>
      <th>side</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">one</th>
      <th>left</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>right</th>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">two</th>
      <th>left</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>right</th>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">three</th>
      <th>left</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>right</th>
      <td>7</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>     <span class="n">Colorado</span>  <span class="n">Ohio</span>
<span class="n">number</span> <span class="n">side</span>
<span class="n">one</span>    <span class="n">left</span>          <span class="mi">3</span>     <span class="mi">0</span>
       <span class="n">right</span>         <span class="mi">8</span>     <span class="mi">5</span>
<span class="n">two</span>    <span class="n">left</span>          <span class="mi">4</span>     <span class="mi">1</span>
       <span class="n">right</span>         <span class="mi">9</span>     <span class="mi">6</span>
<span class="n">three</span>  <span class="n">left</span>          <span class="mi">5</span>     <span class="mi">2</span>
       <span class="n">right</span>        <span class="mi">10</span>     <span class="mi">7</span>
</pre></div>
</div>
</section>
<section id="xoay-truc-tu-dinh-dang-dai-sang-rong-va-nguoc-lai">
<h3><span class="section-number">9.3.2. </span>Xoay trục từ định dạng dài sang rộng và ngược lại<a class="headerlink" href="#xoay-truc-tu-dinh-dang-dai-sang-rong-va-nguoc-lai" title="Link to this heading">#</a></h3>
<hr><p>Một cách phổ biến để lưu trữ nhiều chuỗi thời gian trong cùng một dữ liệu định dạng đôi khi được gọi là định dạng dài. Trong định dạng này, các giá trị riêng lẻ được biểu thị bằng một hàng duy nhất trong bảng thay vì nhiều giá trị trên mỗi hàng.</p>
<p>Hãy quan sát dữ liệu thường được định dạng kiểu dài như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/macrodata.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">,</span> <span class="s2">&quot;realgdp&quot;</span><span class="p">,</span> <span class="s2">&quot;infl&quot;</span><span class="p">,</span> <span class="s2">&quot;unemp&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>quarter</th>
      <th>realgdp</th>
      <th>infl</th>
      <th>unemp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1959</td>
      <td>1</td>
      <td>2710.349</td>
      <td>0.00</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1959</td>
      <td>2</td>
      <td>2778.801</td>
      <td>2.34</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1959</td>
      <td>3</td>
      <td>2775.488</td>
      <td>2.74</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1959</td>
      <td>4</td>
      <td>2785.204</td>
      <td>0.27</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1960</td>
      <td>1</td>
      <td>2847.699</td>
      <td>2.31</td>
      <td>5.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">year</span>  <span class="n">quarter</span>   <span class="n">realgdp</span>  <span class="n">infl</span>  <span class="n">unemp</span>
<span class="mi">0</span>  <span class="mi">1959</span>        <span class="mi">1</span>  <span class="mf">2710.349</span>  <span class="mf">0.00</span>    <span class="mf">5.8</span>
<span class="mi">1</span>  <span class="mi">1959</span>        <span class="mi">2</span>  <span class="mf">2778.801</span>  <span class="mf">2.34</span>    <span class="mf">5.1</span>
<span class="mi">2</span>  <span class="mi">1959</span>        <span class="mi">3</span>  <span class="mf">2775.488</span>  <span class="mf">2.74</span>    <span class="mf">5.3</span>
<span class="mi">3</span>  <span class="mi">1959</span>        <span class="mi">4</span>  <span class="mf">2785.204</span>  <span class="mf">0.27</span>    <span class="mf">5.6</span>
<span class="mi">4</span>  <span class="mi">1960</span>        <span class="mi">1</span>  <span class="mf">2847.699</span>  <span class="mf">2.31</span>    <span class="mf">5.2</span>
</pre></div>
</div>
<p>Chúng ta sử dụng <code class="docutils literal notranslate"><span class="pre">pandas.PeriodIndex</span></code> để kết hợp các cột <code class="docutils literal notranslate"><span class="pre">year</span></code> và <code class="docutils literal notranslate"><span class="pre">quarter</span></code> nhằm đặt chỉ mục bao gồm các giá trị datetime vào cuối mỗi quý:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span>
                         <span class="n">quarter</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;quarter&quot;</span><span class="p">),</span>
                         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PeriodIndex([&#39;1959Q1&#39;, &#39;1959Q2&#39;, &#39;1959Q3&#39;, &#39;1959Q4&#39;, &#39;1960Q1&#39;, &#39;2008Q3&#39;,
             &#39;2008Q4&#39;, &#39;2009Q1&#39;, &#39;2009Q2&#39;, &#39;2009Q3&#39;],
            dtype=&#39;period[Q-DEC]&#39;, name=&#39;date&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">periods</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>realgdp</th>
      <th>infl</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>2710.349</td>
      <td>0.00</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2778.801</td>
      <td>2.34</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2775.488</td>
      <td>2.74</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>2785.204</td>
      <td>0.27</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2847.699</td>
      <td>2.31</td>
      <td>5.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">realgdp</span>  <span class="n">infl</span>  <span class="n">unemp</span>
<span class="n">date</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2710.349</span>  <span class="mf">0.00</span>    <span class="mf">5.8</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2778.801</span>  <span class="mf">2.34</span>    <span class="mf">5.1</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2775.488</span>  <span class="mf">2.74</span>    <span class="mf">5.3</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2785.204</span>  <span class="mf">0.27</span>    <span class="mf">5.6</span>
<span class="mi">1960</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2847.699</span>  <span class="mf">2.31</span>    <span class="mf">5.2</span>
</pre></div>
</div>
<p>Chúng ta đã sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">pop</span></code> trên DataFrame, phương thức này trả về một cột đồng thời xóa nó khỏi DataFrame.</p>
<p>Sau đó, chúng ta chọn một tập hợp con các cột và đặt tên cho chỉ số cột là <code class="docutils literal notranslate"><span class="pre">&quot;item&quot;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;realgdp&quot;</span><span class="p">,</span> <span class="s2">&quot;infl&quot;</span><span class="p">,</span> <span class="s2">&quot;unemp&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;item&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>item</th>
      <th>realgdp</th>
      <th>infl</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>2710.349</td>
      <td>0.00</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2778.801</td>
      <td>2.34</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2775.488</td>
      <td>2.74</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>2785.204</td>
      <td>0.27</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2847.699</td>
      <td>2.31</td>
      <td>5.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">item</span>        <span class="n">realgdp</span>  <span class="n">infl</span>  <span class="n">unemp</span>
<span class="n">date</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2710.349</span>  <span class="mf">0.00</span>    <span class="mf">5.8</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2778.801</span>  <span class="mf">2.34</span>    <span class="mf">5.1</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2775.488</span>  <span class="mf">2.74</span>    <span class="mf">5.3</span>
<span class="mi">1959</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2785.204</span>  <span class="mf">0.27</span>    <span class="mf">5.6</span>
</pre></div>
</div>
<p>Cuối cùng, dữ liệu được định dạng lại bằng phương thức <code class="docutils literal notranslate"><span class="pre">stack</span></code>, trong đó các cột bên trong được chuyển thành một cấp chỉ số mới. Tiếp theo, phương thức <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> được sử dụng để đưa hệ chỉ số phân cấp này trở lại dạng cột thông thường. Cột chứa giá trị dữ liệu sau đó được đặt tên rõ ràng là <code class="docutils literal notranslate"><span class="pre">&quot;value&quot;</span></code> nhằm đảm bảo tính minh bạch và nhất quán trong xử lý dữ liệu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
             <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
             <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">}))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>item</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1959-01-01</td>
      <td>realgdp</td>
      <td>2710.349</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1959-01-01</td>
      <td>infl</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1959-01-01</td>
      <td>unemp</td>
      <td>5.800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1959-04-01</td>
      <td>realgdp</td>
      <td>2778.801</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1959-04-01</td>
      <td>infl</td>
      <td>2.340</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1959-04-01</td>
      <td>unemp</td>
      <td>5.100</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1959-07-01</td>
      <td>realgdp</td>
      <td>2775.488</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1959-07-01</td>
      <td>infl</td>
      <td>2.740</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1959-07-01</td>
      <td>unemp</td>
      <td>5.300</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1959-10-01</td>
      <td>realgdp</td>
      <td>2785.204</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Trong định dạng <code class="docutils literal notranslate"><span class="pre">long</span></code> dành cho dữ liệu chuỗi thời gian đa biến, mỗi hàng trong bảng biểu thị một quan sát duy nhất.</p>
<p>Dữ liệu thường được lưu trữ theo cách này trong các cơ sở dữ liệu quan hệ sử dụng SQL, vì lược đồ cố định (bao gồm tên cột và kiểu dữ liệu) cho phép số lượng giá trị phân biệt trong cột “item” có thể thay đổi linh hoạt khi dữ liệu mới được thêm vào bảng. Trong ví dụ trước, các cột <code class="docutils literal notranslate"><span class="pre">date</span></code> và <code class="docutils literal notranslate"><span class="pre">item</span></code> thường được sử dụng làm <strong>khóa chính</strong> (theo thuật ngữ của cơ sở dữ liệu quan hệ), nhằm đảm bảo tính toàn vẹn quan hệ và hỗ trợ các thao tác nối bảng (join) một cách hiệu quả.</p>
<p>Tuy nhiên, trong một số trường hợp, việc thao tác với dữ liệu ở định dạng này có thể kém trực quan hoặc khó xử lý hơn. Khi đó, bạn có thể muốn chuyển dữ liệu sang định dạng bảng rộng (<em>wide format</em>), trong đó mỗi mục (<code class="docutils literal notranslate"><span class="pre">item</span></code>) sẽ trở thành một cột riêng, và bảng được lập chỉ số theo thời gian (<code class="docutils literal notranslate"><span class="pre">date</span></code>). Phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code> của <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> trong Pandas cho phép thực hiện chính xác quá trình chuyển đổi này.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivoted</span> <span class="o">=</span> <span class="n">long_data</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;item&quot;</span><span class="p">,</span>
                           <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivoted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>item</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>0.00</td>
      <td>2710.349</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2.34</td>
      <td>2778.801</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2.74</td>
      <td>2775.488</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>0.27</td>
      <td>2785.204</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2.31</td>
      <td>2847.699</td>
      <td>5.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hai tham số đầu tiên được truyền vào phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code> lần lượt xác định các cột sẽ được sử dụng làm chỉ số hàng (<em>row index</em>) và chỉ số cột (<em>column index</em>). Tham số thứ ba, không bắt buộc, xác định cột chứa giá trị sẽ được sử dụng để lấp đầy bảng <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> sau khi chuyển đổi.</p>
<p>Giả sử bạn có hai cột giá trị riêng biệt và mong muốn thay đổi cấu trúc của chúng đồng thời (tức là chuyển đổi từ định dạng “long” sang “wide” cho nhiều cột cùng lúc). Trong trường hợp này, <code class="docutils literal notranslate"><span class="pre">pivot</span></code> không thể trực tiếp xử lý nhiều cột giá trị trong một lệnh duy nhất. Bạn sẽ cần thực hiện thao tác này bằng cách sử dụng các phương thức khác như <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code>, hoặc áp dụng <code class="docutils literal notranslate"><span class="pre">pivot</span></code> cho từng cột một, sau đó kết hợp kết quả lại.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span><span class="p">[</span><span class="s2">&quot;value2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">long_data</span><span class="p">))</span>
<span class="n">long_data</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>item</th>
      <th>value</th>
      <th>value2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1959-01-01</td>
      <td>realgdp</td>
      <td>2710.349</td>
      <td>-1.559693</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1959-01-01</td>
      <td>infl</td>
      <td>0.000</td>
      <td>-0.805337</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1959-01-01</td>
      <td>unemp</td>
      <td>5.800</td>
      <td>-0.819733</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1959-04-01</td>
      <td>realgdp</td>
      <td>2778.801</td>
      <td>-0.017763</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1959-04-01</td>
      <td>infl</td>
      <td>2.340</td>
      <td>0.654722</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1959-04-01</td>
      <td>unemp</td>
      <td>5.100</td>
      <td>-0.745763</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1959-07-01</td>
      <td>realgdp</td>
      <td>2775.488</td>
      <td>1.805144</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1959-07-01</td>
      <td>infl</td>
      <td>2.740</td>
      <td>-1.481964</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1959-07-01</td>
      <td>unemp</td>
      <td>5.300</td>
      <td>0.384402</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1959-10-01</td>
      <td>realgdp</td>
      <td>2785.204</td>
      <td>0.126167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Khi không chỉ định tham số cuối cùng (tức là cột giá trị) trong phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, kết quả trả về là một <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> có cấu trúc <strong>cột phân cấp</strong>. Trong cấu trúc này, các giá trị duy nhất từ cột ban đầu, thường là cột chứa nhiều biến giá trị, sẽ được đưa lên cấp thứ hai của cột trong bảng kết quả, trong khi cấp đầu tiên được xác định bởi cột chỉ mục cột đã chỉ định trong <code class="docutils literal notranslate"><span class="pre">pivot</span></code>.</p>
<p>Kiểu tổ chức dữ liệu này rất hữu ích khi bạn muốn giữ nguyên nhiều cột giá trị đồng thời mà không làm mất thông tin, và thường xuất hiện trong các phân tích bảng chéo hoặc tổng hợp dữ liệu đa chiều.</p>
<p>Hãy cùng quan sát ví dụ minh họa để hiểu rõ hơn cách thức hoạt động của cấu trúc cột phân cấp trong Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivoted</span> <span class="o">=</span> <span class="n">long_data</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="n">pivoted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">value</th>
      <th colspan="3" halign="left">value2</th>
    </tr>
    <tr>
      <th>item</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>0.00</td>
      <td>2710.349</td>
      <td>5.8</td>
      <td>-0.805337</td>
      <td>-1.559693</td>
      <td>-0.819733</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2.34</td>
      <td>2778.801</td>
      <td>5.1</td>
      <td>0.654722</td>
      <td>-0.017763</td>
      <td>-0.745763</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2.74</td>
      <td>2775.488</td>
      <td>5.3</td>
      <td>-1.481964</td>
      <td>1.805144</td>
      <td>0.384402</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>0.27</td>
      <td>2785.204</td>
      <td>5.6</td>
      <td>-0.675075</td>
      <td>0.126167</td>
      <td>-1.096854</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2.31</td>
      <td>2847.699</td>
      <td>5.2</td>
      <td>0.720182</td>
      <td>-0.662325</td>
      <td>1.062477</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivoted</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>item</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>0.00</td>
      <td>2710.349</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2.34</td>
      <td>2778.801</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2.74</td>
      <td>2775.488</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>0.27</td>
      <td>2785.204</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2.31</td>
      <td>2847.699</td>
      <td>5.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Cần lưu ý rằng phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code> trong Pandas thực chất tương đương với việc tạo một hệ chỉ số phân cấp (<em>hierarchical index</em>) bằng cách sử dụng <code class="docutils literal notranslate"><span class="pre">set_index</span></code>, sau đó áp dụng phương thức <code class="docutils literal notranslate"><span class="pre">unstack</span></code>.</p>
<p>Cụ thể, <code class="docutils literal notranslate"><span class="pre">set_index</span></code> cho phép xác định một hoặc nhiều cột làm chỉ số cho bảng dữ liệu, từ đó cấu trúc lại bảng theo hướng đa chiều. Phương thức <code class="docutils literal notranslate"><span class="pre">unstack</span></code> tiếp theo sẽ “xoay” một trong các cấp chỉ số đó thành cột, tạo ra một bảng mới theo định dạng “wide”.</p>
<p>Cách tiếp cận này đặc biệt hữu ích khi bạn cần kiểm soát linh hoạt quá trình chuyển đổi dữ liệu, hoặc khi muốn áp dụng các thao tác tương tự <code class="docutils literal notranslate"><span class="pre">pivot</span></code> trong các tình huống không thể sử dụng trực tiếp <code class="docutils literal notranslate"><span class="pre">pivot</span></code>.</p>
<p>Ví dụ cụ thể dưới đây sẽ minh họa rõ ràng mối quan hệ tương đương giữa <code class="docutils literal notranslate"><span class="pre">pivot</span></code> và tổ hợp <code class="docutils literal notranslate"><span class="pre">set_index</span></code> + <code class="docutils literal notranslate"><span class="pre">unstack</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unstacked</span> <span class="o">=</span> <span class="n">long_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unstacked</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">value</th>
      <th colspan="3" halign="left">value2</th>
    </tr>
    <tr>
      <th>item</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
      <th>infl</th>
      <th>realgdp</th>
      <th>unemp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1959-01-01</th>
      <td>0.00</td>
      <td>2710.349</td>
      <td>5.8</td>
      <td>-0.805337</td>
      <td>-1.559693</td>
      <td>-0.819733</td>
    </tr>
    <tr>
      <th>1959-04-01</th>
      <td>2.34</td>
      <td>2778.801</td>
      <td>5.1</td>
      <td>0.654722</td>
      <td>-0.017763</td>
      <td>-0.745763</td>
    </tr>
    <tr>
      <th>1959-07-01</th>
      <td>2.74</td>
      <td>2775.488</td>
      <td>5.3</td>
      <td>-1.481964</td>
      <td>1.805144</td>
      <td>0.384402</td>
    </tr>
    <tr>
      <th>1959-10-01</th>
      <td>0.27</td>
      <td>2785.204</td>
      <td>5.6</td>
      <td>-0.675075</td>
      <td>0.126167</td>
      <td>-1.096854</td>
    </tr>
    <tr>
      <th>1960-01-01</th>
      <td>2.31</td>
      <td>2847.699</td>
      <td>5.2</td>
      <td>0.720182</td>
      <td>-0.662325</td>
      <td>1.062477</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Một thao tác ngược lại với phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code> trong <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> là phương thức <code class="docutils literal notranslate"><span class="pre">pandas.melt</span></code>. Thay vì chuyển một cột thành nhiều cột trong một bảng dữ liệu mới như <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, <code class="docutils literal notranslate"><span class="pre">melt</span></code> thực hiện việc <strong>gộp nhiều cột thành một</strong>, từ đó tạo ra một <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> có <strong>số hàng lớn hơn</strong> so với đầu vào — tức là định dạng “long”.</p>
<p>Phép biến đổi này thường được sử dụng để đưa dữ liệu về <strong>dạng chuẩn hóa</strong> (<em>normalized form</em>), phù hợp với các quy tắc của cơ sở dữ liệu quan hệ và thuận tiện cho nhiều thao tác phân tích, trực quan hóa hoặc lưu trữ.</p>
<p>Hãy cùng xem một ví dụ minh họa cho quá trình này:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">],</span>
                      <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                      <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                      <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baz</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Trong nhiều tình huống, cột <code class="docutils literal notranslate"><span class="pre">&quot;key&quot;</span></code> đóng vai trò là một <strong>chỉ báo nhóm</strong>, trong khi các cột còn lại chứa các giá trị dữ liệu cần được gộp lại. Khi sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">pandas.melt</span></code>, chúng ta cần chỉ rõ những cột nào (nếu có) sẽ được giữ lại làm chỉ báo nhóm.</p>
<p>Cụ thể, trong ví dụ này, chúng ta sử dụng <code class="docutils literal notranslate"><span class="pre">&quot;key&quot;</span></code> làm <strong>chỉ báo nhóm duy nhất</strong>, và tiến hành gộp các cột còn lại thành một cột duy nhất chứa giá trị, đi kèm với một cột khác ghi tên thuộc tính ban đầu. Đây là cách làm phổ biến để chuyển dữ liệu từ định dạng “wide” sang “long” mà vẫn bảo toàn thông tin nhóm.</p>
<p>Ví dụ dưới đây sẽ minh họa rõ cách sử dụng <code class="docutils literal notranslate"><span class="pre">melt</span></code> với <code class="docutils literal notranslate"><span class="pre">&quot;key&quot;</span></code> làm chỉ báo nhóm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baz</td>
      <td>A</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>B</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>baz</td>
      <td>B</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>foo</td>
      <td>C</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>bar</td>
      <td>C</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>baz</td>
      <td>C</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sau khi đã chuyển đổi dữ liệu sang định dạng “long” bằng phương thức <code class="docutils literal notranslate"><span class="pre">melt</span></code>, chúng ta hoàn toàn có thể <strong>khôi phục lại bố cục ban đầu</strong> bằng cách sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">pivot</span></code>. Phép biến đổi này cho phép tái cấu trúc bảng dữ liệu, trong đó một cột sẽ được sử dụng làm chỉ mục hàng, một cột khác làm tên cột mới, và cột cuối cùng chứa giá trị dữ liệu.</p>
<p>Việc sử dụng <code class="docutils literal notranslate"><span class="pre">pivot</span></code> trong trường hợp này giúp minh họa rõ ràng tính <strong>tương hỗ giữa <code class="docutils literal notranslate"><span class="pre">melt</span></code> và <code class="docutils literal notranslate"><span class="pre">pivot</span></code></strong>, qua đó cho phép linh hoạt chuyển đổi qua lại giữa hai định dạng dữ liệu — một kỹ năng quan trọng trong xử lý và phân tích dữ liệu bằng Pandas.</p>
<p>Sau đây là ví dụ cụ thể cho quá trình chuyển dữ liệu về định dạng ban đầu bằng <code class="docutils literal notranslate"><span class="pre">pivot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reshaped</span> <span class="o">=</span> <span class="n">melted</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span>
                            <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">reshaped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bar</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>baz</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>foo</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Kết quả của phép biến đổi bằng <code class="docutils literal notranslate"><span class="pre">pivot</span></code> thường tạo ra một <strong>chỉ số mới</strong> dựa trên cột được sử dụng làm tên hàng. Trong một số trường hợp, chúng ta có thể muốn chuyển chỉ số này trở lại thành cột dữ liệu thông thường, đặc biệt nếu cần tiếp tục xử lý hoặc hiển thị dữ liệu ở định dạng bảng phẳng.</p>
<p>Phương thức <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> được sử dụng để thực hiện thao tác này. Cụ thể, <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> đưa các cấp của chỉ số về thành cột của <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, từ đó giúp đơn giản hóa cấu trúc bảng và hỗ trợ tốt hơn cho các bước xử lý tiếp theo.</p>
<p>Ví dụ dưới đây sẽ minh họa rõ cách sử dụng <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> sau khi đã thực hiện <code class="docutils literal notranslate"><span class="pre">pivot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reshaped</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bar</td>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>baz</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baz</td>
      <td>A</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>B</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>baz</td>
      <td>B</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>C</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>C</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sau khi đã nắm vững một số kiến thức cơ bản về Pandas, bao gồm nhập dữ liệu, làm sạch và tổ chức lại cấu trúc bảng dữ liệu, chúng ta có thể chuyển sang nội dung trực quan hóa dữ liệu với thư viện Matplotlib.</p>
<p>Việc trực quan hóa dữ liệu đóng vai trò quan trọng trong việc hiểu rõ xu hướng, mối quan hệ và các đặc điểm ẩn chứa trong tập dữ liệu. Đây cũng là công cụ hỗ trợ ra quyết định hiệu quả trong nhiều lĩnh vực ứng dụng thực tiễn.</p>
<p>Chúng ta sẽ quay lại khám phá thêm nhiều tính năng nâng cao khác của Pandas ở các chương sau, khi bước vào các phân tích chuyên sâu và kỹ thuật xử lý dữ liệu nâng cao hơn.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter8-prepare.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Làm sạch và chuẩn bị dữ liệu</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter10-visualization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Trực quan hóa dữ liệu</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-so-phan-cap">9.1. Chỉ số phân cấp</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sap-xep-lai-va-sap-xep-cac-cap">9.1.1. Sắp xếp lại và sắp xếp các cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thong-ke-tom-tat-theo-cap">9.1.2. Thống kê tóm tắt theo cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tao-chi-so-bang-cac-cot-cua-dataframe">9.1.3. Tạo chỉ số bằng các cột của dataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-cac-tap-du-lieu">9.2. Kết hợp các tập dữ liệu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-gop-va-noi-du-lieu">9.2.1. Các phép gộp và nối dữ liệu</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-du-lieu-dua-tren-chi-so">9.2.2. Kết hợp dữ liệu dựa trên chỉ số</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#noi-du-lieu-theo-mot-truc">9.2.3. Nối dữ liệu theo một trục</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-hinh-lai-du-lieu-va-thay-doi-truc">9.3. Định hình lại dữ liệu và thay đổi trục</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-hinh-lai-voi-chi-so-phan-cap">9.3.1. Định hình lại với chỉ số phân cấp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xoay-truc-tu-dinh-dang-dai-sang-rong-va-nguoc-lai">9.3.2. Xoay trục từ định dạng dài sang rộng và ngược lại</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div style="text-align: left; padding: 1em; font-size: 1em;">
  <p>© 2025 <a href="https://nct.neu.edu.vn" target="_blank" style="text-decoration: none;">Trường Công nghệ- NEU </a> </p>
  <p>Liên hệ: <a href="mailto:truongcongnghe@neu.edu.vn">truongcongnghe@neu.edu.vn</a></p>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>